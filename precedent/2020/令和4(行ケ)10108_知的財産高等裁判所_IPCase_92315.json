{
  "trial_type": "IPCase",
  "date": {
    "era": "Reiwa",
    "year": 5,
    "month": 8,
    "day": 10
  },
  "case_number": "令和4(行ケ)10108",
  "case_name": "審決取消請求事件",
  "court_name": "知的財産高等裁判所",
  "right_type": "特許権",
  "lawsuit_type": "行政訴訟",
  "lawsuit_id": "92315",
  "detail_page_link": "https://www.courts.go.jp/app/hanrei_jp/detail7?id=92315",
  "full_pdf_link": "https://www.courts.go.jp/app/files/hanrei_jp/315/092315_hanrei.pdf",
  "contents": "令和５年８月１０日判決言渡\n令和４年（行ケ）第１０１０８号  審決取消請求事件\n口頭弁論終結日  令和５年６月２２日\n判             決\n原              告       ディズニー  エンタープライ\nゼス  インコーポレイテッド\n同訴訟代理人弁護士        浜    田      治      雄\n被 告        特  許  庁  長  官\n同 指 定 代 理 人        千    葉      輝      久\n畑    中      高      行\n木    方      庸      輔\n宮    下              誠\n清    川      恵      子\n主             文\n１  原告の請求を棄却する。\n２  訴訟費用は原告の負担とする。\n３  原告のために、この判決に対する上告及び上告受理申立てのための付\n加期間を３０日と定める。\n事 実 及 び 理 由\n第１  請求\n特許庁が不服２０２１－３４０７号事件について令和４年５月３１日にした審決\nを取り消す。\n第２  事案の概要\n本件は、特許出願の拒絶査定に対する不服審判請求を不成立とした審決の取消訴\n訟である。争点は、手続補正後の請求項１に係る発明の進歩性の有無である。\n１  特許庁における手続の経緯等\n原告は、平成２８年８月２６日、発明の名称を「ハイダイナミックレンジトーン\nマッピング」とする特許出願（特願２０１６－１６６０５０号（以下「本件出願」\nという。）。優先権主張（米国）２０１５年（平成２７年）９月４日）をし、令和\n２年１０月２９日に手続補正書を提出したが、同年１１月１０日付けで拒絶査定を\n受けた（甲５、６、１０）。そこで、原告は、令和３年３月１５日、同拒絶査定に\n対する不服審判の請求（不服２０２１－３４０７号）をするとともに、手続補正書\nを提出した（以下、この手続補正書による手続補正を「本件補正」といい、本件出\n願に係る願書に添付して提出した明細書及び図面とみなされる翻訳文（甲６。なお、\n本件補正を含め、手続補正による明細書及び図面の変更はない。）を「本願明細書」\nという。）（甲１３）。\n特許庁は、令和４年５月３１日、本件補正を却下した上、「本件審判の請求は、\n成り立たない。」との審決（以下「本件審決」という。）をし、その謄本は、同年\n６月１０日、原告に送達された（出訴のための附加期間は９０日）。\n原告は、令和４年１０月７日、本件審決の取消しを求めて本件訴えを提起した。\n２  本件出願に係る本件補正前の発明の要旨（甲１０）\n本件出願に係る本件補正前（令和２年１０月２９日に提出された手続補正書によ\nる手続補正後を指す。以下同じ。）の特許請求の範囲（請求項の数は２０）のうち\n請求項１の記載は、次のとおりである（以下、本件補正前の請求項１に係る発明を\n「本願発明」という。）。\n【請求項１】\n一つのハイダイナミックレンジ（ＨＤＲ）ビデオの一つのフレームを使用する第\n１のベースレイヤーを生成すること；\n該第１のベースレイヤーから一つのトーンカーブパラメータを導出すること；こ\nこで該トーンカーブパラメータは、第１のベースレイヤーのピクセルから導出され\nた統計値であり、\n第２のベースレイヤーから導出された該トーンカーブパラメータの一つの以前に\n測定された値を使用して該トーンカーブパラメータを時間フィルタリングし、ここ\nで第２のベースレイヤーはＨＤＲビデオの一つの以前のフレームから導出されるこ\nと；および\n該時間フィルタリングされたトーンカーブパラメータから導出された一つのトー\nンカーブを使用する一つの時間コヒーレントベースレイヤーを生成すること\nを含む方法。\n３  本件出願に係る本件補正後の発明の要旨（甲１３）\n本件出願に係る本件補正後の特許請求の範囲（請求項の数は２０）のうち請求項\n１の記載は、次のとおりである（下線部は、補正箇所である。以下、本件補正後の\n請求項１に係る発明を「本件補正発明」という。なお、本件補正発明については、\n本件審決が付したように符号Ａ及びＢを付す。）。\n【請求項１】\nＡ  一つのハイダイナミックレンジ（ＨＤＲ）ビデオの一つのフレームを使用する\n第１のベースレイヤーを生成すること；\nＢ  該第１のベースレイヤーから一つのトーンカーブパラメータを導出すること；\nここで該トーンカーブパラメータは、第１のベースレイヤーのピクセルから導出さ\nれた一つの統計的照度値であり、\n第２のベースレイヤーから導出された該トーンカーブパラメータの一つの以前に\n測定された値を使用して該トーンカーブパラメータを時間フィルタリングし、ここ\nで第２のベースレイヤーはＨＤＲビデオの一つの以前のフレームから導出されるこ\nと；および\n該時間フィルタリングされたトーンカーブパラメータから導出された一つのトー\nンカーブを使用する一つの時間コヒーレントベースレイヤーを生成すること\nＡ  を含む方法。\n４  本件審決の理由の要旨\n(1)  本件補正について\nア  甲１（欧州特許出願公開第２１４４４４４号明細書（２０１０年（平成２２\n年）１月１３日公開））に記載された発明の認定\n甲１には、次の発明（以下「甲１発明」という。）が記載されている。\n（甲１発明）\nａ  ビデオフレームデータのストリームを圧縮する改良された方法であって、\nｂ  高精細なハイダイナミックレンジのビデオフレームからなるビデオフレームデ\nータのストリーム１が提供され、ビデオストリーム１の１つのＨＤＲフレーム２は、\nＨＤＲフレーム２からベースフレーム４を抽出するために使用されるフィルタ３に\n入力され、\nｃ  ベースフレーム４は、結合段階において、例えば、ＨＤＲフレーム２からベー\nスフレーム４を減算することによって、及び／又はＨＤＲフレーム２をベースフレ\nーム４で除算することによって、初期ＨＤＲフレームと結合され、ＨＤＲフレーム\n２の微細な細部に関連するディテールフレーム５が提供され、\nｄ  ベースフレーム４はさらに、トーンマッピング操作段階６に供給され、トーン\nマッピングルックアップテーブル７に格納された複数のトーンマッピング関数のう\nちの１つがベースフレームに対して選択され、\nｅ  所定のベースフレーム４に対して選択されたトーンマッピング関数６は、後述\nするように、トーンマッピング関数ＴＭＯ*に変更され、トーンマッピング関数Ｔ\nＭＯ*は、ローダイナミックレンジベースフレーム８を得るように、ベースフレー\nム４に適用され、\nｆ  ローダイナミックレンジベースフレーム８及びディテールフレーム５は、それ\nぞれ段階９及び１０で別々に時間的圧縮アルゴリズムの処理がされ、\nｇ  時間的特性段階１１は、ベースフレーム４に対して最初に決定された初期トー\nンマッピング関数を受信すると、前のトーンマッピング関数と比較したトーンマッ\nピング関数の変化が大きいか否かを決定し、\nｈ  トーンマッピング関数６の変化が緩やかであれば、実際のトーンマッピング関\n数ＴＭＯ*は、ベースフレーム４について決定された初期トーンマッピング関数に\n対応し、所定のベースフレーム４に対して決定されたトーンマッピング関数の変化\nが大きすぎる場合には、初期トーンマッピング関数は、以前のトーンマッピング関\n数により近いトーンマッピング関数に修正され、従って、シーン内におけるトーン\nマッピング関数の変化は小さい方法。\nイ  本件補正発明と甲１発明との対比\n本件補正発明と甲１発明は、次の一致点で一致し、相違点で相違する。\n（一致点）\nＡ  一つのハイダイナミックレンジ（ＨＤＲ）ビデオの一つのフレームを使用する\n第１のベースレイヤーを生成すること；\nＢ’該第１のベースレイヤーから、一つの時間コヒーレントベースレイヤーを生成\nすること\nＡ  を含む方法。\n（相違点）\n上記一致点である「Ｂ’該第１のベースレイヤーから、一つの時間コヒーレント\nベースレイヤーを生成する」ための方法が、本件補正発明では、「Ｂ  該第１のベ\nースレイヤーから一つのトーンカーブパラメータを導出すること；ここで該トーン\nカーブパラメータは、第１のベースレイヤーのピクセルから導出された一つの統計\n的照度値であり、第２のベースレイヤーから導出された該トーンカーブパラメータ\nの一つの以前に測定された値を使用して該トーンカーブパラメータを時間フィルタ\nリングし、ここで第２のベースレイヤーはＨＤＲビデオの一つの以前のフレームか\nら導出されること；および該時間フィルタリングされたトーンカーブパラメータか\nら導出された一つのトーンカーブを使用する一つの時間コヒーレントベースレイヤ\nーを生成する」方法であるのに対し、甲１発明では、「ルックアップテーブル７に\nよる時間変化が小さいトーンマッピング関数ＴＭＯ*を使用する方法」である点。\nウ  相違点についての判断\n甲１発明は、ベースフレーム４からローダイナミックレンジベースフレーム８を\n生成する方法が「ルックアップテーブル７による時間変化が小さいトーンマッピン\nグ関数ＴＭＯ*を使用する方法」であり、また、甲１の段落【００２２】によれば、\n「シーン内のトーンマッピング関数を徐々にしか変化させないことが非常に好まし\nい」、「トーンマッピング関数を徐々にしか変化させないことで、フレーム間の差\nが小さくなるため、受信画像がより自然なものになるように感じられる」ものであ\nるから、甲１発明は、トーンマッピング関数を徐々に変化させるようにすることで\n画像がより自然なものになるように感じられるようにするために、ベースフレーム\n４からローダイナミックレンジベースフレーム８を生成する方法として、上記「ル\nックアップテーブル７による時間変化が小さいトーンマッピング関数ＴＭＯ *を使\n用する方法」を採用したことを技術的特徴とするものである。\n一方、画像処理の技術分野において、フレームのトーンマッピング関数（本件補\n正発明でいう「トーンカーブ」）を徐々に変化させるように補正する技術として、\n「フレーム毎に平均輝度値を算出し、算出した平均輝度値を複数のフレームで平滑\n化し、平滑化した平均輝度値を用いて現在のフレームのトーンカーブを補正する」\n方法は、当業者に周知の技術であって（以下、この方法に係る技術を「本件周知技\n術」という。）、例えば、甲２（国際公開第２０１４／１９８５７４号）、甲３\n（特開２００５－２０４１９５号公報）及び甲４（Chris Kiser ほか著「REAL TIME\nAUTOMATED TONE MAPPING SYSTEM FOR HDR VIDEO」（２０１２年））が参照され、\n特に、甲３（段落【００７４】、【００７５】及び【００７７】）には、トーンカ\nーブ補正部１４２の第２の構成例として次の技術が記載されている。\n「フレーム毎に代表値γを算出して、対数輝度 logＬ（ｐ）を、対数輝度 logＬc\n（ｐ）に補正するものであり、平均輝度算出部１９１は、１フレーム分の対数輝度\nlogＬ（ｐ）の平均輝度値μを算出し、平均輝度平滑化部１９２に出力し、平均輝\n度平滑化部１９２は、平均輝度算出部１９１より供給された平均輝度値μを、前後\nのフレームの平均輝度値μ又は前後のフレームの平滑化された平均輝度値μを用い\nて平滑化し、除算器１９３に供給し、除算器１９３は、所定の定数 logＬＴを平均\n輝度値μで除算し、代表値γを算出し、γメモリ１９４は、除算器１９３から入力\nされた代表値γを保持し、乗算器１９５は、現フレームの対数輝度 logＬ（ｐ）に、\nγメモリ１９４に保持されている１フレーム前の代表値γを乗算して、トーンカー\nブ補正後の対数輝度 logＬc（ｐ）を算出するトーンカーブ補正の技術。」\n上記甲３の技術における「１フレーム分の対数輝度 logＬ（ｐ）の平均輝度値μ\nを算出」、「平均輝度算出部１９１より供給された平均輝度値μを、前後のフレー\nムの平均輝度値μ又は前後のフレームの平滑化された平均輝度値μを用いて平滑\n化」、「現フレームの対数輝度 logＬ（ｐ）に、γメモリ１９４に保持されている\n１フレーム前の代表値γを乗算して、トーンカーブ補正後の対数輝度 logＬc（ｐ）\nを算出」は、それぞれ、本件周知技術の「フレーム毎に平均輝度値を算出」、「算\n出した平均輝度値を複数のフレームで平滑化」、「平滑化した平均輝度値を用いて\n現在のフレームのトーンカーブを補正」に相当する。\n甲１発明において、トーンマッピング関数を徐々に変化させるようにするための\n技術として、他の技術を採用することを妨げるような事情は見当たらないから、甲\n１発明におけるトーンマッピング関数を徐々に変化させるようにするための技術は、\n本件周知技術に置き換え可能なものであり、同様の結果を達成する他の技術を採用\nすることとして当業者が本件周知技術への置き換えをする動機はあるというべきで\nある。\nしたがって、甲１発明において、ベースフレーム４のトーンマッピング関数を徐\n々に変化させるようにするために、ベースフレーム４からローダイナミックレンジ\nベースフレーム８を生成する方法を、「ルックアップテーブル７による時間変化が\n小さいトーンマッピング関数ＴＭＯ*を使用する方法」から本件周知技術に置き換\nえて、ベースフレーム４（本件補正発明でいう「ベースレイヤー」）のフレーム毎\nに代表値γを算出して、対数輝度 logＬ（ｐ）を対数輝度 logＬＣ（ｐ）に補正する\n技術によりトーンカーブの補正をする方法を採用することは、当業者が容易に想到\nし得ることであり、このことは、甲１発明において、上記相違点に係る本件補正発\n明の発明特定事項を採用することは当業者が容易に想到し得ることを意味している。\nよって、本件補正発明は、甲１に記載された発明及び本件周知技術に基づいて当\n業者が容易に発明をすることができたものである。\n（なお、動機付けに関してさらに付言すれば、甲３の段落【００７４】には、\n「図８は、トーンカーブ補正部１４２の第２の構成例を示している。第２の構成例\nは、第１の構成例のように予め用意されているＬＵＴを用いるのではなく、フレー\nム毎に代表値γを算出して、対数輝度 logＬ（ｐ）を、対数輝度 logＬc（ｐ）に補\n正するものである。」と記載されており、トーンカーブの補正に、あらかじめ用意\nされているＬＵＴを用いる構成（甲１発明の構成）をフレーム毎に代表値γを算出\nして補正する構成（本件補正発明の構成）に置き換える動機付けとなる記載もあ\nる。）\nエ  独立特許要件のまとめ\n以上のとおりであるから、本件補正発明は、特許法２９条２項の規定により、特\n許出願の際独立して特許を受けることができないものである。\nオ  補正却下の決定の理由のまとめ\n本件補正は、特許法１７条の２第６項において準用する同法１２６条７項の規定\nに違反するので、同法１５９条１項の規定において読み替えて準用する同法５３条\n１項の規定により却下すべきものである。\n(2)  本願発明について\n上記(1)アないしエで検討した本件補正発明は、本願発明の「統計値」に限定事\n項を付加して「一つの統計的照度値」とした本願発明の一態様といえるもの、すな\nわち、本願発明でもあるといえる。\nしたがって、上記(1)イ及びウと同様の対比・判断により、本願発明は、甲１に\n記載された発明及び本件周知技術に基づいて当業者が容易に発明をすることができ\nたものである。\n(3)  むすび\n以上のとおりであるから、本願発明は、特許法２９条２項の規定により特許を受\nけることができない。\nしたがって、その余の請求項について論及するまでもなく、本件出願は拒絶すべ\nきものである。\n第３  原告主張の審決取消事由\n１  取消事由１（甲１に記載された発明の認定の誤り）について\n本件審決は、甲１に記載された発明を甲１発明（構成ａないしｈ）のとおりに認\n定したが、甲１からは、構成ａないしｈを認定することはできないから、本件審決\nの上記認定は誤りである。\n２  取消事由２（相違点についての判断の誤り）について\n本件審決における相違点の認定は認めるが、本件審決における相違点に係る本件\n補正発明の構成は甲１発明及び本件周知技術に基づいて当業者が容易に想到し得た\nものであるとの判断は誤りである。\n(1)  本件周知技術の認定について\n本件審決は、甲２ないし４により本件周知技術を認定したが、以下のとおり、甲\n２ないし４には本件周知技術の開示がないから、甲２ないし４により本件周知技術\nを認定することはできない。\nア  甲２は、任意のＬＥＤパネル解像度、任意のＬＥＤポイント拡散関数及び任\n意のＬＣＤパネル解像度を使用して、ＨＤＲピクチャについて決定された平均輝度\nの代表値を時間フィルタリングする方法を開示するにすぎない。\nイ  甲３は、逆Ｓ字形のトーンカーブを利用することにより、高輝度領域と低輝\n度領域では階調圧縮が強く作用しないことから、階調圧縮後であっても白つぶれ、\n黒つぶれ等のない良好な色調が得られることを開示するにすぎない。\nウ  甲４は、時間変化が少ないトーンマッピング関数ＴＭＯを使用して、自然な\n受信画像を得る方法を開示するにすぎない。\n(2)  本件周知技術の甲１発明への適用に係る動機付けについて\n仮に、甲２ないし４により本件周知技術を認定し得るとしても、本件補正発明は、\n時間的コヒーレンス性（ＨＤＲビデオの個別のフレームで実行されるトーンマッピ\nングがフレームごとに一致する度合いを指す。）の欠如というＨＤＲビデオトーン\nマッピング技術における慢性的な課題を解決するため、特異な構成（相違点に係る\n本件補正発明の構成）を採用したものであるところ、一般に、発明者は、複数の刊\n行物にアクセスして創作を行うものではないから、当業者にとって、相違点に係る\n本件補正発明の構成を推考するに当たり、甲２ないし４にアクセスする動機はない\nというべきである。したがって、甲１発明に本件周知技術を適用する動機付けは存\n在せず、甲１発明に本件周知技術を適用し得るとする本件審決の判断は、事実に基\nづくものでないといわざるを得ない。\n第４  被告の主張\n１  取消事由１（甲１に記載された発明の認定の誤り）について\n以下のとおり、甲１に記載された発明として甲１発明（構成ａないしｈ）を認定\nすることができるから、これと同旨の本件審決の認定に誤りはない。\n(1)  甲１には、「本発明は、ビデオフレームデータのストリームを圧縮する改\n良された方法…を提供することを目的とする。」との記載（段落【００２０】）が\nあるところ、これは、甲１発明の構成ａである。\n(2)  甲１には、「図１によれば、高精細なハイダイナミックレンジのビデオフ\nレームからなるビデオフレームデータのストリーム１が提供される。ビデオストリ\nーム１の１つのＨＤＲフレーム２は、…ＨＤＲフレーム２からベースフレーム４を\n抽出するために使用されるフィルタ３に入力される。」との記載（段落【００３\n８】）があるところ、これは、甲１発明の構成ｂである。\n(3)  甲１には、「ベースフレーム４は、結合段階において、例えば、ＨＤＲフ\nレーム２からベースフレーム４を減算することによって、及び／又はＨＤＲフレー\nム２をベースフレーム４で除算することによって、初期ＨＤＲフレームと結合され、\nＨＤＲフレーム２の微細な細部に関連するディテールフレーム５が提供される。」\nとの記載（段落【００３９】）があるところ、これは、甲１発明の構成ｃである。\n(4)  甲１には、「ベースフレーム４はさらに、トーンマッピング操作段階６に\n供給され、トーンマッピングルックアップテーブル７に格納された複数の…トーン\nマッピング関数のうちの１つがベースフレームに対して選択される。」との記載\n（段落【００３９】）があるところ、これは、甲１発明の構成ｄである。\n(5)  甲１には、「所定のベースフレーム４に対して選択されたトーンマッピン\nグ関数６は、後述するように、…トーンマッピング関数ＴＭＯ*に変更される。…\nトーンマッピング関数ＴＭＯ*は、ローダイナミックレンジベースフレーム８を得\nるように、ベースフレーム４に適用される。」との記載（段落【００４０】）があ\nるところ、これは、甲１発明の構成ｅである。\n(6)  甲１には、「ローダイナミックレンジベースフレーム８及びディテールフ\nレーム５は、それぞれ段階９及び１０で別々に時間的圧縮アルゴリズムの処理がさ\nれる。」との記載（段落【００４０】）があるところ、これは、甲１発明の構成ｆ\nである。\n(7)  甲１には、「時間的特性段階１１は、ベースフレーム４に対して最初に決\n定された初期トーンマッピング関数を受信すると、前のトーンマッピング関数と比\n較したトーンマッピング関数の変化が大きいか否かを決定する。」との記載（段落\n【００４１】）があるところ、これは、甲１発明の構成ｇである。\n(8)  甲１には、「トーンマッピング関数６の変化が緩やかであれば、実際のト\nーンマッピング関数ＴＭＯ*は、ベースフレーム４について決定された初期トーン\nマッピング関数に対応する。所定のベースフレーム４に対して決定されたトーンマ\nッピング関数の変化が大きすぎる場合には、初期トーンマッピング関数は、以前の\nトーンマッピング関数により近いトーンマッピング関数に修正される。…従って、\nシーン内におけるトーンマッピング関数の変化は小さく…。」との記載（段落【０\n０４２】）があるところ、これは、甲１発明の構成ｈである。\n(9)  なお、前記(1)ないし(8)の各記載は、いずれも甲１の図１の説明に係るも\nのであるから、これらの各記載により、まとまった一つの発明を認定し得るもので\nある。\n２  取消事由２（相違点についての判断の誤り）について\n以下のとおり、原告の主張はいずれも理由がなく、本件審決の相違点の認定並び\nに相違点に係る本件補正発明の構成は甲１発明及び本件周知技術に基づいて当業者\nが容易に想到し得たものであるとの判断に誤りはない。\n(1)  本件周知技術の認定について\n以下のとおり、甲２ないし４には本件周知技術が開示されているから、甲２ない\nし４により本件周知技術を認定することができる。\nア  甲３について\n(ｱ)  甲３の記載（段落【００７４】及び【００７５】）によると、甲３には、\n次の技術が記載されているといえる。\n「フレームごとに代表値γを算出して、対数輝度 logＬ（ｐ）を対数輝度 logＬＣ\n（ｐ）に補正するものであって、平均輝度算出部１９１は、１フレーム分の対数\n輝度 logＬ（ｐ）の平均輝度値μを算出し、平均輝度平滑化部１９２に出力し、\n平均輝度平滑化部１９２は、平均輝度算出部１９１から供給された平均輝度値μ\nを前後のフレームの平均輝度値μ又は前後のフレームの平滑化された平均輝度値\nμを用いて平滑化し、除算器１９３に供給し、除算器１９３は、所定の定数 log\nＬＴを平均輝度値μで除算し、代表値γを算出し、γメモリ１９４は、除算器１\n９３から入力された代表値γを保持し、乗算器１９５は、現フレームの対数輝度\nlogＬ（ｐ）にγメモリ１９４に保持されている１フレーム前の代表値γを乗算\nして、トーンカーブ補正後の対数輝度 logＬＣ（ｐ）を算出するようなトーンカー\nブ補正の技術」\n(ｲ)  ここで、前記(ｱ)の技術にいう「対数輝度」は、輝度を表現するものであ\nるから、これを輝度と考えて差し支えなく、「前後のフレームの平均輝度値μ又\nは前後のフレームの平滑化された平均輝度値μを用いて平滑化」するとは、例え\nば、連続する前後の二つのフレームの平均輝度値μの相加平均等を求めて現在の\nフレームの値とすることを意味し、「所定の定数 logＬＴ」は、除算器１９３にお\nける処理により単位を設定するための値にすぎず、「代表値γ」は、トーンカー\nブの傾きを示すものであり、「現フレームの対数輝度 logＬ（ｐ）に…代表値γ\nを乗算して、トーンカーブ補正後の対数輝度 logＬＣ（ｐ）を算出する」とは、現\nフレームのトーンカーブの傾きを代表値γに補正することであるといえる。そう\nすると、前記(ｱ)の技術は、「１フレーム分の輝度Ｌの平均輝度値μを算出し、\n平均輝度値μを平滑化し、平滑化した平均輝度値μからトーンカーブの傾きを示\nす代表値γを算出し、現フレームのトーンカーブの傾きを代表値γに補正する方\n法」と言い換えることができるところ、これは、本件周知技術に相当する。した\nがって、甲３には、本件周知技術が開示されているといえる。\nイ  甲２について\n(ｱ)  甲２の記載（４頁５～１０行目、８頁３～４行目並びに１３頁１２～１\n４行目及び１７～１８行目）によると、甲２には、次の方法が記載されていると\nいえる。\n「Ｍ個のハイダイナミックレンジピクチャについて決定された平均輝度の代表\n値をシーケンスの少なくともＭ個のハイダイナミックレンジピクチャにわたって\n時間的にフィルタリングし、Ｍ個のハイダイナミックレンジピクチャの画像の処\n理は、フィルタリングした値を使用する方法であって、\nＨＤＲピクチャＰｉの平均輝度を代表する値 avg_lum が取得され、値 avg_lum\nは、ビデオにわたって時間的にフィルタリングされ、その結果、シーケンスのピ\nクチャはより多くの輝度コヒーレンスを有する方法」\n(ｲ)  ここで、前記(ｱ)の方法にいう「ハイダイナミックレンジピクチャ」及び\n「ＨＤＲピクチャ」は、いずれも本件周知技術にいう「フレーム」に相当し、前\n記(ｱ)の方法にいう「平均輝度の代表値」及び「平均輝度を代表する値 avg_lum」\nは、いずれも本件周知技術にいう「平均輝度値」に相当し、前記(ｱ)の方法にい\nう「Ｍ個のハイダイナミックレンジピクチャについて決定された平均輝度の代表\n値をシーケンスの少なくともＭ個のハイダイナミックレンジピクチャにわたって\n時間的にフィルタリング」すること及び「値 avg_lum は、ビデオにわたって時間\n的にフィルタリング」することは、いずれも時間軸方向に並んだＭ個のハイダイ\nナミックレンジピクチャのそれぞれについて決定された複数の平均輝度の代表値\nに対してフィルタ演算をすることをいい、当該フィルタ演算は、例えば、二つの\n連続するフレームの平均輝度値の相加平均、相乗平均等の平均化のための演算を\n意味するから、前記(ｱ)の方法にいう「時間的にフィルタリング」するとは、本\n件周知技術にいう「平滑化」に相当し、また、前記(ｱ)の方法においては、時間\n的にフィルタリングした値をＭ個のハイダイナミックレンジピクチャの画像の処\n理に使用した結果、シーケンスのピクチャ（複数のフレーム）が輝度コヒーレン\nスを有するもの（輝度が大きく変化しないもの）となるのであるから、現在のフ\nレームを含むビデオの複数のフレームは、輝度値が補正されており、フレームに\n適用する輝度圧縮処理（トーンカーブ）が補正されているといえる。そうすると、\n前記(ｱ)の方法は、本件周知技術に相当するといえ、したがって、甲２には、本\n件周知技術が開示されているといえる。\nウ  甲４について\n(ｱ)  甲４の記載（３頁左欄４～１６行目、左欄３１行目～右欄５行目及び右欄\n１２～１３行目）によると、甲４には、次の方法が記載されているといえる。\n「トーンマッピングは、画像の幾何平均Ｌ ａｖを加えて、パラメータａ、Ａ、Ｂ\nが推定され、非線形圧縮を適用するものであり、\nトーンマッピングされたＨＤＲビデオのフリッカーを低減することを目的とし\nて、ＴＭＯのパラメータのフレーム間の急激な変化を低減するためのフィルタを\n使用し、フィルタリングされたｎフレーム目のＡ ｎ、Ｂｎ、ａｎを計算するための\n更新された式は、式３ａから式３ｃで与えられ、\nＡｎ＝（１－αＡ）Ａ（ｎ－１）＋（αＡ）Ａ     （３ａ）\nＢｎ＝（１－αＢ）Ｂ（ｎ－１）＋（αＢ）Ｂ     （３ｂ）\nａｎ＝（１－αａ）ａ（ｎ－１）＋（αａ）ａ     （３ｃ）\nここで、Ａｎはフィルタリングされた値、Ａはフィルタリングなしの値である\nトーンマッピングの方法」\n(ｲ)  ここで、前記(ｱ)の方法にいう「画像の幾何平均Ｌａｖ」は、本件周知技術\nにいう「フレーム毎に平均輝度値を算出」することに相当し、前記(ｱ)の方法の\n「フィルタリングされたｎフレーム目のＡ ｎ、Ｂｎ、ａｎを計算するための更新さ\nれた式は、式３ａから式３ｃで与えられ」においてされる計算は、本件周知技術\nにいう「算出した平均輝度値を複数のフレームで平滑化」することに相当し、前\n記(ｱ)の方法におけるトーンマッピングのパラメータである「フィルタリングさ\nれたｎフレーム目のＡｎ、Ｂｎ、ａｎ」は、ｎフレーム目のフレームをフィルタリ\nングされたパラメータでトーンマッピングするものであるから、本件周知技術に\nいう「平滑化した平均輝度値を用いて現在のフレームのトーンカーブを補正する」\nことに相当する。そうすると、前記(ｱ)の方法は、本件周知技術に相当するとい\nえ、したがって、甲４には、本件周知技術が開示されているといえる。\n(2)  本件周知技術の甲１発明への適用に係る動機付けについて\n甲１発明は、トーンマッピング関数を徐々に変化させることで画像がより自然な\nものに感じられるようにするため、ベースフレーム４からローダイナミックレンジ\nベースフレーム８を生成する方法として「ルックアップテーブル７による時間変化\nが小さいトーンマッピング関数ＴＭＯ＊を使用する方法」を採用した発明である。\nこれに対し、甲３には、「図８は、トーンカーブ補正部１４２の第２の構成例\nを示している。第２の構成例は、第１の構成例のように予め用意されているＬＵ\nＴを用いるのではなく、フレーム毎に代表値γを算出して、対数輝度 logＬ（ｐ）\nを、対数輝度 logＬc（ｐ）に補正するものである。」との記載（段落【００７\n４】）があるところ、甲１発明の「トーンマッピング関数ＴＭＯ＊」は、構成ｄ\nのとおり、トーンマッピングルックアップテーブル７に格納されたトーンマッピ\nング関数の一つであり、これは、甲３の上記記載にいう「第１の構成例のように\n予め用意されているＬＵＴ」である。そして、甲３の上記記載は、第１の構成例\nに代えて第２の構成例を採用できることを示唆しているから、甲３の上記記載に\n従うと、トーンマッピングルックアップテーブル７に格納されたトーンマッピン\nグ関数ＴＭＯ＊を適用するとの甲１発明の構成（甲３の上記記載にいう第１の構\n成例に相当するもの）に代えて、本件周知技術（甲３の上記記載にいう第２の構\n成例に相当するもの）を採用することには動機付けがあるといえ、これを妨げる\n要因は見当たらない。したがって、甲１発明に本件周知技術を適用することにつ\nいては、動機付けがあるといえる。\n第５  当裁判所の判断\n１  本件補正発明の概要\n(1)  本願明細書の記載\n本願明細書には、次の記載がある。\n【技術分野】\n【０００１】\n本明細書において示される実施形態は、一般に、ハイダイナミックレンジ（ＨＤ\nＲ）ビデオ用のトーンマッピングの実行に関する。\n【背景技術】\n【０００２】\nトーンマッピングは、典型的にはハイダイナミックカラーレンジをサポートしな\nい表示装置（例えば、モニター、テレビジョン、携帯機器の表示部等）にＨＤＲビ\nデオが出力され得る前に実行される。ＨＤＲビデオの色の範囲は、表示装置により\n出力され得る色の範囲を超えることがある。そのため、トーンマッピングは、ＨＤ\nＲビデオのフレームを、表示装置の色範囲内にある色をもつ対応するフレームに変\n換する。さらに、トーンマッピングは、ビデオを出力する表示装置の性能に適する\nように、カメラ（このカメラがＨＤＲビデオを生成する）によって撮影しながら輝\n度レベルを調整することができる。\n【発明の概要】\n【０００３】\n本実施形態は、ＨＤＲビデオのフレームを使用するベースレイヤーを生成するこ\nとと、ベースレイヤーからトーンカーブパラメータを導出することを含む方法を記\n載する。本方法はトーンカーブパラメータを時間フィルタリングすることと時間フ\nィルタリングされたトーンカーブパラメータから導出されたトーンカーブを使用す\nる時間コヒーレントベースレイヤーを生成することを含む。\n【００１０】\n時間的コヒーレンス性はＨＤＲビデオトーンマッピング技術の慢性的な問題であ\nる。一般的には、時間的コヒーレンス性はＨＤＲビデオの個別のフレームで実行さ\nれるトーンマッピングがフレーム毎に一致する度合いを表す。トーンマッピングさ\nれたコンテンツに時間的コヒーレンス性が欠如すると、人の目で認識可能な連続す\nるフレーム間で、急激な明るさの変化（例えばフラッシュ）として度々現われる。\nこれらのフラッシュはビデオトーンマッピングの使用を制限してきた。「ハイダイ\nナミックビデオの時間的コヒーレントローカルトーンマッピング」と題された米国\n特許出願第１４／１２１，０９１号は、ここで参照として組み込まれるが、時間コ\nヒーレント方法でローカルビデオトーンマッピングを実行するための技術を記載す\nる。本明細書に記載される実施形態は、比較的少ないコンピューティング資源を要\n求可能なローカルビデオトーンマッピングを実行するための技術を記載する。\n【００１１】\nある実施形態において、トーンマッピングシステムは一つのＨＤＲビデオにおけ\nる一つのフレームをフィルタリングすることにより一つのベースレイヤーを生成す\nる。次いでこのベースレイヤーから一つのトーンマッピングパラメータ、－例えば\nこのベースレイヤーの平均輝度または最大輝度値が導出される。このトーンパラメ\nータが一旦同定されると、システムは、時間フィルタリングを実行し、ＨＤＲビデ\nオにおける一つの現フレーム用のトーンカーブパラメータの値と、少なくとも一つ\nの前フレームのトーンカーブパラメータの値との不一致を平滑化する。トーンカー\nブパラメータの値を時間フィルタリングすることにより、トーンマッピングシステ\nムは、得られたトーンマッピングされたビデオにおけるフレーム間の急激な明るさ\nの変化またはフラッシュを減少または除去できる。その上、本明細書に記載される\n実施形態は、ベースレイヤー全体に時間フィルタリングを実行する必要はなく、コ\nンピュータを駆使した処理が非常に少ないであろうトーンカーブパラメータに対し\nてのみ時間フィルタリングを実行する。トーンマッピングシステムは時間フィルタ\nリングされたトーンカーブをベースレイヤーに適用して時間コヒーレントレイヤー\nを生成する。\n【００１３】\n図１は本明細書に記載される一実施形態による、ＨＤＲビデオをトーンマッピン\nグされたビデオに変換させるためのシステムフロー１００である。フロー１００に\nおいて、ボックスは、一つのトーンマッピングシステムの機能を表し、丸はトーン\nマッピングシステムにおいて生成または記憶されたデータを示す。図示されるよう\nに、フロー１００はＨＤＲビデオ１０５がトーンマッピングシステムで受信される\nと開始する。ＨＤＲビデオ１０５はトーンマッピングシステムに（例えばコンプリ\nートメディアプレゼンテーションとして）記憶され得るか、あるいはより小さい処\n理用チャンクにおけるシステムへ送信可能である。一般的に、フロー１００はＨＤ\nＲビデオ１０５の個別のフレームをトーンマッピングされたビデオ１５０のフレー\nムに変換させるための技術を表す。別の表現でいうと、トーンマッピングされたビ\nデオ１５０はＨＤＲビデオ１０５のフレームと同様な色の対比と詳細（例えばエッ\nジおよびテクスチャ）を有し得るがＨＤＲビデオ１０５よりも少ない色の範囲を有\nし得る。\n【００１４】\nトーンマッピングシステムは空間フィルター１１０を使用してＨＤＲビデオ１０\n５の一つのフレームを処理する。本実施例では、フロー１００の空間フィルター１\n１０は一つの透過性ガイデッドフィルター（ＰＧＦ）でありこれはＨＤＲビデオ１\n０５の一つのフレームを受信し且つ一つのベースレイヤー１１５を出力する。一般\n的に、ベースレイヤー１１５はＨＤＲビデオフレームにおけるピクセルの輝度値を\n表す。ある実施形態では、ベースレイヤー１１５を生成するために、ＰＧＦ１１０\nはＨＤＲビデオ１０５におけるフレームを時間ではなく空間的（例えばピクセル面\n上のＸおよびＹ次元）に処理する。ある実施形態では、ＰＧＦ１１０は、一つの均\n一なグリッド上でのピクセルの位置により規定される一つの空間的局所的近傍を決\n定することにより、一つのＨＤＲフレームにおける各ピクセルを空間的にフィルタ\nリングする。あるピクセルに対する空間的局所的近傍は、その与えられたピクセル\nの空間的近くに存在する２つまたはそれ以上のピクセル一式として規定される。\n【００１８】\n芸術的設定およびベースレイヤーを使用すると、トーンマッピングシステムはト\nーン‐カーブ‐スペース時間フィルタリング１２５を実行する。一般的に、トーン\n‐カーブ‐スペース時間フィルタリング１２５は、時間フィルタリングされたトー\nンカーブを生成し、このトーンカーブはベースレイヤーを処理して時間コヒーレン\nトベースレイヤー１４０を生成するために使用され得る。トーン‐カーブ‐スペー\nス時間フィルタリング１２５の詳細は図２に記載される。\n【００１９】\n図２は、本明細書に記載される一実施形態における、トーンカーブを時間フィル\nタリングするための方法２００のフローチャートである。ブロック２０５では、ト\nーンマッピングシステムはベースレイヤーから一つのトーンカーブパラメータを同\n定する。一般的に、トーンカーブパラメータはベースレイヤーから導出された一つ\nの統計値である。ある実施形態では、トーンカーブパラメータは、ベースレイヤー\nから導出された一つの照度値である。例えば、トーンマッピングシステムはベース\nレイヤーにおけるピクセルを各々評価し、ベースレイヤーの平均輝度値、最大輝度\n値、または最小輝度値を同定し得る。平均輝度値、最大輝度値または最小輝度値は、\n一つのトーンカーブを生成するのに利用可能な適切なトーンカーブパラメータの３\nつの実施例に過ぎない。当業者は、別の画像統計パラメータが、トーンカーブパラ\nメータとして代わりに利用できるベースレイヤーから導出可能であることを認識す\nるであろう。その上、方法２００は一つのトーンカーブパラメータを導出すること\nを説明しているが、トーンマッピングシステムは、組合せまたは加重可能な複数の\nトーンカーブパラメータを導出可能である。\n【００２０】\nブロック２１０では、トーンマッピングシステムは、前フレームから導出された\nトーンカーブパラメータ値を使用するトーンカーブパラメータを時間フィルタリン\nグする。すなわち、トーンマッピングシステムは、前トーンカーブパラメータ値を\n使用する現フレーム用トーンカーブパラメータを修正する。例えば、トーンマッピ\nングシステムは、前ベースレイヤーから導出された平均輝度値を使用する現ベース\nレイヤーに対して導出された平均輝度値を調整し、それらの値の差異を減少させる\nことができる。\n【００２１】\nベースレイヤーから導出されたトーンカーブパラメータは、ＨＤＲビデオにおけ\nる異なるフレーム間を大幅に変更可能である。例えば、ＨＤＲビデオにおける２つ\nのフレームを、ユーザーが観た際には輝度に関してほとんど変化がみられないとし\nても、これらのフレームに関するトーンカーブパラメータ値は、様々な理由によっ\nて依然として大きく変わり得る。トーンカーブパラメータが時間フィルタリングさ\nれない場合には、ユーザーは上述したように得られたトーンマッピングされたビデ\nオにおけるフラッシュに気づくであろう。したがって、ブロック２１０では、トー\nンマッピングシステムはトーンカーブパラメータの過去の値を使用して、一つの新\nたなフレームを処理する際には、トーンカーブパラメータにおける変化量を制限ま\nたは変更する。\n【００２８】\nブロック２１５では、トーンマッピングシステムは時間フィルタリングされたト\nーンカーブパラメータ（例えばｐｔ）から一つのトーンカーブを生成する。一般的\nに、トーンカーブは入力輝度と出力輝度の間の一つマッピンングであり得る。トー\nンカーブにより、トーンマッピングシステムは、ＨＤＲビデオにおけるピクセルの\n色の範囲を、非ＨＤＲのユーザー装置、－例えばテレビジョン、スマートフォンま\nたはタブレットのディスプレイ、コンピューター・モニター等により使用されてい\nるより狭い色の範囲に圧縮することができる。本明細書に記載される実施形態では、\n単一のトーンカーブを生成し利用することが記載されているが、トーンマッピング\nシステムはベースレイヤーを処理するための複数のトーンカーブを生成し（または\n予め定義された複数のトーンカーブを使用し）、時間コヒーレントベースレイヤー\nを得ることができる。\n【００３１】\nブロック２２５では、トーンマッピングシステムは調整されたトーンカーブをベ\nースレイヤーに適用することにより時間コヒーレントベースレイヤーを得る。言い\n換えると、トーンマッピングシステムはトーンカーブで規定される入力輝度と出力\n輝度との関係性を使用し、ベースレイヤーにおけるピクセルの輝度値を調整する。\nトーンカーブは時間フィルタリングトーンカーブパラメータを使用して生成される\nため、トーンカーブをベースレイヤーに適用することにより一つの時間コヒーレン\nトベースレイヤーが得られ、ここで以前のフレームのベースレイヤーに関連した輝\n度値における意図しない変化が軽減される。\n【００３２】\nさらに、トーンカーブを（ベースレイヤーおよび詳細レイヤーの両方よりも）ベ\nースレイヤーだけに適用することの利点の一つは、そのようにすることで、ローカ\nルトーンマッピングオペレーションを実行できることによる芸術的自由が保持され\nることである。ベースレイヤーと詳細レイヤーとを別個に処理することにより詳細\nレイヤーにおける特徴の視認性の正確なコントロールが可能となる。さらに、トー\nンカーブパラメータはＨＤＲビデオから直接導出されるよりもベースレイヤーから\n導出される場合に、より安定的である（すなわち、フレーム間におけるトーンカー\nブパラメータの変化がより小さい）。これは、ベースレイヤーを生成するために使\n用されたフィルターがＨＤＲビデオにおける輝度値の局所変化を減少させ且つ外れ\n値を除去するためである。したがって、ベースレイヤーからトーンカーブパラメー\nタを導出することはトーンカーブパラメータにおける時間差を安定化させ且つ上述\nのフラッシュを軽減させることにも役立つ。\n【００３３】\n図１におけるフロー１００に戻ると、トーン‐カーブ‐スペース時間フィルタリ\nング１２５を実行すると、時間コヒーレントベースレイヤー１４０を得る。トーン\nマッピングされたビデオ１５０を生成するために、トーンマッピングシステムは時\n間コヒーレントベースレイヤー１４０と一つの詳細レイヤー１３５とを組み合わせ\nる。詳細レイヤー１３５はＨＤＲビデオ１０５の各ピクセルを、ベースレイヤー１\n１５の対応するピクセルで除算することにより導出される。言い換えると、ベース\nレイヤー１１５を生成するために使用された同一のＨＤＲビデオフレームをベース\nレイヤー１１５で除算することにより詳細レイヤー１３５を得る。この除算ファン\nクション１３０はＨＤＲビデオフレームから輝度を除去するが、詳細レイヤー１３\n５に記憶されているテクスチャおよびエッジ情報は残される。フロー１００に示さ\nれないが、技術者は詳細レイヤー１３５を変更するための芸術的設定を提供できる。\n例えば、技術者は詳細レイヤー１３５の一つのエッジを鋭くすること、または一つ\nのテクスチャを調整することを希望できる。これらの変更は詳細レイヤー１３５に\n対して直接行うことができる。\n【００３４】\nトーンマッピングシステムは、１ピクセル毎の乗算ファンクション１４５を使用\nして、詳細レイヤー１３５と時間コヒーレントベースレイヤー１４０を組み合わせ\nてトーンマッピングされたビデオ１５０の一つのフレームを生成する。一般的に、\nトーンマッピングされたビデオ１５０はＨＤＲビデオ１５０と同様な色対比および\n詳細（例えば同様なテクスチャ）を含む一方で狭い色範囲を有する。ある実施形態\nでは、乗算ファンクション１４５は色の増幅を実行するために加重される。しかし\nながら、別の実施形態では、乗算ファンクション１４５は加重されず、且つ詳細の\nレベルはトーンカーブにより制御される、－すなわちベースレイヤーが大幅に圧縮\nされると、その結果詳細はより明瞭となり、またその逆もある。\n【００３５】\nフロー１００はＨＤＲビデオ１０５における各フレームに対して繰り返す。そう\nすることで、トーンマッピングシステムは各フレームに対して一つのベースレイヤ\nー１１５を生成し、ベースレイヤー１１５からトーンカーブパラメータの値を同定\nし、そしてトーンカーブパラメータを時間フィルタリングする。このパラメータか\nら生成された一つのトーンカーブを使用すると、トーンカーブパラメータの時間フ\nィルタリング１２５を行い、且つ一つのトーンカーブを生成することにより、一つ\nの時間コヒーレントベースレイヤー１４０を得て、これを詳細レイヤー１３５と組\nみ合わせてトーンマッピングされたビデオ１５０を生成する。\n【図１】\n【図２】\n(2)  本件補正発明の概要\n前記第２の３の本件補正後の特許請求の範囲の記載、前記(1)の本願明細書の記\n載及び弁論の全趣旨によると、本件補正発明の概要は、次のとおりであると認めら\nれる。すなわち、本件補正発明は、ハイダイナミックレンジ（ＨＤＲ）ビデオ用の\nトーンマッピングの実行に関する発明である。ＨＤＲとは、大きい輝度幅をいうと\nころ、ＨＤＲビデオの輝度幅は、これを表示する装置が出力し得る輝度の範囲を超\nえることがあるため、ＨＤＲビデオのフレームを表示装置の輝度幅に対応するフレ\nームに変換する処理（トーンマッピング）をするとの技術が存在する。しかしなが\nら、従来、トーンマッピングがされたコンテンツが時間的コヒーレンス性（ＨＤＲ\nビデオの個別のフレームにおいて実行されるトーンマッピングがフレームごとに一\n致する度合い）を欠き、人の目で認識可能な連続するフレームの間で急激な明るさ\nの変化（フラッシュ等）が度々現れるという慢性的な課題があった。本件補正発明\nは、このような課題を解決するため、ＨＤＲビデオの一つのフレームを使用する第\n１のベースレイヤーを生成し、第１のベースレイヤーから一つのトーンカーブパラ\nメータ（第１のベースレイヤーのピクセルから導出された一つの統計的照度値）を\n導出し、第２のベースレイヤー（ＨＤＲビデオの一つの以前のフレームから導出さ\nれるもの）から導出されたトーンカーブパラメータの一つの以前に測定された値を\n使用してトーンカーブパラメータを時間フィルタリングした上、時間コヒーレント\nベースレイヤー（時間フィルタリングされたトーンカーブパラメータから導出され\nた一つのトーンカーブを使用するもの）を生成するとの方法を含む方法を採用した\nものである。これにより、本件補正発明は、トーンマッピングがされたビデオにお\nけるフレーム間の急激な明るさの変化ないしフラッシュを減少させ、又は除去する\nとの効果を奏するほか、トーンカーブパラメータに対してのみ時間フィルタリング\nを実行するため、ベースレイヤーの全体に対して時間フィルタリングを実行する必\n要がなく、コンピュータを駆使した処理が非常に少なくなるとの効果を奏する。\n２  取消事由１（甲１に記載された発明の認定の誤り）について\n(1)  甲１の記載\n甲１には、次の記載がある。\n【０００１】  本発明は、高品質ビデオデータの処理に関する。\n【００２０】  本発明は、ビデオフレームデータのストリームを圧縮する改良され\nた方法とその方法を実施するための装置を提供することを目的とする。本発明の第\n１の基本的な考えによれば、ビデオフレームデータのストリームを圧縮する方法が\n提案され、トーンマッピング関数が前記ストリームのビデオフレームに対して決定\nされ、前記トーンマッピング関数は異なるシーンに関するフレームに対して互いに\n異なり、トーンマッピング関数は同じシーンに関するストリームのフレームに対し\nて変更されることになる。\n【００２１】  シーンごとに異なるトーンマッピング関数を決定するだけでなく、\nビデオストリームで同じシーンを表示している間にもトーンマッピング関数を変更\nすることが明らかに有利であることが分かった。したがって、本発明の方法は、ト\nーンマッピング関数の変更がシーンの変更に対してのみ作用するビデオストリーム\nと比較して、著しく優れた品質を有するビデオデータのストリームを提供する。ス\nトリームを圧縮する本方法を高解像度ビデオデータ、すなわち多数の画素からなる\n画像に適用することが可能であり好ましい。ここで、本発明は、高解像度ビデオデ\nータによって提供される細かい空間的な詳細が、シーンが持続している間により明\n確に識別され得るという利点を提供する。\n【００２２】  本発明では、シーン内のトーンマッピング関数を徐々にしか変化さ\nせないことが非常に好ましい。トーンマッピング関数を徐々にしか変化させないこ\nとで、フレーム間の差が小さくなるため、受信画像がより自然なものになるように\n感じられる。なお、シーンの変更を伴わない照明のオン・オフなどによるシーンの\n照明の変更の場合には、トーンマッピング関数を徐々にしか変更しないという一般\n的な規則からの例外とし得ることに留意すべきである。\n【００３８】  図１によれば、高精細なハイダイナミックレンジのビデオフレーム\nからなるビデオフレームデータのストリーム１が提供される。ビデオストリーム１\nの１つのＨＤＲフレーム２は、ソフトウェア又はハードウェアのいずれかによって\n実装されてよく、ＨＤＲフレーム２からベースフレーム４を抽出するために使用さ\nれるフィルタ３に入力される。フィルタ３は、バイラテラルフィルタであってよい。\n【００３９】  ベースフレーム４は、結合段階において、例えば、ＨＤＲフレーム\n２からベースフレーム４を減算することによって、及び／又はＨＤＲフレーム２を\nベースフレーム４で除算することによって、初期ＨＤＲフレームと結合され、ＨＤ\nＲフレーム２の微細な細部に関連するディテールフレーム５が提供される。ベース\nフレーム４はさらに、トーンマッピング操作段階６に供給され、トーンマッピング\nルックアップテーブル７に格納された複数の－ここではあらかじめ定義されたトー\nンマッピング関数のうちの１つがベースフレームに対して選択される。\n【００４０】  所定のベースフレーム４に対して選択されたトーンマッピング関数\n６は、後述するように、ＨＤＲフレームの時間特性及び／又は以前のトーンマッピ\nング関数に関して、トーンマッピング関数ＴＭＯ*に変更される。次に、トーンマ\nッピング関数ＴＭＯ*は、ローダイナミックレンジベースフレーム８を得るように、\nベースフレーム４に適用される。ローダイナミックレンジベースフレーム８及びデ\nィテールフレーム５は、それぞれ段階９及び１０で別々に時間的圧縮アルゴリズム\nの処理がされる。時間的圧縮スキームは、当該技術分野においてそれ自体既知のも\nのであってよく、特にＭＰＥＧエンコーディング等に関するものであってよい。\n【００４１】  時間的に圧縮されたディテールフレームとベースフレーム９、１０\nと時間的に補正されたトーンマッピング関数ＴＭＯ*から、最終フレームが構築さ\nれる。高品質の圧縮ビデオストリームを得るために、説明した実施形態では、以前\nのフレームについて以前に得られたトーンマッピング関数に関して、トーンマッピ\nング関数を決定することが提案されている。したがって、所定のベースフレームに\n対するトーンマッピング関数は、同じシーンの以前のフレームに対して得られた複\n数の以前のトーンマッピング関数の特性を保存する時間特性段階１１に供給される。\nこれは、複数の以前のトーンマッピング関数をトーンマッピング関数テーブル７に\n格納することによって、及び／又はトーンマッピング関数全体を格納することによ\nって行うことができる。シーンの任意の変更時に時間的特性段階をリセットするた\nめに、シーン変更識別子段階を設けてもよいことに留意されたい（図示せず）。時\n間的特性段階１１は、ベースフレーム４に対して最初に決定された初期トーンマッ\nピング関数を受信すると、前のトーンマッピング関数と比較したトーンマッピング\n関数の変化が大きいか否かを決定する。トーンマッピング曲線の特定の部分が他の\n部分よりも高い重みを有するように、任意のそのような偏差を重み付けすることが\nできることは、当業者には明らかであろう。\n【００４２】  また、ルックアップテーブルエントリ番号の小さな変化がトーンマ\nッピング関数の小さな変化に対応するようにトーンマッピング関数テーブル７にト\nーンマッピング関数を格納することが可能であると、あるベースフレームのトーン\nマッピング機能から以前のベースフレームへの変化が大きいか否かを特に簡単に判\n断することができるようになる。トーンマッピング関数６の変化が緩やかであれば、\n実際のトーンマッピング関数ＴＭＯ*は、ベースフレーム４について決定された初\n期トーンマッピング関数に対応する。所定のベースフレーム４に対して決定された\nトーンマッピング関数の変化が大きすぎる場合には、初期トーンマッピング関数は、\n以前のトーンマッピング関数により近いトーンマッピング関数に修正される。これ\nは、単純な比較器によって決定することができる。従って、シーン内におけるトー\nンマッピング関数の変化は小さく、高品質の圧縮ビデオデータストリーム１２に基\nづいてフレームのシーケンスを示すことができる。\n(2)  前記(1)の甲１の記載によると、本件審決が認定した甲１発明のうち構成ａ\nは段落【００２０】に、構成ｂは段落【００３８】に、構成ｃは段落【００３９】\nに、構成ｄは段落【００３９】に、構成ｅは段落【００４０】に、構成ｆは段落\n【００４０】に、構成ｇは段落【００４１】に、構成ｈは段落【００４２】にそれ\nぞれ記載されているといえるところ、段落【００２０】の記載は、甲１に記載され\nた発明を一般的に説明するものであるし、段落【００３８】ないし【００４２】の\n記載は、いずれも図１（甲１によると、甲１に記載された発明の一つの実施形態を\n示す図面であると認められる。）の内容を説明するものであるから、これらの記載\nにより、まとまった一つの発明を認定することができるというべきである。したが\nって、甲１には、甲１発明が記載されていると認められる。これと同旨の本件審決\nの認定に誤りはない。\n(3)  小括\n以上のとおりであるから、取消事由１は理由がない。\n３  取消事由２（相違点についての判断の誤り）について\n(1)  本件周知技術の認定について\nア  甲３について\n(ｱ)  甲３の記載\n甲３には、次の記載がある。\n【技術分野】\n【０００１】\n本発明は、画像処理装置および方法、記録媒体、並びにプログラムに関し、特に、\n動画像のフレーム毎の輝度変動に対応した階調変換を実現できるようにした画像処\n理装置および方法、記録媒体、並びにプログラムに関する。\n【背景技術】\n【０００２】\n従来から、ＣＣＤ（Charge  Coupled  Device）などの固体素子で撮像されたデー\nタを、より低ダイナミックレンジなメディアに表示もしくは印刷するために階調を\n圧縮し、より見栄えの良くなるようにコントラストを強調するといった処理（階調\n変換）については、さまざまな方法が提案されてきた。例えば、撮像データからヒ\nストグラムを作成し、ヒストグラムの最大値、最小値、分布全体の代表値を元にヒ\nストグラムに対して適当な変形を施した後にＬＵＴ（Look  Up  Table）を構成し、\nこのＬＵＴを用いて階調変換を行うというものがある…。\n【発明の開示】\n【発明が解決しようとする課題】\n【０００３】\nしかしながら、既存の階調変換処理は静止画を前提として考えられているため、\n画像の輝度のヒストグラムの両端点を基準として階調変換を行なう場合、フレーム\n毎に大きなヒストグラムの変動があると、それにあわせて階調変換のカーブも変化\nするため、シーン全体の明るさがフレーム単位で頻繁に変化してしまい、非常に見\n苦しいものになってしまう。\n【００１１】\n以上で、階調変換処理によって起こりうる問題点について述べたが、その改善方\n法として、例えば過去数フレームの階調変換結果を保持しておき、現フレームの結\n果との平均を取ることによって、フレーム単位で発生する、シーン輝度の著しい変\n動を緩和する、といった方法が考えられるが、計算コストやメモリ量が大きくなっ\nてしまうと言う課題があった。\n【００１２】\n本発明はこのような状況に鑑みてなされたものであり、特に、階調変換処理にお\nいて、各フレーム毎の輝度をコントロールしているパラメータを時間方向に平滑化\nすることで、計算量、および、メモリ容量の低コスト化を図りつつ、フレーム毎の\nちらつきを抑制できるようにするものである。\n【００５７】\nＤＳＰ１１６は、Ａ／Ｄコンバータ１１５から入力された広ＤＲ画像に対して階\n調圧縮処理を施し、狭ＤＲ画像を生成して、Ｄ／Ａコンバータ１１８またはＣＯＤ\nＥＣ１２１、あるいは両方に出力する。…\n【００５８】\n次に、本発明の主眼となるＤＳＰ１１６について説明する。\n【００５９】\n図５は、モノクロ画像である広ＤＲ画像に対応したＤＳＰ１１６の第１の構成例\nを示している。以下、ＤＳＰ１１６に入力されるモノクロの広ＤＲ画像を、広ＤＲ\n輝度画像Ｌと記述する。また、広ＤＲ輝度画像の画素値（すなわち、輝度値）を、\nＬ（ｐ）と記述する。ここで、ｐは、ｐ＝（ｘ，ｙ）のように、画像における画素\n位置を示すベクトルまたは座標である。したがって、Ｌ（ｐ）は、画素位置と輝度\n値の両方の情報を含むものとして、広ＤＲ輝度画像を表すＬとは区別して用いるこ\nととする。後述するその他の画像とその画素値についても同様である。\n【００６０】\nＤＳＰ１１６には、広ＤＲ輝度画像Ｌの輝度Ｌ（ｐ）がラスタスキャン順に入力\nされるものとする。\n【００６１】\nＤＳＰ１１６の第１の構成例において、対数変換部１４１は、入力される輝度Ｌ\n（ｐ）を対数変換し、得られる対数輝度 logＬ（ｐ）をトーンカーブ補正部１４２\nに出力する。トーンカーブ補正部１４２は、入力される対数輝度 logＬ（ｐ）に対\nし、予め用意されているトーンカーブを適用して階調を圧縮する方向に変換し、得\nられる対数輝度 logＬＣ（ｐ）を縮小画像生成部１４３およびコントラスト補正部\n１４５に出力する。また、トーンカーブ補正部１４２は、適用したトーンカーブの\n傾きを示す代表値γをコントラスト補正部１４５に出力する。以下、適用したトー\nンカーブの傾きを示す代表値γを、単に代表値γとも記述する。\n【００７０】\n次に、ＤＳＰ１１６の第１の構成例の各部の詳細について、図面を参照して説明\nする。\n【００７１】\n図６は、トーンカーブ補正部１４２の第１の構成例を示している。上述の第１の\n構成例において、ＬＵＴメモリ１７１には、図７に示すような単調増加のトーンカ\nーブに相当するルックアップテーブル（以下、ＬＵＴと記述する）とトーンカーブ\nの傾きを示す代表値γが予め保持されている。なお、ＬＵＴの代わりに、トーンカ\nーブに相当する関数を保持するようにしてもよい。テーブル参照部１７２は、ＬＵ\nＴメモリ１７１に保持されているＬＵＴに基づいて対数輝度 logＬ（ｐ）を対数輝\n度 logＬＣ（ｐ）に補正する。\n【００７２】\n図７は、トーンカーブの一例を示しており、横軸が入力輝度Ｌ（ｐ）を、縦軸が\nトーンカーブ補正後の輝度Ｌｃ（ｐ）を、それぞれ［０，１］に正規化して対数軸\nで表示している。この例のように、単調増加であって、緩やかな逆Ｓ字形のトーン\nカーブを適用すると、高輝度領域と低輝度領域では、階調圧縮があまり強く作用し\nないので、階調圧縮後でも白ツブレや黒ツブレが少ない良好な色調が得られる。逆\nに中間輝度域は階調圧縮が強く作用するが、その分だけ、中間輝度域に対しては、\n後述するコントラスト補正が十分に適用されるので、中間輝度域でもコントラスト\n劣化のない良好な狭ＤＲ画像が得られる。\n【００７３】\nなお、トーンカーブの傾きを示す代表値γは、例えば、輝度全域の傾きをそれぞ\nれ求めて、それらの平均値を代表値γとすればよい。図７に示されたトーンカーブ\nの場合、代表値γ＝０．６７である。\n【００７４】\n図８は、トーンカーブ補正部１４２の第２の構成例を示している。第２の構成例\nは、第１の構成例のように予め用意されているＬＵＴを用いるのではなく、フレー\nム毎に代表値γを算出して、対数輝度 logＬ（ｐ）を、対数輝度 logＬＣ（ｐ）に補\n正するものである。第２の構成例において、平均輝度算出部１９１は、１フレーム\n分の対数輝度 logＬ（ｐ）の平均輝度値μを算出し、平均輝度平滑化部１９２に出\n力する。\n【００７５】\n平均輝度平滑化部１９２は、平均輝度算出部１９１より供給された平均輝度値μ\nを、前後のフレームの平均輝度値μ、または、前後のフレームの平滑化された平均\n輝度値μを用いて平滑化し、除算器１９３に供給する。除算器１９３は、所定の定\n数 logＬＴを平均輝度値μで除算し、代表値γを算出する。γメモリ１９４は、除\n算器１９３から入力された代表値γを保持する。乗算器１９５は、現フレームの対\n数輝度 logＬ（ｐ）に、γメモリ１９４に保持されている１フレーム前の代表値γ\nを乗算して、トーンカーブ補正後の対数輝度 logＬＣ（ｐ）を算出する。\n【００７６】\nここで、所定の定数 logＬＴを、中央レベルの対数輝度と定めておけば、１フレ\nーム分の対数輝度 logＬ（ｐ）の平均値が、logＬＴと等しい値のトーンカーブ補正\n後の対数輝度 logＬＣ（ｐ）に変換されることになる。\n【００７７】\n代表値γはフレーム毎に算出されるが、現実的には各フレームの対数輝度 logＬ\n（ｐ）の平均輝度値μに基づいて決定されるので、前後のフレームではあまり変化\nがないことが期待できる。したがって、この代表値γも、上述した縮小画像 logＬＣｌ\nおよび輝度域情報［Ｙｄ，Ｙｂ］と同様に、１フレーム前のものを、現フレームに\n対するトーンカーブ補正に用いるようにしている。…\n【図５】\n【図６】\n【図８】\n(ｲ)  甲３が開示する技術\nａ  甲３の記載（段落【００７４】及び【００７５】）によると、甲３には、次\nの方法（甲３にいうトーンカーブ補正部１４２の第２の構成例に係るもの）が記載\nされていると認められる。\n(a)  １フレーム分の対数輝度値 logＬ（ｐ）の平均輝度値μを算出し、\n(b)  上記(a)の平均輝度値μを前後のフレームの平滑化された平均輝度値μを用\nいて平滑化し、\n(c)  所定の定数 logＬＴを上記(b)において平滑化された平均輝度値μで除算し\nて代表値γを算出し、代表値γをメモリに保持し、\n(d)  現フレームの対数輝度 logＬ（ｐ）にメモリに保持されている１フレーム\n前の代表値γを乗算してトーンカーブ補正後の対数輝度 logＬＣ（ｐ）を算出する\n(e)  ステップを含むトーンカーブの補正の方法\nｂ  ここで、甲３の段落【００７４】には、「図８は、トーンカーブ補正部１４\n２の第２の構成例を示している。第２の構成例は、…フレーム毎に代表値γを算出\nして、対数輝度 logＬ（ｐ）を、対数輝度 logＬＣ（ｐ）に補正するものである。」\nとの記載があり、また、段落【００７７】には、「代表値γはフレーム毎に算出さ\nれる…。」との記載があるから、前記ａ(a)ないし(d)のステップは、フレームごと\nに行われるものと認められる（したがって、前記ａ(a)の「１フレーム分の」は、\n「１フレームごとに」と読み替えることができる。）。\nまた、前記ａ(c)は、γ＝（logＬＴ）／μとの式により代表値γを算出すること\nを意味するところ、式中のμには、前記ａ(b)において平滑化された平均輝度値μ\nが用いられている。\nさらに、前記ａ(d)は、logＬＣ（ｐ）＝γ×logＬ（ｐ）との式により、現フレ\nームのトーンカーブを代表値γ（上記のとおり、平滑化された平均輝度値μを用い\nて算出されたもの）により補正することを意味する。\n以上によると、前記ａ(a)は、本件周知技術にいう「フレーム毎に平均輝度値を\n算出し」に相当し、前記ａ(b)は、本件周知技術にいう「算出した平均輝度値を複\n数のフレームで平滑化し」に相当し、前記ａ(c)及び(d)は、本件周知技術にいう\n「平滑化した平均輝度値を用いて現在のフレームのトーンカーブを補正する」に相\n当するといえる。\nそうすると、甲３には、本件審決が認定した本件周知技術が開示されているもの\nと認められる。\nイ  甲２について\n(ｱ)  甲２の記載\n甲２（訳文として、原告提出のもののほか、被告提出の乙１がある。）には、次\nの記載がある。\nａ  「有利には、本方法は、Ｍ個のハイダイナミックレンジピクチャについて決\n定された平均輝度の代表値をシーケンスの少なくともＭ個のハイダイナミックレン\nジピクチャにわたって時間的にフィルタリングすることをさらに含み、ここでＭは、\n厳密に１より大きい整数であり、Ｍ個のハイダイナミックレンジピクチャの少なく\nとも１枚の画像の処理は、フィルタリングした値を使用する。\n変形例によれば、この方法は、ガンマ補正を適用する前に、シーケンスの少なく\nともＭ個のハイダイナミックレンジピクチャに対して、Ｍ個のハイダイナミックレ\nンジピクチャについて決定されたガンマ係数を時間的にフィルタリングすることを\n含み、Ｍは、厳密に１より大きい整数であり、Ｍ個のハイダイナミックレンジピク\nチャの少なくとも１つのピクチャにガンマ補正を適用するには、フィルタリングし\nたガンマ係数を使用することを含む。\n時間的フィルタリングは、シーケンス上の時間的コヒーレンスを保持する。」\n（４頁５～１７行目）\nｂ  「Ｎ枚のＨＤＲピクチャーのシーケンスを符号化する方法が開示されている。\nＮは、１以上の整数である。第１の具体的かつ非限定的な実施形態において、シー\nケンス全体を符号化するために、同じステップがシーケンスの各ピクチャに独立し\nて適用される。図１は、このように、本発明の第１の実施形態による符号化方法の\nフローチャートである。より正確には、図１は、以下のエンコーディングのステッ\nプを示す。ここで、ｉは、シーケンス内のピクチャの位置を特定する整数のインデ\nックスである。\nステップ１０において、現在のＨＤＲピクチャＰ ｉの平均輝度を代表する値\navg_lum が取得される。」（７頁２８行目～８頁４行目）\nｃ  「ステップ１２において、ＨＤＲピクチャＰｉは、値 avg_lum と定義された\n平均輝度値 desired_avg_lum とに基づいて処理され、バランスのとれた輝度ピクチ\nャを得る。…一例として、ＨＤＲピクチャＰｉを処理することは、ガンマ補正を適\n用することからなる。したがって、Ｐｉの各ピクセルについて、その値ＶはＶγ に\n変更され、γはガンマ係数であり、log2（desired_avg_value）／log2（avg_lum）\nに等しい。画像Ｐｉにガンマカーブを適用することで、画像の平均輝度値を avg_lu\nm から desired_median_value に近い値へシフトさせる。」（８頁９～２０行目）\nｄ  「図６及び図７は、第２の非限定的実施形態による符号化方法のフローチャ\nートを示す。…この実施形態によれば、画素の値 log2 の正規化に用いられる値\navg_lum…は、ビデオにわたって時間的にフィルタリングされる。そして、フィル\nタリングされた値は、フィルタリングされていない値の代わりに、処理ステップの\n間に使用される。そうすることで、avg_lum…の値の変動がシーケンス上で平滑化\nされる。その結果、シーケンスのピクチャは、より多くの輝度コヒーレンスを有し、\nこれは、また符号化効率を向上させる。変形例によれば、ガンマ係数 γは、値\navg_lum の代わりにビデオ上でフィルタリングされる。そして、フィルタリングさ\nれたガンマ係数は、フィルタリングされていないガンマ係数の代わりに、処理ステ\nップの間に使用される。」（１３頁９～２１行目）\nｅ  「図６に関して、ステップ６０において、インデックスｉのピクチャＰにつ\nいて、avg_lum(i)…の値が得られる。このステップは、ステップ１０と同一であり、\nステップ１０について開示したすべての変形がステップ６０に適用される。…特定\nの実施形態によれば、インデックスｉのピクチャＰについて、 avg_lum(i)及び\ndesired_avg_lum からガンマ係数γ（ｉ）が決定される。一例として、γ（ｉ）＝\nlog2(desired_avg_value)／log2(avg_lum(i))である。」（１４頁１～８行目）\nｆ  「ステップ６４において、値 avg_lum(i)（又はそのような値がステップ６\n０において決定される場合には、γ（ｉ））…がシーケンス上で時間的にフィルタ\nリングされて、フィルタリング値 filt_avg_lum(i)（又は filt_γ(i)）…が取得さ\nれる。この目的のために、現在のピクチャＰｉを構成するサイズＭのスライディン\nグウィンドウが使用される。現在のピクチャに対するフィルタリングされた値\nfilt_avg_lum(i)（又は filt_γ(i)）は、スライディングウィンドウ内のピクチャ\nＰｊに関連する値 avg_lum(j)（又はγ(j)）の平均としてセットされる。」（１４\n頁１２～１８行目）\nｇ  「図７に関して、ステップ７０において、現在のＨＤＲピクチャＰｉは、フ\nィルタリングされた値 filt_avg_lum(i)…で処理されて、バランスのとれた輝度ピ\nクチャを得る。ステップ１２について開示された同じ変形例がステップ７０につい\nても適用される。一例として、ＨＤＲピクチャＰを処理することは、ガンマ補正を\n適用することを含んでいる。したがって、Ｐｉの各画素について、その値ＶはＶγ\nに変更され、γはガンマ係数であり、log2(desired_avg_value)／log2(filt_avg_l\num(i))と等しい。変形例によれば、現在のＨＤＲピクチャＰｉは、フィルタリング\nされたガンマ係数 filt_γ(i)…で処理されて、バランスの良い輝度ピクチャを得\nる。したがって、Ｐｉの各画素について、その値Ｖは、γ＝filt_γ(i)であるＶγ\nに変更される。」（１４頁２６行目～１５頁２行目）\n(ｲ)  甲２が開示する技術\nａ  甲２の記載（前記(ｱ)ｅないしｇ）によると、甲２には、次の方法（甲２に\nいう第２の非限定的実施形態に係るもの）が記載されていると認められる。\n(a)  インデックスｉのピクチャＰについて、値 avg_lum(i)を取得し、\n(b)  値 avg_lum(i)をシーケンス上で時間的にフィルタリングしてフィルタリン\nグ値 filt_avg_lum(i)を取得し、フィルタリング値 filt_avg_lum(i)は、スライデ\nィングウィンドウ内のピクチャＰｊに関連する値 avg_lum(j)の平均としてセットさ\nれ、\n(c)  現在のＨＤＲピクチャＰｉをフィルタリング値 filt_avg_lum(i)で処理し、\n一例として、Ｐｉの各画素について、その値ＶはＶγ に変更され、γはガンマ係数\nであり、log2(desired_avg_value)／log2(filt_avg_lum(i))と等しい\n(d)  ステップを含むＨＤＲピクチャの処理方法\nｂ  ここで、甲２の記載（前記(ｱ)ａ及びｂ）によると、前記ａ(a)の「インデッ\nクスｉのピクチャＰ」は、Ｍ個のＨＤＲピクチャにおける個々のフレームを意味し、\n「値 avg_lum(i)」は、インデックスｉのピクチャＰの平均輝度値（現在のＨＤＲ\nピクチャＰｉの平均輝度を代表する値）を意味するものと認められる。\nまた、前記ａ(b)の「フィルタリング値 filt_avg_lum(i)」は、サイズＭのスラ\nイディングウィンドウ内の各ピクチャＰｊに関連する値 avg_lum(j)の平均（Ｍ個の\navg_lum(j)の平均）としてセットされるものであるから、前記ａ(b)の「値 avg_lu\nm(i)をシーケンス上で時間的にフィルタリングしてフィルタリング値 filt_avg_lu\nm(i)を取得」するとは、前記ａ(a)のようにして取得されたインデックスｉのピク\nチャＰの平均輝度値を複数のフレームで平滑化することを意味する。\nさらに、前記ａ(c)のγは、log2(desired_avg_value)／log2(filt_avg_lum(i))\nと等しいものであるところ、上記のとおり、「filt_avg_lum(i)」は、平滑化した\n平均輝度値に相当するから、現在のＨＤＲピクチャＰｉの各画素につきその値Ｖを\nＶγ に変更する処理においてそのようなγを用いることは、平滑化した平均輝度値\nを用いて現在のフレームのトーンカーブを補正することを意味する。\n以上によると、前記ａ(a)は、本件周知技術にいう「フレーム毎に平均輝度値を\n算出し」に相当し、前記ａ(b)は、本件周知技術にいう「算出した平均輝度値を複\n数のフレームで平滑化し」に相当し、前記ａ(c)は、本件周知技術にいう「平滑化\nした平均輝度値を用いて現在のフレームのトーンカーブを補正する」に相当すると\nいえる。\nそうすると、甲２には、本件審決が認定した本件周知技術が開示されているもの\nと認められる。\nウ  甲４について\n(ｱ)  甲４の記載\n甲４には、次の記載がある。\nａ  「３．２． トーンマッピング\n我々が選択した階調再現オペレータは、そのパラメータが自動化できることから、\n写真オペレータを使用している。しかしながら、パラメータの推定には、定義上、\n外れ値である最小輝度Ｌｍｉｎと最大輝度Ｌｍａｘが必要である。画像の幾何平均Ｌａｖ\nを加えて、シーンａのキーが次のように推定される。\nａ＝０．１８＊２２（Ｂ－Ａ）／（Ａ＋Ｂ）     （１ａ）\nＡ＝Ｌｍａｘ－Ｌａｖ                    （１ｂ）\nＢ＝Ｌａｖ－Ｌｍｉｎ                    （１ｃ）\nそして、写真階調再現では、画像の幾何平均を推定キー値、Ｌ（ｘ，ｙ）＝ａＬ\n（ｘ，ｙ）／Ｌａｖにマッピングし、その後、非線形圧縮を適用する。\nここで、Ｌｗｈｉｔｅは、白にマッピングすべき最小の入力値を指定するユーザパラメ\nータである。」（３頁左欄４～１９行目）\nｂ  「我々のトーンマッピングシステムは、式１ａから式１ｃのパラメータに適\n用されるリーキー積分器を用いて、トーンマッピングされたＨＤＲビデオのフリッ\nカーを低減することを目的とする。一時記憶のＴＭＯアルゴリズムにより得られる\nＴＭＯのパラメータのフレーム間の急激な変化を低減するためのフィルタとして、\n正規化したバージョンのリーキー積分器を使用する。…フィルタリングされたｎフ\nレーム目のＡｎ、Ｂｎ及びａｎを計算するための更新された式は、式３ａから式３ｃ\nで与えられる。\nＡｎ＝（１―αＡ）Ａ（ｎ－１）＋（αＡ）Ａ      （３ａ）\nＢｎ＝（１－αＢ）Ｂ（ｎ－１）＋（αＢ）Ｂ      （３ｂ）\nａｎ＝（１－αａ）ａ（ｎ－１）＋（αａ）ａ      （３ｃ）\nパラメータαＡ、αＢ及び αａは、［０，１］のとき定数であり、この例では、全\nて０．９８に設定されている。…内部のＴＭＯパラメータにリーキー積分器を適用\nした結果、図３ｂのフレームに示されるようにフリッカーが低減された。」（３頁\n左欄３１行目～右欄１１行目）\n(ｲ)  甲４が開示する技術\nａ  甲４の記載（前記(ｱ)）によると、甲４には、次の方法が記載されていると\n認められる。\n(a)  最小輝度Ｌｍｉｎ及び最大輝度Ｌｍａｘに画像の幾何平均Ｌａｖを加えて、シー\nンａのキー（パラメータａ、Ａ及びＢ）を下記の式１ａないし式１ｃにより推定す\nるステップと、\nａ＝０．１８＊２２（Ｂ－Ａ）／（Ａ＋Ｂ）     （１ａ）\nＡ＝Ｌｍａｘ－Ｌａｖ                    （１ｂ）\nＢ＝Ｌａｖ－Ｌｍｉｎ                    （１ｃ）\n(b)  上記(a)により得られたパラメータにリーキー積分器を適用することにより、\nすなわち、下記の式３ａないし式３ｃに従って計算することにより、フィルタリン\nグされたｎフレーム目のパラメータＡｎ、Ｂｎ及びａｎを得るステップと、\nＡｎ＝（１―αＡ）Ａ（ｎ－１）＋（αＡ）Ａ      （３ａ）\nＢｎ＝（１－αＢ）Ｂ（ｎ－１）＋（αＢ）Ｂ      （３ｂ）\nａｎ＝（１－αａ）ａ（ｎ－１）＋（αａ）ａ      （３ｃ）\n(c)  上記(b)によりフィルタリングされたパラメータを基に画像の幾何平均を推\n定キー値（Ｌ（ｘ，ｙ）＝ａＬ（ｘ，ｙ）／Ｌａｖ）にマッピングするステップと、\n(d)  上記(c)によりマッピングした値に下記の式２の非線形圧縮を適用するステ\nップ\n(e)  とを含むＨＲＤビデオのフリッカーを低減させるトーンマッピングの方法\nｂ  ここで、前記ａ(a)の「画像の幾何平均Ｌａｖ」は、「画像の平均輝度値」を\n意味するところ、ここでいう「画像」は、個々の画像（フレーム）を指すものと解\nされる。なお、甲４の記載（前記(ｱ)ｂ）によると、前記ａの方法は、フレーム間\nの急激な変化（フリッカー）を低減させるために用いられるものであると認められ\nるから、この点からも、前記ａ(a)の「画像」は、個々のフレームを指すというべ\nきである。\nまた、前記ａ(b)の式３ａないし式３ｃの内容をみると、これらは、（ｎ－１）\nフレーム目のフィルタリングされたパラメータＡｎ－１、Ｂｎ－１及びａｎ－１とフィル\nタリングされる前のパラメータＡ、Ｂ及びａを重み付きで加算することによりフィ\nルタリングされたｎフレーム目のパラメータＡｎ、Ｂｎ及びａｎを得る操作であると\n理解されるから、式３ａないし式３ｃの計算は、複数のフレームで平滑化すること\nに当たるというべきである。また、式１ａないし式１ｃ及び式３ａないし３ｃによ\nると、パラメータＡｎ－１、Ｂｎ－１及びａｎ－１並びにＡ、Ｂ及びａは、いずれも平均\n輝度値であるＬａｖを含むものであるといえるから、式３ａないし式３ｃの計算に\nより、平均輝度値も含めた平滑化が行われることは明らかである。\nさらに、前記ａ(d)の式２の「Ｌｄ（ｘ，ｙ）」は、ディスプレイの輝度値をい\nうものと解されるから（なお、甲４の１頁右欄３１～３５行目参照）、これを算出\nする式２は、トーンカーブを意味するといえ、また、前記ａ(c)のステップにおい\nて用いられるパラメータ及び前記ａ(d)のステップにおいて用いられる値（前記ａ\n(c)のステップにおいてマッピングした値）は、いずれも前記ａ(b)のステップにお\nいて得られる平滑化された平均輝度値を含むものである。なお、前記ａの方法にお\nけるトーンマッピングが現在のフレームに対して行われるものであることは、前記\nａの方法の上記目的に照らし、明らかである。\n以上によると、前記ａ(a)は、本件周知技術にいう「フレーム毎に平均輝度値を\n算出し」に相当し、前記ａ(b)は、本件周知技術にいう「算出した平均輝度値を複\n数のフレームで平滑化し」に相当し、前記ａ(c)及び(d)は、本件周知技術にいう\n「平滑化した平均輝度値を用いて現在のフレームのトーンカーブを補正する」に相\n当するといえる。\nそうすると、甲４には、本件審決が認定した本件周知技術が開示されているもの\nと認められる。\nエ  本件周知技術の認定の可否\n以上のとおりであるから、甲２ないし４により、本件周知技術を認めることがで\nきる。\n(2)  本件周知技術の甲１発明への適用に係る動機付けについて\n甲１の記載及び弁論の全趣旨によると、甲１発明は、ＨＤＲビデオにおけるトー\nンマッピングの方法に関する発明であると認められる。これに対し、甲２ないし４\nの記載及び弁論の全趣旨によると、本件周知技術も、ＨＤＲビデオにおけるトーン\nマッピングの方法に関する技術であると認められるから、甲１発明と本件周知技術\nは、その属する技術分野を同一にするといえる。\nまた、甲１の記載及び弁論の全趣旨によると、甲１発明は、トーンマッピングさ\nれたビデオの各フレームの間の輝度の差を小さくし、受信画像をより自然なものに\nするため、トーンマッピング関数を徐々にしか変化させないものとするとの課題を\n有すると認められる。これに対し、本件周知技術は、その内容に照らし、トーンマ\nッピングするビデオの各フレームに適用されるトーンマッピング関数を徐々に変化\nさせるための技術であると認められるから、本件周知技術は、甲１発明の上記課題\nを解決するための技術であるといえる。\n加えて、甲３の記載によると、本件周知技術（甲３にいうトーンカーブ補正部１\n４２の第２の構成例に係るもの）は、甲１発明のようにあらかじめ用意されている\nルックアップテーブル（ＬＵＴ）により時間的な変化が小さいトーンマッピング関\n数を使用するとの構成（甲３にいうトーンカーブ補正部１４２の第１の構成例に係\nるもの）に代えて採用し得るものと認められる。\n以上によると、本件周知技術を甲１発明に適用することについては、十分な動機\n付けがあるものと認められる。\nそして、本件全証拠によっても、本件周知技術を甲１発明に適用することについ\nて、これを阻害する要因があるものと認めることはできないから、当業者は、甲１\n発明に本件周知技術を適用することができたものと認めるのが相当である。\n(3)  小括\n前記(1)及び(2)のとおりであるから、当業者は、甲１発明に本件周知技術を適用\nし、相違点に係る本件補正発明の構成に容易に想到し得たものと認められる。した\nがって、これと同旨の本件審決の判断に誤りはなく、取消事由２は理由がない。\n４  結論\n以上の次第であるから、原告の請求は理由がない。\n知的財産高等裁判所第２部\n裁判長裁判官\n本     多     知     成\n裁判官\n浅      井              憲\n裁判官\n勝     又     来  未  子\n"
}