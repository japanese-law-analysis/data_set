{
  "trial_type": "IPCase",
  "date": {
    "era": "Heisei",
    "year": 27,
    "month": 6,
    "day": 11
  },
  "case_number": "平成26(行ケ)10212",
  "case_name": "審決取消請求事件",
  "court_name": "知的財産高等裁判所",
  "right_type": "特許権",
  "lawsuit_type": "行政訴訟",
  "lawsuit_id": "85160",
  "detail_page_link": "https://www.courts.go.jp/app/hanrei_jp/detail7?id=85160",
  "full_pdf_link": "https://www.courts.go.jp/app/files/hanrei_jp/160/085160_hanrei.pdf",
  "contents": "平成２７年６月１１日判決言渡  同日原本領収  裁判所書記官\n平成２６年（行ケ）第１０２１２号  審決取消請求事件\n口頭弁論終結日  平成２７年５月１４日\n判     決\n原告               テレフオンアクチーボラゲット\nエル エム エリクソン（パブル）\n訴 訟 代 理 人 弁 護 士               髙梨義幸\n訴 訟 代 理 人 弁 理 士               稲葉良幸\n同             佐藤   睦\n同             笹   本   真理子\n被告               特許庁長官 Ｘ\n指定代理人                石井茂和\n同             木村貴俊\n同             相崎裕恒\n同             根岸克弘\n主     文\n１  原告の請求を棄却する。\n２  訴訟費用は原告の負担とする。\n３  この判決に対する上告及び上告受理の申立てのための付加期間を３\n０日と定める。\n事実及び理由\n第１  請求\n特許庁が不服２０１２－１６３９１号事件について平成２６年４月３０日に\nした審決を取り消す。\n第２  事案の概要\n１  特許庁における手続の経緯等\n(1)  原告は，発明の名称を「電気通信システムにおける方法および構成」と\nする発明について，２００８年（平成２０年）５月２０日（優先権主張日２\n００７年（平成１９年）９月１７日，米国）を国際出願日とする特許出願（\n特願２０１０－５２４８２０号。以下「本願」という。）をした。\n原告は，平成２４年４月１９日付けの拒絶査定（甲７）を受けたため，同\n年８月２３日，拒絶査定不服審判を請求した。\n(2)  特許庁は，上記請求を不服２０１２－１６３９１号事件として審理を行\nい，平成２６年４月３０日，「本件審判の請求は，成り立たない。」との審\n決（出訴期間の付加期間９０日。以下「本件審決」という。）をし，同年５\n月１２日，その謄本が原告に送達された。\n(3)  原告は，平成２６年９月９日，本件審決の取消しを求める本件訴訟を提起\nした。\n２  特許請求の範囲の記載\n本願の特許請求の範囲の請求項１の記載は，次のとおりである（以下，請求\n項１に係る発明を「本願発明」という。甲４）。\n「【請求項１】  次世代パケットシステムＥＰＳのモビリティ管理エンティテ\nィ（１３）ＭＭＥにおいて，ユーザ装置（１１）ＵＥと前記ＵＥにサービスす\nるｅＮｏｄｅＢ（１２）との間のＲＲＣ／ＵＰトラフィックを保護するために\nセキュリティキーＫ＿ｅＮＢを確立する方法であって，以下の\n－  ＮＡＳサービス要求を前記ＵＥから受信するステップ（３２，５２）で\nあって，前記要求が，ＮＡＳアップリンクシーケンス番号ＮＡＳ＿Ｕ＿ＳＥＱ\nを示すステップと，\n－  少なくとも前記受信されたＮＡＳ＿Ｕ＿ＳＥＱから，および前記ＵＥと\n共有される，記憶されたアクセスセキュリティ管理エンティティキーＫ＿ＡＳ\nＭＥから，前記セキュリティキーＫ＿ｅＮＢを導出するステップ（３３，５３）\nと，\n－  前記導出されたＫ＿ｅＮＢを，前記ＵＥにサービスする前記ｅＮｏｄｅ\nＢ（１２）に転送するステップ（３４）と，を含む，ＭＭＥにおける方法。」\n３  本件審決の理由の要旨\n(1)  本件審決の理由は，別紙審決書（写し）記載のとおりである。要するに，\n本願発明は，本願の優先権主張日前に頒布された刊行物に記載された発明又\nは電気通信回線を通じて公衆に利用可能となった発明，すなわち，「3GPP，U\nniversal Mobile Telecommunications System (UMTS);Evolved Universal T\nerrestrial Radio Access (E-UTRA) and Evolved Universal Terrestrial R\nadio Access (E-UTRAN);Overall description;Stage 2(3GPP TS 36.300 ver\nsion 8.1.0 Release 8)，[online]，２００７年  ６月，p.11-15， 58，59\n；ＵＲＬ，http://www.etsi.org/deliver/etsi_ts/136300_136399/136300/0\n8.01.00_60/ts_136300v080100p.pdf」（以下「引用刊行物１」又は「3GPP T\nS 36.300 version 8.1.0 Release 8」という。甲１）に掲載された発明等に\n基づいて当業者が容易に発明をすることができたものであって，特許法２９\n条２項の規定により特許を受けることができないから，本願は拒絶すべきも\nのであるというものである。\n(2)  本件審決が認定した引用刊行物１に記載された発明（以下「引用発明」と\nいう。），本願発明と引用発明の一致点及び相違点は，以下のとおりである。\nア  引用発明\n「ＵＥと，ＵＥに対する資源の動的配置，ユーザ・データ・ストリームを\n暗号化するｅＮＢと，ｅＮＢへのページング・メッセージの分配，セキュ\nリティ制御，及び，ＮＡＳ信号伝達の暗号化と完全性保護を行うＭＭＥと\nを有する無線通信システムにおいて，\nＵＥとＭＭＥは，Ｋ＿ＡＳＭＥという名の基本鍵を共有し，前記Ｋ＿Ａ\nＳＭＥからＫ＿ｅＮＢが得られ，\n前記Ｋ＿ｅＮＢを得るために，シーケンス番号が使用され，\n前記Ｋ＿ｅＮＢは，ＭＭＥから，ｅＮＢに送信される，方法。」\nイ  本願発明と引用発明の一致点\n「次世代パケットシステムＥＰＳのモビリティ管理エンティティＭＭＥに\nおいて，ユーザ装置ＵＥと前記ＵＥにサービスするｅＮｏｄｅＢとの間の\nＲＲＣ／ＵＰトラフィックを保護するためにセキュリティキーＫ＿ｅＮＢ\nを確立する方法であって，\nシーケンス番号と，および前記ＵＥと共有される，記憶されたアクセス\nセキュリティ管理エンティティキーＫ＿ＡＳＭＥから，前記セキュリティ\nキーＫ＿ｅＮＢを導出するステップと，\n前記導出されたＫ＿ｅＮＢを，前記ＵＥにサービスする前記ｅＮｏｄｅ\nＢに転送するステップ，とを含む方法。」である点。\nウ  本願発明と引用発明の相違点\n“シーケンス番号”に関して，\n本願発明においては，「ＮＡＳサービス要求を前記ＵＥから受信するス\nテップ（３２，５２）であって，前記要求が，ＮＡＳアップリンクシーケ\nンス番号ＮＡＳ＿Ｕ＿ＳＥＱを示すステップ」において，「ＵＥ」側から\n「ＭＭＥ」側が受信する「アップリンクシーケンス番号」であるのに対し\nて，\n引用発明においては，「シーケンス番号」が，「ＵＥ」から，「ＭＭＥ」\nへの「アップリンクシーケンス番号」であるか否かが明確でない点。\n第３  当事者の主張\n１  原告の主張\n(1)  取消事由１（引用発明及び一致点の認定の誤り）\n引用刊行物１（甲１）には，「Ｋ＿ｅＮＢ」を得るために，「シーケンス\n番号」（sequence number）が使用される構成についての開示はないから，本\n件審決が認定した引用発明のうち，「前記Ｋ＿ｅＮＢを得るために，シーケ\nンス番号が使用され」との部分は誤りであり，本件審決が引用発明が上記部\n分の構成を有することを前提に，「シーケンス番号と，および前記ＵＥと共\n有される，記憶されたアクセスセキュリティ管理エンティティキーＫ＿ＡＳ\nＭＥから，前記セキュリティキーＫ＿ｅＮＢを導出するステップ」を本願発\n明と引用発明の一致点と認定したことも誤りである。\nア  引用発明の認定の誤り\n本件審決は，引用刊行物１（甲１）の「A given sequence number must\nonly be used once for a given eNB key」との記載を「得られたシーケン\nス番号は，ｅＮＢ鍵を得るために使用されるのは，一度のみでなければな\nらない」と和訳（以下「本件和訳」という場合がある。）した上で，上記\n記載箇所から「“ｅＮＢ鍵を得るために，シーケンス番号が使用される”\nことが読み取れる。」と認定したが，以下のとおり誤りである。\n(ア)  引用刊行物１の「A given sequence number must only be used on\nce for a given eNB key」との記載は，「所与のあるシーケンス番号は，\n所与のあるｅＮＢ鍵のために使用されるのは，一度のみでなければならな\nい」と訳すべきである。上記記載中の「for a given eNB key」の部分を\n本件和訳のように「ｅＮＢ鍵を得るために」を意味すると解する余地はな\nい。仮に「得るために」と英語表記するのであれば，「to get」，「to o\nbtain」又は「to derive」などの語を用いるはずであるが，そのような語\nは用いられていない。\nしたがって，本件審決が上記記載箇所について本件和訳をし，上記記載\n箇所から「“ｅＮＢ鍵を得るために，シーケンス番号が使用される”こ\nとが読み取れる。」と認定したのは誤りである。\n(イ)  次に，「A given sequence number must only be used once for a\ngiven eNB key」との記載の前後の文脈からみても，本件和訳は誤りであ\nる。\nａ  引用刊行物１の「14 Security」の「14.1 Overview and Principle\ns」（「１４  セキュリティ」の「１４．１  概説及び原則」）には，\n以下のとおり，Ｅ－ＵＴＲＡＮのセキュリティに適用される６つの原\n則（「第１原則」ないし「第６原則」）が記載されており，「A give\nn sequence number must only be used once for a given eNB key」\nとの記載は，第５原則の第２文の一部である。\n「- The eNB keys are cryptographically separated from the EP\nC keys used for NAS protection (making it impossible to use th\ne eNB key to figure out an EPC key).」（以下「第１原則」という。）\n「- The keys are derived in the EPC/UE from key material tha\nt was generated by a NAS (EPC/UE) level AKA procedure.」（以下\n「第２原則」という。）\n「- The eNB keys are sent from the EPC to the eNB when the U\nE is entering LTE_ACTIVE state (i.e. during RRCconnection or S\n1 context setup).」（以下「第３原則」という。）\n「- Key material for the eNB keys is sent between the eNBs d\nuring LTE_ACTIVE intra-E-UTRAN mobility.」（以下「第４原則」と\nいう。）\n「- A sequence number is used as input to the ciphering and\nintegrity protection. A given sequence number must only be use\nd once for a given eNB key (except for identical re-transmissi\non). The same sequence number can be used for both ciphering a\nnd integrity protection.」（以下「第５原則」という。）\n「- A hyper frame number (HFN) (i.e. an overflow counter mec\nhanism) is used in the eNB and UE in order to limit the actual\nnumber of sequence number bits that is needed to be sent over\nthe radio. The HFN needs to be synchronized between the UE an\nd eNB.」（以下「第６原則」という。）\nｂ  引用刊行物１の「１４．１  概説及び原則」は，Ｅ－ＵＴＲＡＮのセ\nキュリティ手続全体の概説及び原則を述べたものである。\n「１４．１  概説及び原則」記載の第１原則ないし第４原則はｅＮＢ\n鍵の生成や配送について，第５原則は，鍵を用いて暗号化及び完全性保\n護を実現すること，当該手続にシーケンス番号を用いることについて，\n第６原則はＨＦＮの取り決めについてそれぞれ述べたものである。\n第５原則は，第１文において「A sequence number is used as inpu\nt to the ciphering and integrity protection.」（「シーケンス番\n号は，暗号化及び完全性保護のための入力として用いられる。」）と記\n載し，第３文において「The same sequence number can be used for\nboth ciphering and integrity protection.」（「同一のシーケンス\n番号が，暗号化と完全性保護の両方に用いることができる。」）と記載\nしているように，暗号化及び完全性保護の手続，すなわち「鍵を用いる」\n手続について述べたものであるから，その第２文である「A given sequ\nence number must only be used once for a given eNB key」につい\nても，同様に暗号化及び完全性保護の手続について述べたものと理解す\nべきであり，これを「鍵の生成」について述べたものと理解することは\n極めて不自然であって，恣意的な解釈であるといわざるを得ない。\nｃ  「１４．１  概説及び原則」の最終段落には，「From K_ASME, the N\nAS, (and indirectly) K_eNB keys are derived. The K_ASME never\nleaves the EPC, but the K_eNB key is transported to the eNB fr\nom the EPC when the UE transitions to LTE_ACTIVE. From the K_e\nNB, the eNB and UE can derive the UP and RRC keys.」（「Ｋ＿Ａ\nＳＭＥから，ＮＡＳ（そして，間接的に），Ｋ＿ｅＮＢが得られる。Ｋ\n＿ＡＳＭＥは，決して，ＥＰＣから離れない。しかしながら，Ｋ＿ｅＮ\nＢ鍵は，ＵＥが，ＬＴＥ＿ＡＣＴＩＶＥに移行すると，ＥＰＣからｅＮ\nＢに運ばれる。Ｋ＿ｅＮＢから，ｅＮＢ，及び，ＵＥは，ＵＰ，及び，\nＲＲＣ鍵を得ることができる。」）との記載がある。この記載から，Ｅ\nＰＣにおいて得られたＫ＿ｅＮＢがｅＮＢに運ばれ，ｅＮＢ及びＵＥに\nおいて，当該Ｋ＿ｅＮＢを基にしてＵＰ鍵及びＲＲＣ鍵を得ていること\nが明らかである。\nそして，ＵＥとｅＮＢ間のプロトコルで用いられる鍵は，引用刊行物\n１の「Figure 14.1-1」（別紙１参照）に示すとおり，Ｋ＿ｅＮＢの下\n位の鍵であるＫｅＮＢ－ＵＰ－ｅｎｃ（ＵＰ鍵），ＫｅＮＢ－ＲＲＣ－ｅｎｃ（ＲＲＣ鍵）\n及びＫｅＮＢ－ＲＲＣ－ｉｎｔ（ＲＲＣ鍵）であり，このうち，ＫｅＮＢ－ＵＰ－ｅｎｃ及\nびＫｅＮＢ－ＲＲＣ－ｅｎｃは暗号化に用いられる鍵である。\nまた，引用刊行物１（3GPP TS 36.300 version 8.1.0 Release 8）\nの後のバージョンの甲８（3GPP TS 36.300 version 8.8.0 Release 8）\nに「A sequence number (COUNT) is used as input to the ciphering\nand integrity protection.」との記載があることからすると，第５原\n則の第２文中の「A given sequence number」にいう「sequence numbe\nr」とは「ＣＯＵＮＴ」を意味する。\nさらに，引用刊行物１の後のバージョンの甲９の１（3GPP TS 36.32\n3 version 1.0.0 Release 8）には，シーケンス番号の一種である「Ｃ\nＯＵＮＴ」が，暗号化及び完全性保護のパラメータとして，ＫＲＲＣｅｎｃ，\nＫＵＰｅｎｃ及びＫＲＲＣｉｎｔのようなｅＮＢ鍵の下位の鍵と共に用いられる\nことが示されている。\nそうすると，第５原則は，第１文において，シーケンス番号が暗号化\n及び完全性保護の入力として用いられること，第２文において，ある所\n与のシーケンス番号が，（暗号化及び完全性保護に用いられる際に，）\nある所与のｅＮＢ鍵を基にして得られたＵＰ鍵（ＫｅＮＢ－ＵＰ－ｅｎｃ）及び\nＲＲＣ鍵（ＫｅＮＢ－ＲＲＣ－ｅｎｃ，ＫｅＮＢ－ＲＲＣ－ｉｎｔ）のために用いられるのは\n一度でなければならないこと，第３文において，所与のｅＮＢ鍵（正確\nには，その下位のＵＰ鍵及びＲＲＣ鍵）が暗号化及び完全性保護の手続\nに用いられることを述べたものといえる。\nｄ  以上によれば，引用刊行物１の「A given sequence number must on\nly be used once for a given eNB key」（第５原則第２文）との記載\nは，暗号化及び完全性保護の手続について述べたものであって，シーケ\nンス番号がｅＮＢ鍵の生成のために用いられることを述べたものではな\nいから，本件審決がした本件和訳は誤りである。\n(ウ)  以上のとおり，本件審決が引用刊行物１の「A given sequence numbe\nr must only be used once for a given eNB key」（第５原則第２文）\nとの記載について本件和訳をし，上記記載箇所から「“ｅＮＢ鍵を得る\nために，シーケンス番号が使用される”ことが読み取れる。」と認定し\nたのは誤りである。\n引用刊行物１には，他に「Ｋ＿ｅＮＢ」を導出する手法についての開\n示はないから，「Ｋ＿ｅＮＢを得るために，シーケンス番号が使用され」\nる構成についての開示はない。\nしたがって，本件審決が認定した引用発明のうち，「前記Ｋ＿ｅＮＢ\nを得るために，シーケンス番号が使用され」との部分は誤りである。\nイ  一致点の認定の誤り\n本件審決が，「シーケンス番号と，および前記ＵＥと共有される，記憶\nされたアクセスセキュリティ管理エンティティキーＫ＿ＡＳＭＥから，前\n記セキュリティキーＫ＿ｅＮＢを導出するステップ」を本願発明と引用発\n明の一致点と認定したのは誤りである。\n(ア)  前記ア(ウ)のとおり，引用刊行物１には，「Ｋ＿ｅＮＢを得るため\nに，シーケンス番号が使用され」る構成についての開示はないから，引\n用発明は，「シーケンス番号と，および前記ＵＥと共有される，記憶さ\nれたアクセスセキュリティ管理エンティティキーＫ＿ＡＳＭＥから，前\n記セキュリティキーＫ＿ｅＮＢを導出するステップ」の構成を有するも\nのとはいえない。\nしたがって，本件審決が上記構成を本願発明と引用発明の一致点と認\n定したのは誤りである。\n(イ)ａ  本願の優先権主張日時点における当業者の技術常識によれば，引\n用発明における「シーケンス番号」には，本願発明の「ＮＡＳ＿Ｕ＿\nＳＥＱ」は含まれない。\nすなわち，前記ア(イ)ｃのとおり，引用刊行物１記載の第５原則の\n第２文中の「A given sequence number」にいう「sequence number」\nとは，「ＣＯＵＮＴ」を意味するものであり，「ＣＯＵＮＴ」はＨＦＮ\n及びＰＤＣＰシーケンス番号から構成されるものであるから，「ＮＡＳ\n＿Ｕ＿ＳＥＱ」とは異なるシーケンス番号である。\nまた，第５原則は，「Ｅ－ＵＴＲＡＮ」すなわち「ＵＥ」と「ｅＮＢ」\n間のネットワークのセキュリティについて述べたものであるのに対し（\n引用刊行物１のFigure4）（別紙１参照），「ＮＡＳ」は，「ＵＥ」と\n「ＭＭＥ」との間のプロトコルであり（同Figure4.3.2）（別紙１参照），\n本願発明と引用発明とは，「シーケンス番号」が用いられるプロトコル\nが異なるから，「シーケンス番号」の意味が異なることは，当業者にと\nって自明である。\nしたがって，引用発明における「シーケンス番号」には，本願発明\nの「ＮＡＳ＿Ｕ＿ＳＥＱ」は含まれないから，本件審決が，「シーケ\nンス番号と，および前記ＵＥと共有される，記憶されたアクセスセキ\nュリティ管理エンティティキーＫ＿ＡＳＭＥから，前記セキュリティ\nキーＫ＿ｅＮＢを導出するステップ」を本願発明と引用発明の一致点\nと認定したのは誤りである。\nｂ  被告は，これに対し，引用発明における「シーケンス番号」に「ＮＡ\nＳ＿Ｕ＿ＳＥＱ」が含まれる旨主張する。\nしかしながら，「シーケンス番号」という用語は，様々な場面で用い\nられるものであり，単に「シーケンス番号」といっても，その意味は一\n義的ではなく，一般的にシーケンス番号と整理されるものが全て引用発\n明における「シーケンス番号」に含まれるなどと解することはできない。\n被告は，単に抽象論を述べるのみで，具体的な論証を一切行っていな\nいから，被告の上記主張は失当である。\n(2)  取消事由２（相違点の看過）\n本願発明は，「ＮＡＳサービス要求を前記ＵＥから受信するステップ（３\n２，５２）であって，前記要求が，ＮＡＳアップリンクシーケンス番号ＮＡ\nＳ＿Ｕ＿ＳＥＱを示すステップ」の構成を有するが，本件審決は，引用発明\nが上記構成を有することを認定していないから，上記構成を本願発明と引用\n発明の相違点として認定すべきであったのに，この相違点の認定を看過した\n誤りがある。\nそして，本件審決は，上記相違点の容易想到性について判断を示していな\nい。\n(3)  取消事由３（相違点の容易想到性の判断の誤り）\n本件審決は，本件審決が認定した相違点について，引用発明，国際公開第\n２００６／１１６６２０号（２００６年１１月２日公開。以下「引用刊行物\n２」という。甲２の１）に記載の発明及び周知技術も共に，無線通信におけ\nるパケット伝送のセキュリティに関するものであるから，「シーケンス番号」\nを「ＵＥ」側から「ＭＭＥ」に送信する必要がある場合に，「シーケンス番\n号」を「ＵＥ」から「ＭＭＥ」に送信するよう構成することは，当業者が適\n宜なし得る事項であり，本願発明と引用発明との相違点は格別のものではな\nい旨判断したが，以下に述べるとおり，本件審決の上記判断は誤りである。\nア(ア)  前記(1)ア(ウ)のとおり，引用刊行物１（甲１）には，「Ｋ＿ｅＮＢ\nを得るために，シーケンス番号が使用され」る構成についての開示はな\nい。同様に，引用刊行物２（甲２の１）及び本件審決が認定した周知技\n術（「「ＵＥ」から，「ＭＭＥ」に対して「ＲＲＣ／ＮＡＳ信号」を送\n信する点」）のいずれにも，「Ｋ＿ｅＮＢを得るために，シーケンス番\n号が使用され」る構成についての開示も示唆もない。\nまた，仮に引用刊行物１に「Ｋ＿ｅＮＢを得るために，シーケンス番\n号が使用され」る構成の開示があるとしても，引用刊行物１には，Ｋ＿\nｅＮＢを得るためにＮＡＳサービス要求で示される「ＮＡＳ＿Ｕ＿ＳＥ\nＱ」をシーケンス番号として用いることの開示はない。同様に，引用刊\n行物２及び本件審決が認定した周知技術のいずれにおいても，ＮＡＳサ\nービス要求で示される「ＮＡＳ＿Ｕ＿ＳＥＱ」をＫ＿ｅＮＢの生成のため\nに用いることについての開示や示唆はない。\nしたがって，引用発明に引用刊行物２記載の発明及び本件審決が認定し\nた構成を組み合わせても，当業者が相違点に係る本願発明の構成を容易に\n想到することができたものとはいえない。\n(イ)  被告は，これに対し，乙２，４ないし７の記載を根拠として挙げて，\nシーケンス番号を使用して鍵を生成することによって効率的に鍵を共有す\nることができることが，セキュリティの分野における技術常識であったこ\nと，ＵＥからのアップリンクにシーケンス番号が含まれていることは広く\n知られていることからすると，このようなアップリンクに含まれるシーケ\nンス番号のうち，具体的に何を使用するかは，結局のところ，使用できる\nものの中から適宜選択すべきことにすぎないとして，当業者が相違点に係\nる本願発明の構成を容易に想到することができた旨主張する。\nしかしながら，被告の上記主張は，引用刊行物１に全く記載のない事\n項について，乙２，４ないし７に記載されていることを理由に引用刊行\n物１に同じことが記載されている旨主張するに等しいものであり，また，\n公知の技術について，何らの論証もないまま殊更引用刊行物１に開示さ\nれた構成を上位概念化するものであって不当である。\nしたがって，被告の上記主張は理由がない。\nイ  本件審決は，本願発明と引用発明との相違点は格別のものではないと判\n断したが，その判断に際し，本願発明が引用発明と比べて顕著な効果を奏\nすることを考慮していないから，上記判断は誤りである。\nすなわち，前記ア(ア)のとおり，引用刊行物１には，Ｋ＿ｅＮＢを得るた\nめにＮＡＳサービス要求で示される「ＮＡＳ＿Ｕ＿ＳＥＱ」をシーケンス\n番号として用いることの開示はない。\nこれに対し，本願の願書に添付した明細書（以下，図面を含めて「本願\n明細書」という。甲４）には，「ＮＡＳ＿Ｄ＿ＳＥＱ」を用いる場合には，\n「ＮＡＳメッセージ」の損失に起因する「ＵＥにおける誤ったＮＡＳ＿Ｄ＿\nＳＥＱ」に基づく「Ｋ＿ｅＮＢ」生成が行われるおそれがあり（段落【００\n０７】），また，「別個のシーケンス番号」を用いる場合には，「再生攻撃\nを防ぐために，別個のシーケンス番号をＵＥおよびＭＭＥの両方において保\n持しなければならない」といった「特別な複雑さ」を要するが（段落【００\n０８】），本願発明は，「Ｋ＿ｅＮＢ」の生成に「ＮＡＳ＿Ｕ＿ＳＥＱ」を\n使用することにより，「ＭＭＥからＵＥへの明示的なダウンリンクＮＡＳサ\nービス受理メッセージまたはシーケンス番号が必要ではないこと，およびＮ\nＡＳセキュリティコンテキストの再生保護機能が，ＲＲＣおよびＵＰセキュ\nリティコンテキストにおいて再利用されること」（段落【００１１】）とい\nった顕著な効果を奏することが開示されている。\nしかるところ，本件審決は，本願発明の上記顕著な効果を考慮することな\nく，本願発明と引用発明との相違点は格別のものではないと判断したので\nあるから，本件審決の上記判断は誤りである。\nウ  以上によれば，本件審決における相違点の容易想到性の判断には誤りが\nある。\n(4)  まとめ\n以上によれば，本件審決には，引用発明及び一致点の認定の誤り，相違点\nの看過，相違点の容易想到性の判断の誤りがあり，その結果，本件審決は，\n本願発明は特許法２９条２項の規定により特許を受けることができないと誤\nった判断をしたものである。\nしたがって，本件審決は，違法であるから，取り消されるべきものである。\n２  被告の主張\n(1)  取消事由１（引用発明及び一致点の認定の誤り）に対し\nア  引用発明の認定について\n(ア)  引用刊行物１がＬＴＥに関する規格として発行された技術文書であ\nることに照らせば，本件審決が，第５原則の第１文と第３文については，\n逐語的な直訳を示す一方で，第２文については「ｅＮＢ鍵を得るために\n…が使用される」と訳し，逐語的な直訳を示さなかったことは不適切で\nあったものといえる。\nしかしながら，本件審決は，第５原則の第２文の「A given sequence\nnumber must only be used once for a given eNB key」の「for a giv\nen eNB key」との部分のみから「ｅＮＢ鍵を得るために」との訳を導い\nたわけではない。「use」の動詞は，「用いる」ないし「使用する」を意\n味するが，「use」の目的ないし態様は文脈によって異なる。第２文中の\n「be used…for a given eNB key」の「ｅＮＢ鍵のために使用される」\nとの記載が，引用刊行物１の「１４．１  概説及び原則」記載のｅＮＢ鍵\nの生成，共有，配送について主として述べている文脈中に存在しており，\n「ｅＮＢ鍵の生成のために」使用される趣旨を含むことから，このこと\nを踏まえて意訳し，文脈に即して「ｅＮＢ鍵を得るために…が使用され\nる」と訳したものであり，誤訳ではない。\nすなわち，引用刊行物１の「１４．１  概説及び原則」には，「Ｅ－Ｕ\nＴＲＡＮのセキュリティに適用される」べき６つの「原則」（第１原則\nないし第６原則）が記載されるとともに，ＡＫＡ（判決注:認証及び鍵共\n有のためのプロトコル）実行の結果としてＥＰＣとＵＥがＫ＿ＡＳＭＥ\nという名称の基本鍵を共有する旨，Ｋ＿ＡＳＭＥからＫ＿ｅＮＢが得ら\nれる旨，Ｋ＿ＡＳＭＥはＥＰＣから離れないのに対して，Ｋ＿ｅＮＢは，\n（ＵＥがＬＴＥ＿ＡＣＴＩＶＥに移行すると）ＥＰＣからｅＮＢに運ば\nれる旨等が「概説」されている。そして，第１原則ないし第３原則は，\n「概説」された内容をさらに抽象化したものであり，第１原則には，（\nＥ－ＵＴＲＡＮ（ＵＥ／ｅＮＢ）のセキュリティにおいて用いられる）\nｅＮＢ鍵は，ＮＡＳ保護のために用いられるＥＰＣ鍵から分離されるこ\nとが，第２原則には，これらの「鍵」が「ＥＰＣ／ＵＥ」において「鍵\n素材」から得られる（つまりＥＰＣだけでなくＵＥにおいても鍵生成が\n行われる）とともに，その「鍵素材」は，「ＮＡＳレベルＡＫＡ手続」\nによって生成される旨が，第３原則には，ＵＥがＬＴＥ＿ＡＣＴＩＶＥ\n状態に入るとｅＮＢ鍵がＥＰＣからｅＮＢに送られる旨がそれぞれ示さ\nれており，また，第５原則には，「シーケンス番号」を用いることを前\n提として，第１文では「暗号化，及び，完全性保護のための入力」とい\nう最も抽象的なレベルでの目的ないし態様が示され，第２文では「ある\nｅＮＢ鍵」につき「一度のみ」しか用いることができない旨及び第３文\nでは同じシーケンス番号を暗号化と完全性保護の両方に用いることがで\nきる旨が示されているから，引用刊行物１の「１４．１  概説及び原則」\nは，ｅＮＢ鍵の生成，共有，配送について主として述べたものといえる。\nまた，第５原則は，Ｋ＿ｅＮＢとその派生鍵（ｅＮＢ鍵）が，ＮＡＳ\n保護のために用いられるＥＰＣ鍵から分離され，ＮＡＳレベルで行われ\nる「認証及び鍵共有」のために用いられない旨を示した第１原則を受け\nて，Ｋ＿ｅＮＢが「認証及び鍵共有」の後の「暗号化」と「完全性保護」\nのために用いられる旨を述べたものである。要するに，第５原則は，第\n１原則の裏返しとして，Ｋ＿ｅＮＢが「認証及び鍵共有」のために用い\nられることはなく，「暗号化」と「完全性保護」のために用いられるこ\nとを示すとともに，そのようなＫ＿ｅＮＢに関して，「暗号化」と「完\n全性保護」のために入力される「シーケンス番号」を本来独立であるべ\nき複数の「鍵」間で共通に使用してはならないという原則（セキュリテ\nィの分野では当たり前のこと）を述べるとともに，「暗号化」のために\n用いた「シーケンス番号」を当該「暗号化」に用いた鍵と同じ鍵を用い\nてされる「完全性保護」においても用いることができることを述べたも\nのである。\nさらに，シーケンス番号を使用して鍵を生成することによって効率的\nに鍵を共有することができることは，本願の優先権主張日当時，セキュ\nリティの分野における技術常識であったものである。例えば，①乙４（\n国際公開２００７／０４６３７６号）の段落【００２７】，【００２９\n】及び【００４７】には，「所定の契機でカウントアップされる「鍵更\n新カウンタ値（Ｎｃ）」というシーケンス番号を使用して送信の際の暗\n号化のための暗号鍵Ｋｃと受信の際の復号のための復号鍵Ｋｃを生成し\nていること」が，②乙５（特表２００３－５２９２８８号公報）の段落\n【０００４】ないし【０００６】には，「暗号化送信に用いるキーを発\n生するにあたって，カウンタのカウント値Ｒというシーケンス番号を用\nいていること」が，③乙６（特開平１１－１０９８５４号公報）の段落\n【００６８】，【００７２】，【００７３】，【００７７】，【００８\n０】及び【００９５】には，「発呼側装置と被呼側装置との間の暗号通\n信に使用される通信用暗号鍵の生成に用いられる乱数に限らず「シーケ\nンス番号」を用いてもよいこと」が，④乙７（特表平４－５０５６９４\n号公報）の１１頁右上欄５行～１２行，１１頁左下欄２２行～１２頁左\n上欄１７行及び図４には，「暗号化のために用いられるキーストリーム\nを発生するためにカウント２１３，２１４というシーケンス番号を用い\nていること」が記載されている。これらの文献は，シーケンス番号を使\n用して鍵を生成することによって効率的に鍵を共有することができるこ\nとを示している。\n以上の引用刊行物１の記載及び技術常識を踏まえれば，当業者であれ\nば，第５原則第２文中の「be used…for a given eNB key」の「ｅＮＢ\n鍵のために使用される」との記載がｅＮＢ鍵の生成，共有，配送につい\nて主として述べている文脈中に存在しながら，「ｅＮＢ鍵の生成のため\nに」使用される趣旨を含んでいないと解釈することはできず，むしろ，\nその趣旨を含むものと解釈するものである。\nしたがって，本件審決がした本件和訳は，逐語的な直訳を示さなかっ\nた点では不適切であったものの，誤訳とはいえないから，本件和訳に基\nづいてした本件審決の引用発明の認定にも誤りはない。\n(イ)  原告は，これに対し，引用刊行物１の後のバージョンである甲８及\nび甲９の１を踏まえると，第５原則の第２文中の「A given sequence nu\nmber」にいう「sequence number」とは「ＣＯＵＮＴ」を意味し，第２文\nは，ある所与のシーケンス番号（「ＣＯＵＮＴ」）が，（暗号化及び完全\n性保護に用いられる際に，）ある所与のｅＮＢ鍵を基にして得られたＵＰ\n鍵（ＫｅＮＢ－ＵＰ－ｅｎｃ）及びＲＲＣ鍵（ＫｅＮＢ－ＲＲＣ－ｅｎｃ，ＫｅＮＢ－ＲＲＣ－ｉｎｔ）\nのために用いられるのは一度でなければならないことを述べたものであ\nり，本件和訳は誤訳である旨主張する。\nしかしながら，本願の優先権主張日前に発行された乙２（3GPP TS 33\n.102 version 7.1.0 Release 7）には，シーケンス番号には，部分的に\n時間を基にしたもの，時間を基にしていないもの，完全に時間を基にし\nたものが存在することが記載されており，上記記載によれば，「シーケ\nンス番号」という用語は，「シーケンス番号」としての属性を有するこ\nれらの様々なものを当該属性に即した上位概念として示す用語であるこ\nとを理解することができる。\nそうすると，「シーケンス番号」は，規格として定められた特定のパ\nラメータを指すことが明示されているのであればともかく，そうでない\n限りは，規格とされた文献あるいは規格とされていない文献における特\n定のパラメータを示すものということはできない。\n甲８及び甲９の１は，引用刊行物１の発行後にＬＴＥに関する規格と\nして発行された技術文書であるが，引用刊行物１には「sequence numbe\nr（シーケンス番号）」が「ＣＯＵＮＴ」である旨の記載はもちろん，「\nＣＯＵＮＴ」というパラメータの定義自体が存在しないから，引用刊行\n物１の発行時点では，「ＣＯＵＮＴ」というパラメータやこのようなパ\nラメータの利用方法が規格とされていなかったものといえるものであ\nり，引用刊行物１に接した当業者が「sequence number（シーケンス番号）」\nが「ＣＯＵＮＴ」を意味し，他のシーケンス番号ではあり得ないと考え\nることはない。また，仮に原告が主張するように発行時点より後に規格\nとされた技術文書の内容を取り込む解釈が許容されることになれば，甲\n８において「特定的でない参照」として参照されている乙３（3GPP TS\n33.401 version 8.3.1 Release 8）の図６．２－２（別紙２参照）には，\nＭＭＥにおいてＫＡＳＭＥからＫｅＮＢを生成するに当たって「ＮＡＳ  ＵＰ\nＬＩＮＫ  ＣＯＵＮＴ」という「シーケンス番号」を用いることが図示\nされているから，引用刊行物１にその旨が記載されていると認定するこ\nとすら可能であることになる。\nしたがって，原告の上記主張は，理由がない。\nイ  一致点の認定について\n(ア)  前記ア(ア)のとおり，引用刊行物１の記載からみて，第５原則の第\n２文がｅＮＢ鍵の生成，共有，配送について主として述べている文脈に\nおいて「A given sequence number…be used for a given eNB keys…」\n（シーケンス番号は…ｅＮＢ鍵のために使用される…）と記載している\nものであって，「ｅＮＢ鍵のために」使用される旨の記載がｅＮＢ鍵の\n生成，共有，配送について主として述べている文脈中に存在しながら「\nｅＮＢ鍵の生成のために」使用される趣旨を含んでいないと解釈するこ\nとはできない。本件審決は，このことを踏まえて，本件和訳をしたもの\nであり，本件和訳に誤りはなく，本件審決の引用発明の認定に誤りはな\nい。\nしたがって，本件審決が「シーケンス番号…から，前記セキュリティ\nキーＫ＿ｅＮＢを導出する」点を本願発明と引用発明の一致点と認定し\nたことに誤りはない。\n(イ)  原告は，これに対し，引用刊行物１記載の第５原則の第２文中の「A\ngiven sequence number」にいう「sequence number」とは，「ＣＯＵＮ\nＴ」を意味するものであり，「ＣＯＵＮＴ」はＨＦＮ及びＰＤＣＰシーケ\nンス番号から構成されるものであるから，「ＮＡＳ＿Ｕ＿ＳＥＱ」とは異\nなるシーケンス番号である，第５原則は，「Ｅ－ＵＴＲＡＮ」すなわち\n「ＵＥ」と「ｅＮＢ」間のネットワークのセキュリティについて述べたも\nのであるのに対し，「ＮＡＳ」は，「ＵＥ」と「ＭＭＥ」との間のプロト\nコルであり，本願発明と引用発明とは，「シーケンス番号」が用いられる\nプロトコルが異なるから，「シーケンス番号」の意味が異なることは，当\n業者にとって自明であるとして，引用発明における「シーケンス番号」に\nは，本願発明の「ＮＡＳ＿Ｕ＿ＳＥＱ」は含まれないから，本件審決の\n一致点の認定に誤りがある旨主張する。\nしかしながら，前記ア(イ)のとおり，引用刊行物１の「シーケンス番\n号」は，「シーケンス番号」としての属性を有する様々なものを当該属\n性に即した上位概念を示す用語であり，本願発明の「ＮＡＳ＿Ｕ＿ＳＥ\nＱ」が「シーケンス番号」としての属性を有する情報であれば，これが\n含まれないということはできない。本件審決は，相違点の判断において，\n「シーケンス番号」とその下位概念である「ＮＡＳ＿Ｕ＿ＳＥＱ」とが\n区別されることを前提として説示したが，この区別は，「ＮＡＳ＿Ｕ＿\nＳＥＱ」がその上位概念である「シーケンス番号」としての属性を有す\nることを前提としたものである。\nまた，前記ア(イ)のとおり，引用刊行物１の発行時点では，「ＣＯＵ\nＮＴ」というパラメータやこのようなパラメータの利用方法が規格とさ\nれていなかったから，引用刊行物１に接した当業者が「sequence numbe\nr（シーケンス番号）」が「ＣＯＵＮＴ」を意味し，他のシーケンス番号\nではあり得ないと考えることはない。\nさらに，本願発明の特許請求の範囲（請求項１）の「次世代パケット\nシステムＥＰＳのモビリティ管理エンティティ（１３）ＭＭＥにおいて，\nユーザ装置（１１）ＵＥと前記ＵＥにサービスするｅＮｏｄｅＢ（１２）\nとの間のＲＲＣ／ＵＰトラフィックを保護するためにセキュリティキー\nＫ＿ｅＮＢを確立する方法」との記載によれば，本願発明は「ＵＥ」と\n「ｅＮＢ」間のセキュリティに係るものであるから，引用刊行物１が「\nＵＥ」と「ｅＮＢ」間のセキュリティについて述べたものであることは，\n本願発明と引用発明とが異なるプロトコルについて述べたものであるこ\nとの根拠にならない。\nしたがって，原告の上記主張は理由がない。\nウ  小括\n以上によれば，原告主張の取消事由１は理由がない。\n(2)  取消事由２（相違点の看過）に対し\nア  本件審決は，引用刊行物１の摘記箇所において，本願発明の「ＮＡＳサ\nービス要求を前記ＵＥから受信するステップ」に対応する構成が明記され\nていないことを踏まえて，これを一致点と認定せずに，相違点と認定した\n上で，相違点の判断を示している。\n本件審決は，相違点の判断において，「ＵＥ」からのアップリンクに「\nシーケンス番号」を含ませることも，当業者には知られた技術であると判\n断している。「ＵＥ」からのアップリンクに「シーケンス番号」を含ませ\nることは，「ＵＥ」から上位局（ＵＥより「網側」の局）が受信するアッ\nプリンクに「シーケンス番号」を含ませることを意味するものであり，「\nＵＥ」から様々な「アップリンク」が上位局に送信され，これを上位局が\n受信することを前提とするものである。\nしたがって，「ＵＥ」からのアップリンクに「シーケンス番号」を含ま\nせることも，当業者には知られた技術であるとの本件審決の上記判断には，\n「ＵＥ」からの「アップリンク」を上位局が受信する技術が当業者に知ら\nれた技術であるとの判断が前提に含まれている。\nイ  また，引用刊行物１（甲１，乙１）には，「ＮＡＳダイレクト・メッセ\nージ」が「ＵＥ」から「（ＭＭＥ中の）ＮＡＳ」へ転送する(transfer)こ\nと（７．１），「初期直接転送(Initial Direct Transfer)」という「ＮＡ\nＳメッセージ（NAS message）」が「ＲＲＣ接続要求（RRC connection re\nquest)に結びつけられる (concatenated)こと（７．３）が記載され，さら\nに，ＲＲＣコネクション要求とＮＡＳサービス要求とがＵＥからｅＮＢに\n送られ，その後にｅＮＢからＭＭＥへ送られた後にＳ１インターフェース\n（ｅＮＢとＭＭＥとの間の通信）におけるコンテキストセットアップ手順\nが始まる様子（図１９．２．２．３）（別紙１参照）が図示されている。\nこれらによれば，「ＵＥ」から「ＲＲＣコネクション要求」とともに「\nｅＮＢ」を経由して送られる「初期直接転送」という「ＮＡＳメッセージ」\nないし「ＮＡＳサービス要求」を，ＭＭＥが受信するものと理解すること\nができる。\nそうすると，引用刊行物１の上記記載内容に照らせば，「ＮＡＳサービ\nス要求をＵＥから受信するステップ」は，本願発明と引用発明との一致点\nであると整理することもできる。\nウ  以上によれば，本件審決の相違点の認定に誤りはなく，また，事実上，\n「ＮＡＳサービス要求を前記ＵＥから受信するステップ」に対応する構成\nを一致点と整理しても，本件審決の論旨の大枠が崩れることはなく，本件\n審決の結論にも影響しない。\nしたがって，原告主張の取消事由２は理由がない。\n(3)  取消事由３（相違点の容易想到性の判断の誤り）に対し\nア  前記(1)ア(ア)のとおり，引用刊行物１には，第５原則第２文において，\n「ｅＮＢ鍵を得るためにシーケンス番号が使用される」構成が開示されて\nいる。\nそして，前記(1)ア(ア)のとおり，シーケンス番号を使用して鍵を生成す\nることによって効率的に鍵を共有することができることは，セキュリティ\nの分野における技術常識であり，また，引用刊行物２（甲２の１）に示さ\nれているように，ＵＥからのアップリンクにシーケンス番号が含まれてい\nることは広く知られている。\nそうすると，このようなアップリンクに含まれるシーケンス番号のうち，\n具体的に何を使用するかは，結局のところ，使用できるものの中から適宜\n選択すべきことにすぎない。\nしかるところ，前記(2)のとおり，引用刊行物１には「ＮＡＳサービス要\n求をＵＥから受信するステップ」が事実上記載されているということがで\nきるところ，このＵＥからの「ＮＡＳサービス要求」は，ＵＥとｅＮＢと\nの暗号化等を用いた通信の前提となるＲＲＣコンテキストがセットアップ\nされる前にＲＲＣコネクションリクエストとともに行われるから，ＮＡＳ\nサービス要求に含まれるシーケンス番号は，暗号化等を用いた通信を開始\nすることが可能となる前の段階で追加のコストを要せず必然的にＵＥとＭ\nＭＥとの双方で利用可能となる。暗号化等に用いる鍵を生成するための情\n報は，暗号化等を用いた通信を開始する前の段階でＵＥとＭＭＥの双方に\nおいてが利用可能である必要があるが，「ＮＡＳサービス要求」に含まれ\nるシーケンス番号は，追加のコストを要せずこの要件を満たすものなので\nあって，その意味では，これを利用することが望ましいものといえる。\n以上によれば，相違点は格別のものではなく，相違点に係る本願発明の\n構成は容易想到であるとした本件審決の判断に誤りはない。\nイ  原告は，これに対し，本願明細書には，本願発明は，「Ｋ＿ｅＮＢ」の生\n成に「ＮＡＳ＿Ｕ＿ＳＥＱ」を使用することにより，「ＭＭＥからＵＥへの\n明示的なダウンリンクＮＡＳサービス受理メッセージまたはシーケンス番号\nが必要ではないこと，およびＮＡＳセキュリティコンテキストの再生保護機\n能が，ＲＲＣおよびＵＰセキュリティコンテキストにおいて再利用されるこ\nと」（段落【００１１】）といった顕著な効果を奏することが開示されてい\nるが，本件審決が本願発明と引用発明との相違点は格別のものではないと\n判断するに際し，本願発明が引用発明と比べて顕著な効果を奏することを\n考慮していないから，上記判断は誤りである旨主張する。\nしかしながら，ＭＭＥからＵＥへの明示的なダウンリンクＮＡＳサービ\nス受理メッセージが必要でないことは，本願明細書記載の従来技術及び引\n用刊行物１に記載された技術において既に達成されていた効果であって（\n本願明細書の段落【００２６】ないし【００２８】，図１，引用刊行物１\nの「１９．２．２．３」参照。），本願発明に特有のものではない。\nまた，「ユーザ装置（１１）ＵＥと前記ＵＥにサービスするｅＮｏｄｅ\nＢ（１２）との間のＲＲＣ／ＵＰトラフィックを保護するため」の「セキ\nュリティキーＫ＿ｅＮＢ」の「確立」のための「別個のシーケンス番号」\nの必要がなくなることは，シーケンス番号としてＮＡＳメッセージに含ま\nれるシーケンス番号（ＮＡＳセキュリティコンテキストの再生保護機能）\nを用いたことによる予想どおりの効果にすぎず，格別なものでない。\nしたがって，原告の上記主張は，その前提を欠くものであり，理由がな\nい。\n(4)  まとめ\n以上のとおり，原告主張の取消事由はいずれも理由がないから，本願発明\nは特許法２９条２項の規定により特許を受けることができないとした本件審\n決の判断に誤りはない。\n第４  当裁判所の判断\n１  取消事由１（引用発明及び一致点の認定の誤り）について\n(1)  本願明細書の記載事項について\nア  本願発明の特許請求の範囲（請求項１）の記載は，前記第２の２のとお\nりである。\nイ  本願明細書（甲４）の「発明の詳細な説明」には，次のような記載があ\nる（下記記載中に引用する図面について別紙本願明細書図面を参照）。\n(ア)  「【技術分野】\n技術分野\n本発明は，電気通信システムにおける方法および構成に関し，特に，\nＵＥによってトリガされたサービス要求のための，ＥＰＳ（次世代パケ\nットシステム），すなわちＥ－ＵＴＲＡＮ（次世代ＵＭＴＳ地上無線ア\nクセスネットワーク）およびＥＰＣ（次世代パケットコアネットワーク）\nにおけるセキュリティソリューションに関する。より具体的には，本発\n明は，ＥＰＳ（次世代パケットシステム）用のＭＭＥ（モビリティ管理\nエンティティ）およびＵＥ（ユーザ装置）において，ＲＲＣ／ＵＰトラ\nフィックを保護するためにセキュリティキーを確立する方法および構成\nに関する。」（段落【０００１】）\n(イ)  「【背景技術】\n背景\nＥＰＳアーキテクチャでは，加入者認証は，ＵＥとＭＭＥ（モビリテ\nィ管理エンティティ）との間で実行され，かつＭＭＥは，例えば，モビ\nリティ，ＵＥ識別情報，およびセキュリティパラメータを管理する。Ｅ\nＰＳにおけるセキュリティ手順を定義するための基礎は，セキュリティ\nキーＫ＿ＡＳＭＥであり，このキーは，ＭＭＥとＵＥとの間で共有され，\nかつＵＥの認証において確立される。ＡＳＭＥ（アクセスセキュリティ\n管理エンティティ）と呼ばれる，ＥＰＳアーキテクチャの機能エンティ\nティは，例えばＭＭＥと同じ場所に配置してもよく，ＡＳＭＥは，ホー\nムネットワークに制限されたＣＫ／ＩＫキーから導出されたセキュリテ\nィキーＫ＿ＡＳＭＥを受信および記憶する。ＡＳＭＥは，セキュリティ\nキーＫ＿ＡＳＭＥから，ＮＡＳシグナリング，すなわち次世代パケット\nコア（ＥＰＣ）ネットワークのＭＭＥとＵＥとの間の非アクセス層シグ\nナリングを保護するために用いられるＮＡＳセキュリティコンテキスト\nを導出する。ＮＡＳセキュリティコンテキストには，Ｋ＿ＮＡＳ＿ｅｎ\nｃ，Ｋ＿ＮＡＳ＿ｉｎｔなど，ＮＡＳシグナリングの暗号化および完全\n性保護用のパラメータ，ならびにＮＡＳ＿Ｕ＿ＳＥＱおよびＮＡＳ＿Ｄ\n＿ＳＥＱなど，アップリンクおよびダウンリンクシーケンス番号が含ま\nれ，シーケンス番号は，暗号化および完全性保護手順への入力だけでな\nく，古いメッセージの再生を防ぐために用いられる。ＡＳＭＥは，ＭＭ\nＥにＮＡＳセキュリティコンテキストを提供し，１つのＮＡＳセキュリ\nティコンテキストが，ＭＭＥに保持され，対応するＮＡＳセキュリティ\nコンテキストが，ＵＥに保持され，再生保護，完全性保護および暗号化\nは，ＭＭＥおよびＵＥのＮＡＳセキュリティコンテキストのシーケンス\n番号が，再使用されないことに基づいている。」（段落【０００２】）\n「ＵＥとサービスｅＮｏｄｅＢ（すなわち，ＥＰＳアーキテクチャに\nおける無線基地局）との間のＵＰ／ＲＲＣトラフィックを保護するため\nのセキュリティコンテキストもまた，前記セキュリティキーＫ＿ＡＳＭ\nＥに基づくのが好ましい。ＵＰ／ＲＲＣセキュリティコンテキストを確\n立する手順には，Ｋ＿ｅＮＢと呼ばれるキーであって，これから，暗号\n化キーＫ＿ｅＮＢ＿ＵＰ＿ｅｎｃが，ＵＰ（ユーザ平面）すなわちＥＰ\nＣおよびＥ－ＵＴＲＡＮ上で転送されるエンドユーザデータを保護する\nために導出されるキー，ならびにＲＲＣ（無線資源制御）を保護するた\nめの暗号化キーＫ＿ｅＮＢ＿ＲＲＣ＿ｅｎｃおよび完全性保護キーＫ＿\nｅＮＢ＿ＲＲＣ＿ｉｎｔを導出することが含まれる。」（段落【０００\n３】）\n「図１は，ＥＰＳアーキテクチャにおける，ＵＥが開始したアイドル\nからアクティブへの状態遷移のための従来の例示的なシグナリングフロ\nーを示す。アイドルＵＥは，ＥＰＳのＥＰＣ（次世代パケットコア）だ\nけに認識されており，ＵＰ／ＲＲＣセキュリティコンテキストは，ｅＮ\nｏｄｅＢとＵＥとの間には存在しない。アクティブ状態におけるＵＥは，\nＥＰＣおよびＥＵＴＲＡＮの両方において認識されており，ＵＰ／ＲＲ\nＣセキュリティコンテキストが，ＵＥとそのサービスｅＮｏｂｅＢとの\n間でＵＰ／ＲＲＣトラフィックを保護するために確立された。」（段落\n【０００４】）\n「図１は，ＵＥ１１，ｅＮｏｄｅＢ１２，ＭＭＥ１３，サービスＧＷ\n（ゲートウェイ）１４，ＰＤＮゲートウェイ１５，およびＨＳＳ（ホー\nム加入者サーバ）１６を示す。サービスゲートウェイ１４は，ＥＵＴＲ\nＡＮに向かってインタフェースを終端するＥＰＣのノードであり，ＰＤ\nＮゲートウェイは，ＰＤＮ（パケットデータネットワーク）に向かって\nインタフェースを終端するＥＰＣのノードである。ＵＥが複数のＰＤＮ\nにアクセスする場合には，そのＵＥのために複数のＰＤＮゲートウェイ\nがあってもよい。信号Ｓ１および信号Ｓ２では，ＮＡＳサービス要求は，\nＵＥからＭＭＥへ透過的に転送され，かつＮＡＳサービス要求は，ＮＡ\nＳ＿Ｕ＿ＳＥＱに基づいて，完全性が保護される。オプションの信号Ｓ\n３では，ＵＥは，ＭＭＥによって認証され，Ｋ＿ＡＳＭＥは，ＨＳＳ（\nホーム加入者サーバ）に記憶された加入者データを用いて確立され，Ｍ\nＭＥは，Ｓ４で，初期コンテキストセットアップ要求をｅＮｏｄｅＢに\n送信する。信号Ｓ５およびＳ６では，ｅＮｏｄｅＢは，ＵＥとの無線ベ\nアラを確立してアップリンクデータを転送し，信号Ｓ７で，初期コンテ\nキストセットアップ完了メッセージをＭＭＥへ返す。信号Ｓ８では，Ｍ\nＭＥは，更新ベアラ要求をサービスＧＷに送信し，サービスＧＷは，信\n号Ｓ９で応答する。」（段落【０００５】）\n「従来のソリューションでは，ＲＲＣ／ＵＰセキュリティコンテキス\nト用の，ＵＥおよびＭＭＥによるＫ＿ｅＮＢの導出は，例えば，ＭＭＥ\nからＵＥに送信されたＮＡＳサービス受理メッセージまたは他の明示的\nな情報に基づいている。しかしながら，図１における例示的な従来のＥ\nＰＳシグナリングフローに示されているように，ＭＭＥは，通常，ＥＰ\nＳにおいて，ＵＥからＮＡＳサービス要求を受信しても，いかなるＮＡ\nＳサービス受理も送信しない。したがって，ＮＡＳサービス受理メッセ\nージにおける情報からＫ＿ｅＮＢを導出することは不可能である。」（\n段落【０００６】）\n「例示的な公知のソリューションによれば，Ｋ＿ｅＮＢは，ＮＡＳサ\nービス受理メッセージにおいてＭＭＥによって用いられるＫ＿ＡＳＭＥ\nおよびＮＡＳ＿Ｄ＿ＳＥＱからＭＭＥによって導出され，ＵＥは，ＮＡ\nＳサービス受理メッセージからシーケンス番号ＮＡＳ＿Ｄ＿ＳＥＱを検\n索し，かつＭＭＥと同じＫ＿ｅＮＢ導出を実行することによって，同じ\nＫ＿ｅＮＢを導出する。ＭＭＥは，それがｅＮｏｄｅＢへのＳ１接続を\n設定する場合に，Ｋ＿ｅＮＢをｅＮｏｄｅＢに転送する。しかしながら，\nこの公知のソリューションの欠点は，明示的なＮＡＳサービス受理メッ\nセージがＭＭＥからＵＥに対して定義されない場合には，図１における\n例示的な従来のＥＰＳシグナリングフローにおけるように，ＵＥが，Ｍ\nＭＥと同じＫ＿ｅＮＢを導出することは不可能であることである。たと\nえＵＥが，現在のＮＡＳダウンリンクシーケンス番号ＮＡＳ＿Ｄ＿ＳＥ\nＱを推定することが技術的に可能であっても，この推定は誤っている可\n能性がある。なぜなら，ＭＭＥは，損失してＵＥによって決して受信さ\nれなかったＮＡＳメッセージを送信したかもしれないからである。かか\nる場合には，ＭＭＥは，そのＮＡＳ＿Ｄ＿ＳＥＱを更新し，ＵＥが，こ\nの更新に気づくこともなく，ＵＥにおける誤ったＮＡＳ＿Ｄ＿ＳＥＱに\nつながることになろう。」（段落【０００７】）\n「別の例示的な公知のソリューションによれば，Ｋ＿ｅＮＢの導出は，\n特にＫ＿ｅＮＢの導出のために保持される別個のシーケンス番号に基づ\nき，このシーケンス番号は，ＵＥがそれをＭＭＥに送信するかまたはＭ\nＭＥがそれをＵＥに送信することによって，ＮＡＳサービス要求手順の\n間に明示的に同期される。しかしながら，このソリューションの欠点は，\n別個のシーケンス番号の特別な複雑さである。なぜなら，再生攻撃を防\nぐために，別個のシーケンス番号をＵＥおよびＭＭＥの両方において保\n持しなければならないからである。」（段落【０００８】）\n(ウ)  「【発明が解決しようとする課題】\n概要\n本発明の目的は，上記で概説した課題に取り組むことであり，この目\n的および他の目的は，独立請求項による方法および構成ならびに従属請\n求項による実施形態によって達成される。」（段落【０００９】）\n(エ)  「【課題を解決するための手段】\n本発明の基本的な考えは，Ｋ＿ｅＮＢが，Ｋ＿ＡＳＭＥから，および\nＵＥからＭＭＥへのＮＡＳサービス要求メッセージのＮＡＳ＿Ｕ＿ＳＥ\nＱから導出され，それによって，ｅＮｏｄｅＢにおけるＵＰ／ＲＲＣセ\nキュリティコンテキストの確立をトリガするということである。」（段\n落【００１０】）\n「ＭＭＥからＵＥへの明示的なダウンリンクＮＡＳサービス受理メッ\nセージまたはシーケンス番号が必要ではないこと，およびＮＡＳセキュ\nリティコンテキストの再生保護機能が，ＲＲＣおよびＵＰセキュリティ\nコンテキストにおいて再利用されることが，本発明の利点である。」（\n段落【００１１】）\n「一態様によれば，本発明は，次世代パケットシステムＥＰＳのモビ\nリティ管理エンティティＭＭＥにおいて，ユーザ装置ＵＥとＵＥにサー\nビスするｅＮｏｄｅＢとの間のＲＲＣ／ＵＰトラフィックを保護するた\nめにセキュリティキーＫ＿ｅＮＢを確立する方法を提供する。この方法\nには，ＵＥからＮＡＳサービス要求を受信するステップであって，この\n要求が，ＮＡＳアップリンクシーケンス番号ＮＡＳ＿Ｕ＿ＳＥＱを示す\nステップと，少なくとも前記受信されたＮＡＳ＿Ｕ＿ＳＥＱから，およ\nび前記ＵＥと共有される，記憶されたアクセスセキュリティ管理エンテ\nィティキーＫ＿ＡＳＭＥからセキュリティキーＫ＿ｅＮＢを導出するス\nテップと，前記導出されたＫ＿ｅＮＢを，前記ＵＥにサービスするｅＮ\nｏｄｅＢに転送するステップと，が含まれる。」（段落【００１２】）\n「第２の態様によれば，本発明は，次世代パケットシステムＥＰＳ用\nのモビリティ管理エンティティＭＭＥを提供する。ＭＭＥは，ＵＥとＵ\nＥにサービスするｅＮｏｄｅＢとの間のＲＲＣ／ＵＰトラフィックを保\n護するために，セキュリティキーＫ＿ｅＮＢを確立するように構成され\nる。ＭＭＥには，ＵＥからＮＡＳサービス要求を受信するための手段で\nあって，この要求が，ＮＡＳアップリンクシーケンス番号ＮＡＳ＿Ｕ＿\nＳＥＱを示す手段と，少なくとも前記受信されたＮＡＳ＿Ｕ＿ＳＥＱか\nら，および前記ＵＥと共有される，記憶されたアクセスセキュリティ管\n理エンティティキーＫ＿ＡＳＭＥからＫ＿ｅＮＢを導出するための手段\nと，ならびに，前記導出されたＫ＿ｅＮＢを，前記ＵＥにサービスする\nｅＮｏｄｅＢに送信するための手段と，が含まれる。」（段落【００１\n３】）\n「第１および第２の態様は，さらに，方法および対応する手段を提供\nし，これらに従って，ＭＭＥが，擬似乱数関数ＰＲＦを用いてＮＡＳ＿\nＵ＿ＳＥＱおよびＫ＿ＡＳＭＥからＫ＿ｅＮＢを導出可能になる。ＭＭ\nＥは，さらに，受信された下位ビットから完全なＮＡＳアップリンクシ\nーケンス番号ＮＡＳ＿Ｕ＿ＳＥＱを再構成し，ＵＥから受信されたＮＡ\nＳサービス要求の完全性を検査してもよい。さらに，ＭＭＥは，受信さ\nれたＮＡＳ＿Ｕ＿ＳＥＱの通知をＵＥに返してもよく，ＮＡＳ＿Ｕ＿Ｓ\nＥＱは，Ｋ＿ｅＮＢをｅＮｏｄｅＢに転送するセットアップメッセージ\nに含まれていてもよい。それによって，ＵＥは，ＭＭＥに送信されるＮ\nＡＳ＿Ｕ＿ＳＥＱを覚えている必要がない。」（段落【００１４】）\n(オ)  「【発明を実施するための形態】\n詳細な説明\n以下の説明では，本発明の完全な理解を提供するために，特定のアー\nキテクチャおよびステップシーケンスなどの特定の詳細が記載される。\nしかしながら，本発明が，これらの特定の詳細から逸脱する可能性があ\nる他の実施形態において実行し得ることは，当業者には明らかである。」\n（段落【００２０】）\n「本発明の概念は，セキュリティキーＫ＿ｅＮＢが，アクセスセキュ\nリティ管理エンティティキーＫ＿ＡＳＭＥから，およびＵＥからＭＭＥ\nに送信されるＮＡＳサービス要求メッセージのアップリンクシーケンス\nカウンタＮＡＳ＿Ｕ＿ＳＥＱから導出され，それによって，ｅＮｏｄｅ\nＢにおいてＵＰ／ＲＲＣセキュリティコンテキストの確立をトリガする\nということである。」（段落【００２２】）\n「ＵＥがアイドルモードにある場合には，ＮＡＳセキュリティコンテ\nキストが，存在しかつ例えば，上記のＫ＿ＮＡＳ＿ｅｎｃ，Ｋ＿ＮＡＳ\n＿ｉｎｔ，ＮＡＳ＿Ｕ＿ＳＥＱ，およびＮＡＳ＿Ｄ＿ＳＥＱを含み，Ｎ\nＡＳメッセージは，完全性および場合により機密性を保護される。した\nがって，ＮＡＳセキュリティコンテキストにはまた，ＵＥのセキュリテ\nィ能力，特に暗号化および完全性アルゴリズムが含まれる。」（段落【\n００２３】）\n「ＮＡＳメッセージの保護は，ＮＡＳセキュリティキーＫ＿ＮＡＳ＿\nｅｎｃ，Ｋ＿ＮＡＳ＿ｉｎｔ，ならびにメッセージの方向についてアッ\nプリンクおよびダウンリンクシーケンスカウンタＮＡＳ＿Ｕ＿ＳＥＱま\nたはＮＡＳ＿Ｄ＿ＳＥＱに基づいている。完全なシーケンスカウンタは，\n通常，ＮＡＳメッセージと共に送信されず，下位ビットいくつかだけで\nあり，完全なシーケンス番号は，上位ビットの局所推定および受信され\nた下位ビットから，受信端で再構成される。」（段落【００２４】）\n「図１における従来のシグナリング図のＳ１およびＳ２では，ＮＡＳ\nサービス要求は，アップリンクシーケンスカウンタＮＡＳ＿Ｕ＿ＳＥＱ\nを含むが，ＵＥからＭＭＥに転送され，ＮＡＳサービス要求メッセージ\nは，前記ＮＡＳ＿Ｕ＿ＳＥＱに基づいて完全性が保護される。ＭＭＥは，\nメッセージの完全性を検査し，それが再生でない場合には，それを受理\nし，これによって，ＮＡＳ＿Ｕ＿ＳＥＱが，新しく以前に用いられなか\nったことが保証される。」（段落【００２６】）\n「その後，本発明によれば，ＭＭＥは，少なくとも，受信されたアッ\nプリンクシーケンスカウンタＮＡＳ＿Ｕ＿ＳＥＱおよびＫ＿ＡＳＭＥに\n基づき，従来のキー導出関数を用いて，Ｋ＿ｅＮＢを導出するが，これ\nは，図１に示す従来のシグナリング図には含まれない。したがって，シ\nーケンスカウンタは，認証においてのみリセットしてもよい。ＭＭＥは，\n信号Ｓ４のメッセージ，初期コンテキストセットアップ要求（Ｓ１－Ａ\nＰ）で，またはそこに相乗りして，導出されたＫ＿ｅＮＢをｅＮｏｄｅ\nＢに送信する。」（段落【００２７】）\n「信号Ｓ５では，ｅＮｏｄｅＢは，無線ベアラ確立およびセキュリテ\nィ構成メッセージ（セキュリティモードコマンド）をＵＥに送信する。\n図１におけるように，これらのメッセージは，２つの別個のメッセージ\nとして，または１つのメッセージに組み合わせて送信してもよく，ＵＥ\nによるこれらのメッセージの受信は，暗黙のうちに，信号Ｓ１における\nＵＥのＮＡＳサービス要求の確認になる。セキュリティモードコマンド\nは，例えば，保護がいつ開始すべきかおよびどのアルゴリズムを用いる\nべきかを決定する。」（段落【００２８】）\n「本発明によれば，ＵＥは，信号Ｓ５でメッセージを受信すると，以\n前に実行されていない場合には，少なくともＮＡＳ＿Ｕ＿ＳＥＱおよび\nＫ＿ＡＳＭＥに基づき，従来のキー導出関数を用いて，Ｋ＿ｅＮＢを導\n出する。その後，ｅＮｏｄｅＢおよびＵＥは，ＵＰ／ＲＲＣセキュリテ\nィコンテキストを確立するが，これは，図１における従来のシグナリン\nグ図には示されていない。」（段落【００２９】）\n(カ)  「図２は，本発明の第１の実施形態を示すが，この場合には，ＵＥ\nは，信号Ｓ２４におけるＫ＿ｅＮＢの導出のために，信号Ｓ２１におけ\nる初期ＮＡＳサービス要求メッセージのＮＡＳ＿Ｕ＿ＳＥＱを保持す\nる。ＭＭＥは，信号Ｓ２１でＵＥからＮＡＳ＿Ｕ＿ＳＥＱを受信するか，\nまたはＮＡＳ＿Ｕ＿ＳＥＱを示す下位ビットだけを受信し，ＮＡＳ＿Ｕ\n＿ＳＥＱおよびＫ＿ＡＳＭＥに基づいてＳ２２においてＫ＿ｅＮＢを導\n出する。ＭＭＥは，導出されたＫ＿ｅＮＢを信号Ｓ２３でｅＮｏｄｅＢ\nに転送する。」（段落【００３２】）\n「その後，図２には示していないが，ｅＮｏｄｅＢおよびＵＥは，Ｋ\n＿ｅＮＢを用いてＵＰ／ＲＲＣセキュリティコンテキストを確立する\nが，ＵＰ／ＲＲＣセキュリティコンテキストには，ＵＰトラフィックを\n保護するための暗号化キーＫ＿ｅＮＢ＿ＵＰ＿ｅｎｃ，ならびにＲＲＣ\nトラフィックの保護のための暗号化キーおよび完全性保護キー，Ｋ＿ｅ\nＮＢ＿ＲＲＣ＿ｅｎｃおよびＫ＿ｅＮＢ＿ＲＲＣ＿ｉｎｔがそれぞれ含\nまれ，それによって，信号Ｓ２５において安全なＵＰ／ＲＲＣトラフィ\nックを可能にする。」（段落【００３３】）\n「Ｋ＿ｅＮＢの導出は，従来のキー導出関数によって，例えば擬似乱\n数関数Ｋ＿ｅＮＢ＝ＰＲＦ（Ｋ＿ＡＳＭＥ，ＮＡＳ＿Ｕ＿ＳＥＱ，．．．）\nによって，実行される。」（段落【００３４】）\n(キ)  「図３は，本発明による方法を示す流れ図であり，ステップ３１に\nおいて，ＵＥ１１は，初期ＮＡＳサービス要求メッセージをＭＭＥ１３\nに送信するが，このメッセージは，通常，カウンタの下位ビットだけを\n送信することによって，ＮＡＳアップリンクシーケンスカウンタＮＡＳ\n＿Ｕ＿ＳＥＱを示す。ステップ３２において，ＭＭＥは，ＵＥからＮＡ\nＳサービス要求メッセージを受信し，ＮＡＳ＿Ｕ＿ＳＥＱを取得し，受\n信された下位ビットから完全なシーケンスを再構成する。ステップ３３\nにおいて，ＭＭＥは，適切なキー導出関数，例えば擬似乱数関数を用い\nて，少なくとも受信したＮＡＳ＿Ｕ＿ＳＥＱ，およびＡＳＭＥ（アクセ\nスセキュリティモビリティエンティティ）からのＫ＿ＡＳＭＥから，セ\nキュリティキーＫ＿ｅＮＢを導出する。」（段落【００３６】）\n「その後，ＭＭＥは，ステップ３４において，ＵＥと共有される完全\nなＵＰ／ＲＲＣセキュリティコンテキストを確立するためにｅＮｏｄｅ\nＢによって用いられるように，導出されたＫ＿ｅＮＢをｅＮｏｄｅＢ１\n２に転送する。ステップ３５において，前記ＵＥは，少なくとも記憶さ\nれたＫ＿ＡＳＭＥから，およびステップ３１においてＵＥからＭＭＥに\n送信された初期ＮＡＳサービス要求メッセージのＮＡＳ＿Ｕ＿ＳＥＱか\nら，同じＫ＿ｅＮＢを導出し，導出されたＫ＿ｅＮＢからＵＰ／ＲＲＣ\nセキュリティコンテキストを確立する。」（段落【００３７】）\n「本発明の第１の実施形態では，ＵＥは，初期ＮＡＳサービス要求メ\nッセージでＭＭＥに送信されたＮＡＳ＿Ｕ＿ＳＥＱを記憶し，記憶され\nたシーケンス番号を用いてＫ＿ｅＮＢを導出する。」（段落【００３８\n】）\n(ク)  「図６ａは，本発明に従って，ＥＰＳ用のＭＭＥ１３（モビリティ\n管理エンティティ）を示すが，このＭＭＥ１３は，ＵＥとサービスｅＮ\nｏｄｅＢとの間のＵＰ／ＲＲＣトラフィックを保護するためのセキュリ\nティコンテキスト用のセキュリティキーＫ＿ｅＮＢを確立するようにさ\nらに構成される。ＭＭＥには，図示していないが，ＥＰＳにおけるノー\nドと，例えばＳ１－ＭＭＥインタフェースを介してｅＮｏｄｅＢｓと通\n信するための従来の通信手段が設けられる。さらに，図１のＭＭＥでは，\nＡＳＭＥ（アクセスセキュリティ管理エンティティ）６１が，破線によ\nって示されている。なぜなら，ＥＰＳのこの機能エンティティは，ＭＭ\nＥと同じ場所に配置してもよいからである。」（段落【００４３】）\n「セキュリティキーＫ＿ｅＮＢを確立するための，図６ａに示すＭＭ\nＥ１３の手段には，（ＵＥのサービスｅＮｏｄｅＢを介した）ＵＥから\nのＮＡＳ＿Ｕ＿ＳＥＱを含むＮＡＳサービス要求メッセージを受信する\nために受信手段６２と，従来のキー導出関数を用い，少なくとも受信さ\nれたＮＡＳ＿Ｕ＿ＳＥＱおよび記憶されたＫ＿ＡＳＭＥに基づいて，セ\nキュリティキーＫ＿ｅＮＢを導出するためのキー導出手段６３と，導出\nされたＫ＿ｅＮＢを，ＵＥにサービスするｅＮｏｄｅＢに送信するため\nの送信手段６４と，が含まれる。」（段落【００４４】）\n「図６ｂは，本発明によるＵＥ１１（ユーザエンティティ）を示すが，\nＵＥは，ＥＰＳ用に構成され，さらに，ＵＥのサービスｅＮｏｄｅＢと\n交換されるＵＰ／ＲＲＣトラフィックを保護するためのセキュリティコ\nンテキスト用のセキュリティキーＫ＿ｅＮＢを確立するように構成され\nる。ＵＥには，そのサービスｅＮｏｄｅＢへのＬＴＥ－Ｕｕインタフェ\nースを介してＥＰＳにおけるノードと通信するための従来の通信手段（\n図示せず）が設けられる。」（段落【００４５】）\n「セキュリティキーＫ＿ｅＮＢを確立するための，図６ｂに示すＵＥ\n１１の手段には，サービスｅＮｏｄｅＢを介して，ＮＡＳサービス要求\nメッセージをＭＭＥに送信するための送信手段６６であって，この要求\nが，アップリンクシーケンス番号ＮＡＳ＿Ｕ＿ＳＥＱを示す手段が含ま\nれ，セキュリティキーＫ＿ｅＮＢを確立するための手段には，従来のキ\nー導出関数を用い，少なくともＮＡＳ＿Ｕ＿ＳＥＱおよび記憶されたＫ\n＿ＡＳＭＥに基づいて，セキュリティキーＫ＿ｅＮＢを導出するための\nキー導出手段６７が含まれる。」（段落【００４６】）\nウ  前記ア及びイによれば，本願明細書には，本願発明に関し，以下の点が\n開示されていることが認められる。\n(ア)  ＥＰＳ（次世代パケットシステム）においてＵＥが開始したアイド\nルからアクティブへの状態遷移のための従来の例示的なシグナリングフ\nロー（別紙本願明細書図面の図１参照）においては，ＭＭＥとＵＥとの\n間の非アクセス層シグナリングを保護するためにＮＡＳセキュリティコ\nンテキストが用いられ，ＵＥとサービスｅＮｏｄｅＢとの間のＵＰ／Ｒ\nＲＣトラフィックを保護するためにＵＰ／ＲＲＣセキュリティコンテキ\nストが用いられる（段落【０００２】ないし【０００４】）。ＵＰ／Ｒ\nＲＣセキュリティコンテキストを確立する手順には，Ｋ＿ｅＮＢと呼ば\nれるキーが導出され，Ｋ＿ｅＮＢから，エンドユーザデータを保護する\nための暗号化キーＫ＿ｅＮＢ＿ＵＰ＿ｅｎｃ，ＲＲＣ（無線資源制御）\nを保護するための暗号化キーＫ＿ｅＮＢ＿ＲＲＣ＿ｅｎｃ及び完全性保\n護キーＫ＿ｅＮＢ＿ＲＲＣ＿ｉｎｔを導出することが含まれる（段落【\n０００３】）。\n従来のソリューションでは，ＲＲＣ／ＵＰセキュリティコンテキスト\n用のＵＥ及びＭＭＥによるＫ＿ｅＮＢの導出は，例えば，ＭＭＥからＵ\nＥに送信されたＮＡＳサービス受理メッセージ又は他の明示的な情報に\n基づいているが，従来の例示的なシグナリングフローにおいては，ＭＭ\nＥは，通常，ＥＰＳにおいて，ＵＥからＮＡＳサービス要求を受信して\nも，いかなるＮＡＳサービス受理も送信しないため，ＮＡＳサービス受\n理メッセージにおける情報からＫ＿ｅＮＢを導出することは不可能であ\nった（段落【０００６】）。また，別の例示的な公知のソリューション\nによれば，Ｋ＿ｅＮＢの導出は，Ｋ＿ｅＮＢの導出のために保持される\n別個のシーケンス番号を，ＵＥがＭＭＥに送信するか，または，ＭＭＥ\nがＵＥに送信することによって行われるが，別個のシーケンス番号をＵ\nＥ及びＭＭＥの両方において保持しなければならないため，複雑である\nという欠点があった（段落【０００８】）。\n(イ)  本願発明のＭＭＥにおける方法は，従来のＲＲＣ／ＵＰセキュリテ\nィコンテキスト用のＵＥ及びＭＭＥによるＫ＿ｅＮＢの導出における上\n記課題を解決することを目的とし，Ｋ＿ｅＮＢが，アクセスセキュリテ\nィ管理エンティティキーＫ＿ＡＳＭＥから，及びＵＥからＭＭＥに送信\nされるＮＡＳサービス要求メッセージのアップリンクシーケンス番号Ｎ\nＡＳ＿Ｕ＿ＳＥＱから導出され，それによって，ｅＮｏｄｅＢにおいて\nＵＰ／ＲＲＣセキュリティコンテキストの確立をトリガするようにする\nため（段落【００２２】），ＮＡＳサービス要求を前記ＵＥから受信す\nるステップ（３２）であって，前記要求が，ＮＡＳアップリンクシーケ\nンス番号ＮＡＳ＿Ｕ＿ＳＥＱを示すステップと，少なくとも前記受信さ\nれたＮＡＳ＿Ｕ＿ＳＥＱから，および前記ＵＥと共有される，記憶され\nたアクセスセキュリティ管理エンティティキーＫ＿ＡＳＭＥから，前記\nセキュリティキーＫ＿ｅＮＢを導出するステップ（３３）と，前記導出\nされたＫ＿ｅＮＢを，前記ＵＥにサービスする前記ｅＮｏｄｅＢ（１２）\nに転送するステップ（３４）と，を含む構成を採用した。\n(ウ)  本願発明は，ＭＭＥからＵＥへの明示的なダウンリンクＮＡＳサー\nビス受理メッセージ又はＫ＿ｅＮＢの導出のために保持される別個のシ\nーケンス番号を必要とせず，また，ＮＡＳセキュリティコンテキストの\n再生保護機能が，ＲＲＣ及びＵＰセキュリティコンテキストにおいて再\n利用されるという利点を有する（段落【００１１】）。\n(2)  引用刊行物１の記載事項について\n引用刊行物１（甲１，乙１）には，次のような記載がある（「図面」につ\nいては別紙１を参照）。\nア  「ＥＵＴＲＡＮのアーキテクチャを，以下の図４に示す。\n４．１  機能の分割\nｅＮＢは，次の機能を実施する：\n－  無線機能管理のための機能：無線ベアラ制御，無線アドミッション制\n御，接続モビリティ管理，アップリンクと，ダウンリンクの双方における，\nＵＥのための資源の動的配置（スケジューリング）；\n－  ＩＰヘッダの圧縮，及び，ユーザ・データ・ストリームの暗号化；\n－  ＵＥ接続時の，ＭＭＥの選択；\n注：  ＵＥ接続時，はじめにＭＭＥは，含まれている，即ち，実質的には，\nＭＭＥは選択されていると，仮定する。\n－  サービス・ゲートウェイへのユーザ・プレーン・データのルーティン\nグ；\n注：  どのノードがユーザ・プレーン・トンネルを実際に設立するかは，\n次の検討である。\n注：  ユーザ・プレーン・トンネルの確立が，ＲＲＣ起動と共に起こるか\nどうかは，次の検討である。\n－  （ＭＭＥからのものである）ページング・メッセージのスケジューリ\nングと送信；\n－  （ＭＭＥ，或いは，Ｏ＆Ｍからのものである）ブロードキャスト情報\nのスケジューリングと送信；\n－  モビリティ，及び，スケジューリングのための測定と，計測報告の設\n定．\nＭＭＥは，次の機能を実施する：\n－  ｅＮＢへのページング・メッセージの分配；\n－  セキュリティ制御；\n－  アイドル状態モビリティ制御；\n－  ＳＡＥベアラ制御；\n－  ＮＡＳ信号伝達の暗号化と完全性保護．\nサービス・ゲートウェイは次の機能を実施する：\n－  ページング理由のための，Ｕ－プレーン・パケットの終端（次の検討\nである）；\n－  ＵＥモビリティのサポートのためのＵ－プレーンの切替．」（甲１抄\n訳）\n「４．３．２  制御プレーン\n下の図（判決注・図４．３．２）は，制御プレーンのためのプロトコル・\nスタックを示している，それは，\n－  （ネットワーク側のｅＮＢで終端される）ＰＤＣＰサブレイヤは，ユ\nーザプレーンと同様のセキュリティ機能を実行するが，ヘッダの圧縮は実\n行しない；\n－  （ネットワーク側のｅＮＢで終端される）ＲＬＣおよびＭＡＣサブレ\nイヤは，ユーザプレーンと同様の機能を実行する；\n－  （ネットワーク側のｅＮＢで終端される）ＲＲＣは，従属節７に一覧\nされている機能を実行する，たとえば：\n－  ブロードキャスト；\n－  ページング；\n－  ＲＲＣ接続管理；\n－  ＲＢ制御；\n－  モビリティ機能；\n－  ＵＥ測定報告および制御；\n－  （ネットワーク側のＭＭＥで終端されている）ＮＡＳ制御プロトコル\nは，とりわけ次を実行する。\n－  ＳＡＥベアラ管理；\n－  認証；\n－  ＬＴＥ＿ＩＤＬＥ  モビリティ・ハンドリング；\n－  ＬＴＥ＿ＩＤＬＥでのページングの開始；\n－  セキュリティ制御\n注：ＮＡＳ制御プロトコルは，このＴＳの範囲で取り扱われず，情報とし\nてのみ言及される。」（乙１抄訳）\nイ  「７  ＲＲＣ\nこの従属節は，ＲＲＣサブレイヤによって提供されるサービスと機能の\n概観を提供する。\n７．１  サービスと機能\nＲＲＣサブレイヤの主なサービスと機能は，次を含む：\n－非アクセス層（ＮＡＳ）に関連するシステム情報のブロードキャスト\n；\n－  アクセス層（ＡＳ）に関連するシステム情報のブロードキャスト；\n－  ページング；\n－  以下を含む，ＵＥとＥ－ＵＴＲＡＮ間のRRC接続の確立，維持，及び，\n解除；\n－  ＵＥとＥ－ＵＴＲＡＮ間の一時的な識別子の割当；\n－  ＲＲＣ接続のための信号無線ベアラの設定：\n－  低品位ＳＲＢと高品位ＳＲＢ\n－  以下を含むセキュリティ機能：\n－  ＲＲＣメッセージのための完全性保護\n－  ポイントツーポイント無線ベアラの確立，維持，及び，解除；\n－  以下を含むモビリティ機能\n－  セル間，及び，ＲＡＴ間モビリティのためのＵＥ測定報告，及び，\n報告の制御；\n－  セル間ハンドオーバ\n－  ＵＥセル選択と再選択，及び，セルの選択と再選択の制御；\n－  ｅＮＢ間のコンテキスト転送\n－  ＭＢＭＳサービスのための通知（次の検討である）；\n－  ＭＢＭＳサービスのための無線ベアラの確立，配置，維持，及び，\n解除（次の検討である）；\n－  ＱｏＳ管理機能；\n－  ＵＥ測定報告，及び，報告の制御；\n－  ＭＢＭＳ制御（次の検討である）；\n－  ＮＡＳダイレクト・メッセージのＵＥからＮＡＳへ／ＮＡＳからＵ\nＥへの転送」\n「７．３  ＮＡＳメッセージの転送\nＥ－ＵＴＲＡＮ内で，ＮＡＳメッセージはＲＲＣメッセージに結びつ\nけられるか，結びつけられることなく，ＲＲＣに入れられる。\n初期直接転送は，もし転送ブロックサイズが許せば，ＲＲＣ接続要求\nに結びつけられる（次の検討である）。他のＮＡＳメッセージは，おそ\nらく，（同期したＮＡＳ／ＲＲＣ手続のための）ＲＲＣメッセージ，に\n結びつけられる。\n注：ＮＡＳによって実行された完全性保護と暗号化に加えて，ＮＡＳ\nメッセージは，ＲＲＣによって完全性が保護され，ＰＤＣＰによって暗\n号化されている。」\n（以上，乙１抄訳）\nウ  （原文）\n「14 Security\n14.1 Overview and Principles\nThe following principles apply to E-UTRAN security:」\n「- The eNB keys are cryptographically separated from the EPC ke\nys used for NAS protection (making it impossible to use the eNB ke\ny to figure out an EPC key).」（第１原則）\n「- The keys are derived in the EPC/UE from key material that wa\ns generated by a NAS (EPC/UE) level AKA procedure.」（第２原則）\n「- The eNB keys are sent from the EPC to the eNB when the UE is\nentering LTE_ACTIVE state (i.e. during RRCconnection or S1 context\nsetup).」（第３原則）\n「- Key material for the eNB keys is sent between the eNBs durin\ng LTE_ACTIVE intra-E-UTRAN mobility.」（第４原則）\n「- A sequence number is used as input to the ciphering and inte\ngrity protection. A given sequence number must only be used once f\nor a given eNB key (except for identical re-transmission). The sam\ne sequence number can be used for both ciphering and integrity pro\ntection.」（第５原則）\n「- A hyper frame number (HFN) (i.e. an overflow counter mechani\nsm) is used in the eNB and UE in order to limit the actual number\nof sequence number bits that is needed to be sent over the radio.\nThe HFN needs to be synchronized between the UE and eNB.」（第６原\n則）\n「As a result of an AKA run， the EPC and the UE share a base-ke\ny named K_ASME. From K_ASME， the NAS， (and indirectly) K_eNB key\ns are derived. The K_ASME never leaves the EPC， but the K_eNB key\nis transported to the eNB from the EPC when the UE transitions to\nLTE_ACTIVE. From the K_eNB， the eNB and UE can derive the UP and\nRRC keys. When the UE goes into LTE_IDLE or LTE_DETACHED， the K_e\nNB， UP and RRC keys are deleted from the eNB. The key hierarchy i\ns depicted on Figure 14.1-1 below:」（概説）\n「１４  セキュリティ\n１４．１  概説及び原則\n次の原則は，Ｅ－ＵＴＲＡＮのセキュリティに適用される：\n－  （ＥＰＣ鍵を見つけ出すためにｅＮＢ鍵を用いることが不可能なよう\nに）ｅＮＢ鍵は，暗号によって，ＮＡＳ保護のために用いられるＥＰＣ鍵\nから分離される．」（第１原則）\n「－  その鍵は，ＥＰＣ／ＵＥにおいて，ＮＡＳ（ＥＰＣ／ＵＥ）レベ\nルＡＫＡ手続によって生成された，鍵素材から得られる。」（第２原則）\n「－  ｅＮＢ鍵は，ＵＥが，ＬＴＥ＿ＡＣＴＩＶＥ状態に入ると（即ち，\nＲＲＣ接続，或いは，Ｓ１コンテキスト設定の間），ＥＰＣから，ｅＮＢ\nに送られる。」（第３原則）\n「－  ｅＮＢ鍵のための鍵素材は，ＬＴＥ＿ＡＣＴＩＶＥ  イントラ－\nＥ－ＵＴＲＡＮモビリティの間に，ｅＮＢの間に送られる。」（第４原則）\n「－  シーケンス番号は，暗号化，及び，完全性保護のための入力とし\nて用いられる。所与のあるシーケンス番号は，所与のあるｅＮＢ鍵のため\nに使用されるのは，（同一の再送のためを除いて）一度のみでなければな\nらない。同一のシーケンス番号が，暗号化と，完全性保護の両方に用いる\nことができる。」（第５原則）\n「－  ハイパー・フレーム番号（ＨＦＮ）（即ち，桁あふれ計数機構）\nは，無線上に送られるために必要な連続番号ビットの実数を制限するため\nにｅＮＢとＵＥの中で使用される。ＵＥとｅＮＢの間でＨＦＮを同期する\n必要がある。」（第６原則）\n「ＡＫＡ（判決注:認証及び鍵共有のためのプロトコル）実行の結果とし\nて，ＥＰＣとＵＥは，Ｋ＿ＡＳＭＥという名の基本鍵を共有する。Ｋ＿Ａ\nＳＭＥから，ＮＡＳ（そして，間接的に），Ｋ＿ｅＮＢが得られる。Ｋ＿\nＡＳＭＥは，決して，ＥＰＣから離れない。しかしながら，Ｋ＿ｅＮＢ鍵\nは，ＵＥが，ＬＴＥ＿ＡＣＴＩＶＥに移行すると，ＥＰＣからｅＮＢに運\nばれる。Ｋ＿ｅＮＢから，ｅＮＢ，及び，ＵＥは，ＵＰ，及び，ＲＲＣ鍵\nを得ることができる。ＵＥが，ＬＴＥ＿ＩＤＬＥ，或いは，ＬＴＥ＿ＤＥ\nＴＡＣＨＥＤの状態になると，Ｋ＿ｅＮＢ，ＵＰ，及び，ＲＲＣ鍵は，ｅ\nＮＢから消去される。鍵階層は，下の図１４．１－１に描かれている。」\n（概説）\n（以上，甲１抄訳）\n(3)  引用発明の認定の誤りの有無について\n原告は，本件審決が，本件審決が引用刊行物１の「A given sequence numb\ner must only be used once for a given eNB key」（第５原則第２文）との\n記載について「得られたシーケンス番号は，ｅＮＢ鍵を得るために使用され\nるのは，一度のみでなければならない」と和訳（本件和訳）した上で，上記\n記載箇所から「“ｅＮＢ鍵を得るために，シーケンス番号が使用される”こ\nとが読み取れる。」と認定したが，本件和訳は誤訳であり，引用刊行物１に\nは，他に「Ｋ＿ｅＮＢ」を導出する手法についての開示はないから，「Ｋ＿\nｅＮＢを得るために，シーケンス番号が使用され」る構成についての開示は\nないとして，本件審決が認定した引用発明のうち，「前記Ｋ＿ｅＮＢを得る\nために，シーケンス番号が使用され」との部分は誤りである旨主張するので，\n以下において判断する。\nア  まず，引用刊行物１記載の第５原則第２文の「 A given sequence numbe\nr must only be used once for a given eNB key (except for identical\nre-transmission).」は，その文理からみて，「所与のあるシーケンス番\n号は，所与のあるｅＮＢ鍵のために使用されるのは，（同一の再送のため\nを除いて）一度のみでなければならない。」（前記(2)ウ）と和訳するのが\n自然である。\nそこで，第５原則第２文の「所与のあるシーケンス番号は，所与のある\nｅＮＢ鍵のために使用されるのは，（同一の再送のためを除いて）一度の\nみでなければならない。」にいう「ｅＮＢ鍵のために使用される」との意\n義について検討する。\nイ  前記(2)によれば，引用刊行物１の「１４．１  概説及び原則」には，第\n１原則としてｅＮＢ鍵（Ｋ＿ｅＮＢ）はＥＰＣ鍵から分離されること，第\n２原則としてｅＮＢ鍵はＥＰＣ／ＵＥにおいてＮＡＳ（ＥＰＣ／ＵＥ）レ\nベルＡＫＡ手続によって生成された鍵素材から得られること，第３原則と\nしてＵＥがＬＴＥ＿ＡＣＴＩＶＥ状態に入ると，ｅＮＢ鍵はＥＰＣからｅ\nＮＢに送られること，第４原則としてｅＮＢ鍵のための鍵素材はｅＮＢ間\nで送られること，第６原則としてシーケンス番号を構成するハイパー・フ\nレーム番号（ＨＦＮ）についての記載があり，また，これらの「原則」に\n引き続き記載されている「概説」には，ＥＰＣ及びＵＥが共有するＫ＿Ａ\nＳＭＥという名称の基本鍵からＫ＿ｅＮＢが得られることや，ｅＮＢ及び\nＵＥにおいてＫ＿ｅＮＢからＵＰ及びＲＲＣ鍵を得られることが記載され\nている。\nこのように「１４．１  概説及び原則」には，第５原則の前後の文脈に\nおいて，ｅＮＢ鍵（Ｋ＿ｅＮＢ）の「生成」及び「共有」（第２原則，概\n説），「転送」（第３原則，概説）に関する記載がある。\nそして，第５原則には，ｅＮＢ鍵（Ｋ＿ｅＮＢ）と「シーケンス番号」\nとの関係に関し，「所与のあるシーケンス番号は，所与のあるｅＮＢ鍵の\nために使用されるのは，（同一の再送のためを除いて）一度のみでなけれ\nばならない。」（第２文）との記載がある。\n一方で，第５原則には，「シーケンス番号」に関し，「シーケンス番号」\nが暗号化及び完全性保護のための入力として用いられること（第１文），\n同一の「シーケンス番号」が暗号化と完全性保護の両方に用いることがで\nきること（第３文）についての記載があるが，「１４．１  概説及び原則」\nには，第５原則第２文にいう「所与のあるシーケンス番号」が「ｅＮＢ鍵\nのために使用される」ことについて，その使用の具体的な態様を明示した\n記載はない。\nウ  被告は，この点に関し，シーケンス番号を使用して鍵を生成することに\nよって効率的に鍵を共有することができることは，本願の優先権主張日当\n時，セキュリティの分野における技術常識であったことを踏まえると，シ\nーケンス番号が「ｅＮＢ鍵のために使用される」とは，シーケンス番号が\n「ｅＮＢ鍵の生成のため」に使用されることを意味する旨主張するので，\n以下において，本願の優先権主張日当時におけるシーケンス番号に関する\n技術常識について検討する。\n(ア)  乙６の記載事項\nａ  乙６には，図１，図５及び図６とともに，以下の記載がある（上記\n各図面については別紙３を参照）。\n(a)  「【発明の属する技術分野】本発明は，通信の安全性を高めるた\nめに，暗号を用いて通信する暗号通信装置に関し，特に，暗号通信\nに先立って行われる暗号鍵伝送時の手間を簡略化できる暗号通信装\n置に関するものである。」（段落【０００１】）\n(b)  「一方，本実施形態に係る暗号鍵生成部５２は，暗号通信に先立\nって，後述する手順で通信相手の暗号通信装置３ｂと通信してネゴ\nシエーションする。これにより，暗号鍵生成部５２は，送信した暗\n号化乱数を，上記送信暗号化乱数領域４２へ格納すると共に，受信\nした暗号化乱数を，受信暗号化乱数領域４３へ格納する。さらに，\n暗号鍵生成部５２は，両暗号化乱数に基づき，暗号通信時に使用さ\nれる通信用暗号化鍵および通信用復号化鍵を生成して暗号処理部５\n１へ通知できる。」（段落【００６８】）\n「両暗号通信装置３ａ・３ｂが通信可能になると，発呼側の暗号\n通信装置３ａは，図５に示すステップＳ１ａにて，乱数Ａ１を生成\nし，Ｓ２ａにて，通信相手の暗号通信装置３ｂへ当該乱数Ａ１を送\n出する。なお，以下では，発呼側の暗号通信装置３ａが実行するス\nテップには，例えば，Ｓ１ａのように，符号の末尾にａを付して参\n照し，被呼側の暗号通信装置３ｂが実行するステップには，Ｓ１ｂ\nのように，符号の末尾にｂを付して参照する。」（段落【００７２\n】）\n「一方，被呼側の暗号通信装置３ｂは，Ｓ１ｂにて，暗号通信装\n置３ａから乱数Ａ１を受け取ると，Ｓ２ｂにおいて，予め共有され\nた共有鍵Ｏを用いて，当該乱数Ａ１を暗号化する。これにより，暗\n号化乱数Ａ２が生成される。さらに，暗号通信装置３ｂは，Ｓ３ｂ\nにおいて，発呼側の暗号通信装置３ａへ，生成した暗号化乱数Ａ２\nを送り返す。」（段落【００７３】）\n「さらに，発呼側と被呼側とを入れ換えて，上記Ｓ１ａ～Ｓ５ａ\nおよびＳ１ｂ～Ｓ３ｂと同様のステップが行われる（Ｓ１１ｂ～Ｓ\n１５ｂおよびＳ１１ａ～Ｓ１３ａ）。これらのステップでは，両暗\n号通信装置３ａ・３ｂは，被呼側の暗号通信装置３ｂが生成した乱\n数Ｂ１に基づいて，暗号化乱数Ｂ２・Ｂ３をそれぞれ生成する。こ\nれにより，被呼側の暗号通信装置３ｂは，発呼側の暗号通信装置３\nａを認証できる。」（段落【００７７】）\n「両暗号通信装置３ａ・３ｂが通信相手による認証に成功すると，\n図６に示すように，上記両暗号化乱数Ａ２・Ｂ２に基づいて，暗号\n通信に使用される通信用暗号鍵が生成される。すなわち，発呼側の\n暗号通信装置３ａは，Ｓ２１ａにおいて，自ら（発呼側）が生成し\nた暗号化乱数Ｂ２を共有鍵Ｏで暗号化して，暗号化データＢ４を生\n成する。また，Ｓ２２ａにおいて，受け取った暗号化乱数Ａ２を共\n有鍵Ｏで暗号化して，暗号化データＡ５を生成する。」（段落【０\n０８０】）\n(c)  「また，本実施形態では，図５のステップＳ１ａ・Ｓ２ａ，およ\nび，Ｓ１１ｂ・Ｓ１２ｂに示すように，両暗号通信装置３ａ・３ｂ\nが乱数を生成して送出する場合について説明したが，これに限るも\nのではない。例えば，日付や時刻，あるいは，シーケンス番号など\nを用いてもよい。両暗号通信装置３ａ・３ｂが通信毎に異なるデー\nタを送出すれば，本実施形態と同様の効果が得られる。」（段落【\n００９５】）\nｂ  前記ａの記載事項によれば，乙６には，暗号通信に使用される通信\n用暗号鍵の生成に，「乱数」や「シーケンス番号」が用いられること\nが開示されているものと認められる。\n(イ)  乙７の記載事項\nａ  乙７には，第４図とともに，以下の記載がある（第４図については\n別紙４を参照）。\n(a)  「発明の分野\n本発明は，ディジタル領域式通信システムに関し，特にそのよう\nなシステム内のデータ通信の暗号化用の方法および装置に関する。」\n（５頁左下欄４行～７行）\n(b)  「本発明の特定な実施例の特定な説明をこれから行なう。上述の\n通り，かつ以下に使用される通り，「キーストリーム」という語は，\n未確認アクセス，例えばＲＦチャネルの影響を受けやすい媒体にあ\nる記憶を伝送する前に，ディジタル符号式メツセージまたはデータ\n信号を暗号化するのに用いられた２進ビットまたはビットのブロッ\nクの擬似ランダム・シーケンスを意味する。」（１１頁右上欄５行\n～１２行）\n(c)  「第４図を参照すると，従来技術の日毎定時刻駆動による暗号化\nシステムの略ブロック図を見ることができる。第４図の上半分は，\n送信機部分を表わし，下半分はそのような暗号化システムの受信機\n部分を表わす。送信機部分では，タイム・クロックまたはブロック\n・カウンタ２０１はカウント２１３，例えばタイム・クロックまた\nはブロック・カウンタ２０１の入力に加えられる増分２１５に応じ\nて，３２－ビットの出力を発生させる。カウント２１３は，結合式\n論理または混合工程２０２に第１入力として供給される。例えば，\n２進記法の値９６８１７３であるシークレット・キーは，第２入力\n２１１として，結合式論理または混合工程２０２の第２入力として\n供給される。カウント２１３に対して新しい値が生じるごとに，結\n合式論理または混合工程２０２は，シークレット・キー２１１をカ\nウント２１３と結合させたり混合して，直列または並列出力２０９\nで複数の擬似ランダム・キーストリーム・ビットを発生させる。キ\nーストリーム出力２０９は，同時に，モジュロ－２加算器２０３に\n入力として供給される。暗号化すべきデータは，モジュロ－２加算\n器２０３に第２入力２０７を形成する。各キーストリーム・ビット\nは，モジュロ－２加算機２０３によって特定のデータ・ビットに加\nえられるモジュロ－２であり，暗号式データは媒体を通して伝送す\nる出力２１８に供給される。\n受信機部分では，タイム・クロックまたはクロック・カウンタ２\n０４は，タイム・クロックまたはブロック・カウンタ２０１と構造\nが同じであり，増分２１５と同じ増分２１６を供給され，結合式論\n理または混合工程２０２と構造が同じである結合式論理または混合\n工程２０５にカウント２１４を供給する。結合式論理または混合工\n程２０５は，カウント２１４を同一なシークレット・キー，すなわ\nち入力２１２に供給される２進記法の９６８１７３と結合させたり\n混合したりするが，それによって出力２１０にキーストリームを作\nり，この出力は出力２０９で作られたキーストリームと同じである。\nキーストリーム出力２１０は，モジュロ－２加算器２０６によって\n伝送媒体で受信された暗号式データに少しずつ加えられるモジュロ\n－２である。モジュロ－２加算およびモジュロ－２減算は同じ操作\nであり，受信機における同一キー・ストリームのモジュロ－２加算\nは送信機におけるキーストリームの前の加算を打ち消して，出力２\n０８で原データの回復をもたらす。しかし，暗号式データのそのよ\nうな打消しおよび正しい解読は，タイム・クロックまたはブロック\n・カウンタ２ｆ０１，２０４が相互に完全に同期機構２１７は，こ\nの目的で供給されなければならない。」（１１頁左下欄２２行～１\n２頁左上欄１７行）\nｂ  前記ａの記載事項によれば，乙７には，暗号鍵である「キーストリ\nーム」の生成に，シーケンス番号である「カウント」が用いられるこ\nとが開示されているものと認められる。\n(ウ)  引用刊行物２の記載事項\n引用刊行物２（甲２の１）のＦＩＧ．３Ａ（別紙５）によれば，引用\n刊行物２には，「Ｆｕｌｌ  Ｓｅｑｕｅｎｃｅ  Ｎｕｍｂｅｒ」（フル\nシーケンス番号）が「Ｋｅｙｓｔｒｅａｍ」（キーストリーム）の生成\nに用いられることが開示されているものと認められる。\n(エ)  検討\n以上によれば，本願の優先権主張日当時，暗号鍵の生成に，シーケン\nス番号が用いられることは，当業者の技術常識であったものと認められ\nる。\nエ  前記イのとおり，引用刊行物１の「１４．１  概説及び原則」には，第\n５原則第２文にいう「所与のあるシーケンス番号」が「ｅＮＢ鍵のために\n使用される」ことについて，その使用の具体的な態様を明示した記載はな\nい。\nしかるところ，「１４．１  概説及び原則」には，第５原則の前後の文\n脈において，ｅＮＢ鍵（Ｋ＿ｅＮＢ）の「生成」及び「共有」（第２原則，\n概説），「転送」（第３原則，概説）に関する記載があり（前記イ），第\n５原則は，そのような一連の文脈の中で理解されるべきものであること，\n本願の優先権主張日当時，暗号鍵の生成に，シーケンス番号が用いられる\nことは，当業者の技術常識であったこと（前記ウ(エ)）に鑑みると，引用\n刊行物１に接した当業者は，第５原則第２文の「所与のあるシーケンス番\n号は，所与のあるｅＮＢ鍵のために使用されるのは，（同一の再送のため\nを除いて）一度のみでなければならない。」にいう「ｅＮＢ鍵のために使\n用される」とは，暗号鍵である「ｅＮＢ鍵の生成のために」使用されるこ\nとを意味し，「第２文」は，「所与のあるｅＮＢ鍵」の生成のために一度\n使用された「所与のあるシーケンス番号」は，当該「所与のあるｅＮＢ鍵」\nの生成のために再度使用してはならないことを記載したものと理解するも\nのと認められる。\nそうすると，「シーケンス番号」が，「ｅＮＢ鍵の生成のために使用さ\nれる」とは，本件審決が認定した引用発明の「Ｋ＿ｅＮＢを得るために，\nシーケンス番号が使用され」ることと技術的に同じ意味であるといえるか\nら，本件審決が認定した引用発明のうち，「前記Ｋ＿ｅＮＢを得るために，\nシーケンス番号が使用され」との部分が誤りであるとはいえないというべ\nきである。\nオ  原告は，これに対し，①引用刊行物１（3GPP TS 36.300 version 8.1.0\nRelease 8）の後のバージョンの甲８（3GPP TS 36.300 version 8.8.0 Re\nlease 8）に「A sequence number (COUNT) is used as input to the ciph\nering and integrity protection.」との記載があることからすると，第５\n原則第２文中の「A given sequence number」にいう「sequence number」\nとは「ＣＯＵＮＴ」を意味すること，②引用刊行物１の後のバージョンの甲\n９の１（3GPP TS 36.323 version 1.0.0 Release 8）には，シーケンス番\n号の一種である「ＣＯＵＮＴ」が，暗号化及び完全性保護のパラメータとし\nて，ＫＲＲＣｅｎｃ，ＫＵＰｅｎｃ及びＫＲＲＣｉｎｔのようなｅＮＢ鍵の下位の鍵と共に用\nいられることが示されていることからすると，第５原則は，第１文において，\nシーケンス番号が暗号化及び完全性保護の入力として用いられること，第２\n文において，ある所与のシーケンス番号が，（暗号化及び完全性保護に用い\nられる際に，）ある所与のｅＮＢ鍵を基にして得られたＵＰ鍵（ＫｅＮＢ－ＵＰ－\nｅｎｃ）及びＲＲＣ鍵（ＫｅＮＢ－ＲＲＣ－ｅｎｃ，ＫｅＮＢ－ＲＲＣ－ｉｎｔ）のために用いられ\nるのは一度でなければならないこと，第３文において，所与のｅＮＢ鍵（正\n確には，その下位のＵＰ鍵及びＲＲＣ鍵）が暗号化及び完全性保護の手続に\n用いられることを述べたものであることからすると，第５原則第２文は，暗\n号化及び完全性保護の手続について述べたものであって，シーケンス番号が\nｅＮＢ鍵の生成のために用いられることを述べたものではない旨主張する。\nしかしながら，原告の主張は，以下のとおり理由がない。\n(ア)  上記①の点について\nａ  甲８には，「－  シーケンス番号（ＣＯＵＮＴ）は，暗号化，及び，\n完全性保護のための入力として用いられる。所与のあるシーケンス番\n号は，所与のあるｅＮＢ鍵のために使用されるのは，同一方向におけ\nる同一の無線ベアラにおいては（同一の再送のためを除いて）一度の\nみでなければならない。同一のシーケンス番号が，暗号化と，完全性\n保護の両方に用いることができる。」（原文７３頁下から９行～下か\nら７行の訳文）との記載がある。\n甲８の上記記載と引用刊行物１の「１４．１  概説及び原則」の第\n５原則第２文とを対比すると，上記記載のうち，「シーケンス番号（\nＣＯＵＮＴ）は，暗号化，及び，完全性保護のための入力として用い\nられる。」との記載箇所は，第５原則第１文の「シーケンス番号」を\n「シーケンス番号（ＣＯＵＮＴ）」としたほかは，第１文と同内容で\nあること，「所与のあるシーケンス番号は，所与のあるｅＮＢ鍵のた\nめに使用されるのは，同一方向における同一の無線ベアラにおいては\n（同一の再送のためを除いて）一度のみでなければならない。」との\n記載箇所は，第５原則第２文に「同一方向における同一の無線ベアラ\nにおいては」の文言を付け加えたほかは，第２文と同内容であること，\n「同一のシーケンス番号が，暗号化と，完全性保護の両方に用いるこ\nとができる。」との記載箇所は第３文と同内容であることが認められ\nる。\nｂ  上記認定事実によれば，引用刊行物１（3GPP TS 36.300 version 8.\n1.0 Release 8（2007-06））の公開時（２００７年（平成１９年）６\n月）には，第５原則第１文の「暗号化，及び，完全性保護のための入\n力」として「シーケンス番号」を用いること自体は決定されていたが，\n具体的にどのようなシーケンス番号を用いるのかについては決定され\nておらず，その後検討が進められた結果，引用刊行物１と同じ規格（\n「3GPP TS 36.300」）の後のバージョンである甲８（3GPP TS 36.300\nversion 8.8.0 Release 8（2009-03））の公開時（２００９年（平成\n２１年）３月）までに，第５原則第１文の「シーケンス番号」として\n「ＣＯＵＮＴ」を規格として採用することが決定されたものと推認さ\nれる。このように引用刊行物１の公開時には，第５原則第１文の「シ\nーケンス番号」として具体的にどのようなシーケンス番号を用いるの\nかについては決定されていなかったことに照らすと，同様に，第５原\n則第２文の「所与のあるシーケンス番号」にいう「シーケンス番号」\nについても，具体的にどのようなシーケンス番号を用いるのかについ\nては決定されていなかったと解するのが自然であるから，これが「Ｃ\nＯＵＮＴ」として特定されていた旨の原告の主張は採用することがで\nきない。\n(イ)  上記②の点について\nａ  甲９の１には，次のような記載がある。\n(a)  「５．３  暗号化及び復号化\n暗号化機能はＰＤＣＰで実行される。暗号化されるデータユニット\nは，ヘッダ圧縮が構成される場合はその後のＰＤＣＰ  ＰＤＵのデ\nータ部分（Ｕプレーンデータに関連するＰＤＣＰエンティティにの\nみ適用）（項目６．３．２を参照）及び，可能な場合，ＭＡＣフィ\nールド（項目６．３．３を参照）である（ＦＦＳ（要検討））。\nユーザプレーン無線ベアラに関連するＰＤＣＰエンティティに使用\nされる暗号化アルゴリズム及び鍵は，ＰＤＣＰ  ＰＤＵが受信／送\n信された時に上位層［３］によって構成され，［６］で明記した暗\n号化方法が適用される。ヘッダ圧縮を使用するように構成される場\n合，ＰＤＣＰ  ＳＤＵに関連する圧縮パケットのみが，関連するＣ\nＯＵＮＴ値に基づいて暗号化／復号化される。\n制御プレーン無線ベアラに関連するＰＤＣＰエンティティに使用さ\nれる暗号化アルゴリズム及び鍵は，受信される各ＰＤＣＰ  ＰＤＵ\nに対して上位層［３］によって構成され，［６］で明記した暗号化\n方法が適用される。\n暗号化保護のためにＰＤＣＰに要求されるパラメータは［６］で定\n義され，暗号化アルゴリズムに入力される。上位層［３］によって\n提供されるＰＤＣＰに要求されるパラメータを以下に記載する。\n－  ＣＯＵＮＴ\n－  ＢＥＡＲＥＲ（［５］で無線ベアラ識別子として定義される。\n［３］のように，値ＲＢアイデンティティ  １を使用する。）\n－  ＤＩＲＥＣＴＩＯＮ（送信方向）\n－  ＣＫ（暗号鍵）\n－  ＩＢＳ（入力ビットストリーム）」\n「５．４  完全性保護\n完全性保護機能は，制御プレーン無線ベアラに関連するＰＤＣＰエ\nンティティに対してＰＤＣＰで実行される。\nＰＤＣＰエンティティに使用される完全性保護アルゴリズム及び鍵\nは，受信される各ＰＤＣＰ  ＰＤＵに対して上位層［３］によって\n構成され，［６］で明記した完全性保護方法が適用される。完全性\n保護のためにＰＤＣＰに要求されるパラメータは［６］で定義され，\n完全性保護アルゴリズムに入力される。上位層［３］によって提供\nされるＰＤＣＰに要求されるパラメータを以下に記載する。\n－  ＣＯＵＮＴ\n－  ＢＥＡＲＥＲ（［６］で無線ベアラ識別子として定義される。\n［３］のように，値ＲＢアイデンティティ  １を使用する。）\n－  ＤＩＲＥＣＴＩＯＮ（送信方向）\n－  ＩＫ（完全性保護鍵）\n－  ＩＢＳ（入力ビットストリーム：暗号化又は復号化されたデー\nタユニット（ＦＦＳ（要検討）））\n－  ＦＲＥＳＨ\n完全性保護を検証する場合，上記したように，ＵＥは，入力パラメ\nータに基づいてＸ－ＭＡＣを計算する。計算したＸ－ＭＡＣがＭＡ\nＣと一致する場合，完全性保護の検査は成功したことになる。Ｘ－\nＭＡＣが受信したＭＡＣと一致しない場合，対応するパケットは廃\n棄される。」\n（以上，原文１２頁１９行～１３頁１５行・訳文１頁～２頁）\n(b)  「６．３．４  ＣＯＵＮＴ\n暗号化と完全性保護のため，ＣＯＵＮＴ値は保持される。ＣＯＵ\nＮＴ値は，ＨＦＮ及び当該ＰＤＣＰシーケンス番号から構成され\nる。」\n（原文１６頁３行～５行・訳文３頁）\nｂ  上記ａの記載事項によれば，甲９の１には，暗号化機能は，「ＰＤ\nＣＰ」（「ＮＡＳ」よりも下位の階層（サブレイヤ））で実行され，\n暗号化保護のためのパラメータが暗号化アルゴリズムに入力されるこ\nと，完全性保護機能も，「ＰＤＣＰ」で実行され，完全性保護のため\nのパラメータが完全性保護アルゴリズムに入力されること，暗号化及\nび完全性保護のためのパラメータとして，ＨＦＮ及び当該ＰＤＣＰシ\nーケンス番号から構成される「ＣＯＵＮＴ」が用いられることが開示\nされていることが認められる。\nしかるところ，甲９の１は，引用刊行物１が公開（２００７年（平\n成１９年）６月）された後に公開（同年９月）されたこと（弁論の全\n趣旨）からすると，上記開示事項は，引用刊行物１の公開当時，「１\n４．１  概説及び原則」の第５原則第１文の「暗号化，及び，完全性\n保護のための入力」として「シーケンス番号」として，「ＣＯＵＮＴ」\nが有力候補の一つとして検討されていたことをうかがわせるものであ\nるとしても，その公開時に，「ＣＯＵＮＴ」を採用することが決定し\nていたことの根拠となるものではないし，同様に，第５原則第２文の\n「所与のあるシーケンス番号」にいう「シーケンス番号」として「Ｃ\nＯＵＮＴ」を採用することが決定していたことの根拠となるものでも\nない。\nましてや，甲９の１が，第５原則第２文が「ある所与のシーケンス\n番号が，（暗号化及び完全性保護に用いられる際に，）ある所与のｅＮ\nＢ鍵を基にして得られたＵＰ鍵（ＫｅＮＢ－ＵＰ－ｅｎｃ）及びＲＲＣ鍵（ＫｅＮ\nＢ－ＲＲＣ－ｅｎｃ，ＫｅＮＢ－ＲＲＣ－ｉｎｔ）のために用いられるのは一度でなければ\nならないこと」を意味する旨の原告主張の裏付けとなるものではない。\n(ウ)  小括\n以上によれば，第５原則第２文は，暗号化及び完全性保護の手続につい\nて述べたものであり，シーケンス番号がｅＮＢ鍵の生成のために用いられ\nることを述べたものではないとの原告の主張は，理由がない。\n(4)  一致点の認定の誤りの有無について\n原告は，引用発明における「シーケンス番号」には，本願発明の「ＮＡＳ\n＿Ｕ＿ＳＥＱ」は含まれないから，本件審決が，「シーケンス番号と，およ\nび前記ＵＥと共有される，記憶されたアクセスセキュリティ管理エンティテ\nィキーＫ＿ＡＳＭＥから，前記セキュリティキーＫ＿ｅＮＢを導出するステ\nップ」を本願発明と引用発明の一致点と認定したのは誤りである旨主張する。\nア  引用刊行物１の「１４．１  概説及び原則」の第５原則第２文の「所与\nのあるシーケンス番号は，所与のあるｅＮＢ鍵のために使用されるのは，\n（同一の再送のためを除いて）一度のみでなければならない。」にいう「\nｅＮＢ鍵のために使用される」とは，「ｅＮＢ鍵の生成のために」使用さ\nれることを述べたものであることは，前記(3)エ認定のとおりである。\nそして，引用刊行物１の公開時において，第５原則第１文の「シーケン\nス番号」及び第５原則第２文の「所与のあるシーケンス番号」にいう「シ\nーケンス番号」として具体的にどのようなシーケンス番号を採用するかに\nついて決定されていなかったことは，前記(3)オ(ア)及び(イ)のとおりであ\nる。\nイ  前記(2)アの引用刊行物１の記載事項（別紙１の図４．３．２を含む。）\nには，ＵＥ及びＭＭＥ間の「ＮＡＳ」のサブレイヤ（レベル），ＵＥ及び\nｅＮＢ間の「ＲＲＣ」，「ＰＤＣＰ」，「ＲＬＣ」等のサブレイヤ（レベ\nル）における「制御プレーン・プロトコル・スタック」についての記述が\nある。\nしかるところ，上記各サブレイヤ（レベル）で送信又は受信されるパケ\nットに，それぞれのサブレイヤ（レベル）に対応する「シーケンス番号」\nが含まれることは，本願の優先権主張日当時，技術常識であったものであ\nる。\n上記技術常識に加えて，引用刊行物１には，「ｅＮＢ鍵」は，「ＥＰＣ\n／ＵＥにおいて，ＮＡＳ（ＥＰＣ／ＵＥ）レベルＡＫＡ手続によって生成\nされた，鍵素材から得られる。」（第２原則）が記載されていること（前\n記(2)ウ）を踏まえると，引用刊行物１に接した当業者は，第５原則第２文\nの「ｅＮＢ鍵の生成のために」使用される「シーケンス番号」は，ＵＥ及\nびＭＭＥ間の「ＮＡＳ」のサブレイヤ（レベル）で送信又は受信されるパ\nケットに含まれるシーケンス番号を意味するものと理解するものと認めら\nれる。\nそして，ＵＥからみて上流側であるｅＮＢやＭＭＥへのパケット送信を\nアップリンク送信，逆に，ＭＭＥやｅＮＢからみて下流側であるＵＥへの\nパケット送信をダウンリンク送信と称することは，本願の優先権主張日当\n時，技術常識であったこと（例えば，引用刊行物２（甲２の１）の段落【\n００４３】，【００４４】，【００７４】）に照らすと，本願発明の「Ｎ\nＡＳ＿Ｕ＿ＳＥＱ」は，ＵＥ及びＭＭＥ間の「ＮＡＳ」のサブレイヤ（レ\nベル）で，ＵＥからＭＭＥへの「ＮＡＳサービス要求」に係るパケットに\n含まれるアップリンクシーケンス番号であることは自明であるから，第５\n原則第２文の「ｅＮＢ鍵の生成のために」使用される「シーケンス番号」\nに含まれるものと整理することも許されるというべきである。\nそうすると，引用発明における「シーケンス番号」は，本願発明の「Ｎ\nＡＳ＿Ｕ＿ＳＥＱ」を含む上位概念として整理し，「シーケンス番号と，\nおよび前記ＵＥと共有される，記憶されたアクセスセキュリティ管理エン\nティティキーＫ＿ＡＳＭＥから，前記セキュリティキーＫ＿ｅＮＢを導出\nするステップ」を本願発明と引用発明の一致点と認定したことに誤りはな\nい。\nウ  原告は，これに対し，①引用刊行物１には，「Ｋ＿ｅＮＢを得るために，\nシーケンス番号が使用され」る構成についての開示はないから，引用発明\nは，「シーケンス番号と，および前記ＵＥと共有される，記憶されたアク\nセスセキュリティ管理エンティティキーＫ＿ＡＳＭＥから，前記セキュリ\nティキーＫ＿ｅＮＢを導出するステップ」の構成を有するものとはいえな\nい，②引用刊行物１記載の第５原則第２文中の「A given sequence number」\nにいう「sequence number」とは，「ＣＯＵＮＴ」を意味するから，「ＮＡ\nＳ＿Ｕ＿ＳＥＱ」とは異なるシーケンス番号である，③第５原則は，「Ｅ\n－ＵＴＲＡＮ」すなわち「ＵＥ」と「ｅＮＢ」間のネットワークのセキュリ\nティについて述べたものであるのに対し，「ＮＡＳ」は，「ＵＥ」と「ＭＭ\nＥ」との間のプロトコルであり，本願発明と引用発明とは，「シーケンス番\n号」が用いられるプロトコルが異なるから，「シーケンス番号」の意味が異\nなることは，当業者にとって自明であり，引用発明における「シーケンス番\n号」には，本願発明の「ＮＡＳ＿Ｕ＿ＳＥＱ」は含まれない旨主張する。\nしかしながら，引用刊行物１の第５原則第２文にシーケンス番号が「ｅ\nＮＢ鍵の生成のために」使用されることについての開示があること，引用刊\n行物１の「シーケンス番号」が「ＣＯＵＮＴ」に特定又は限定されるもので\nないことは，前記(3)オで説示したとおりであるから，上記①及び②の点は\n理由がない。\nまた，前記アのとおり，第５原則第２文の「ｅＮＢ鍵の生成のために」\n使用される「シーケンス番号」は，ＵＥ及びＭＭＥ間の「ＮＡＳ」のサブ\nレイヤ（レベル）で送信又は受信されるパケットに含まれるシーケンス番\n号を意味するものといえるから，上記③の点も理由がない。\nしたがって，原告の上記主張は，採用することができない。\n(5)  まとめ\n以上のとおり，本件審決がした引用発明及び一致点の認定に原告主張の誤\nりは認められないから，原告主張の取消事由１は理由がない。\n２  取消事由２（相違点の看過）について\n(1)  原告は，本願発明は，「ＮＡＳサービス要求を前記ＵＥから受信するステ\nップ（３２，５２）であって，前記要求が，ＮＡＳアップリンクシーケンス\n番号ＮＡＳ＿Ｕ＿ＳＥＱを示すステップ」の構成を有するが，本件審決は，\n引用発明が上記構成を有することを認定していないから，上記構成を本願発\n明と引用発明の相違点として認定すべきであったのに，この相違点の認定を\n看過した誤りがある旨主張する。\nそこで検討するに，前記１(2)イの引用刊行物１の記載事項（「７．１  サ\nービスと機能」，「７．３  ＮＡＳメッセージの転送）」）と図１９．２．\n２．３（別紙１参照）を総合すると，引用刊行物１には，①「ＮＡＳダイレ\nクトメッセージ」が「ＵＥ」から「ＮＡＳ」へ又は「ＮＡＳ」から「ＵＥ」\nへ転送（初期直接転送）されること，②「ＮＡＳサービスリクエスト」（Ｎ\nＡＳサービス要求）が「ＵＥ」から「ＮＡＳ」によって「ｅＮＢ」を経て「\nＭＭＥ」へ送信され，「ＭＭＥ」がこれを受信することが記載されているこ\nとが認められる。\nそうすると，引用刊行物１には，「ＭＭＥ」が「ＮＡＳサービス要求を前\n記ＵＥから受信するステップ」が開示されているものといえる。\nそして，「ＮＡＳサービス要求」のパケットにシーケンス番号（アップリ\nンクシーケンス番号）含まれることは自明であるから，引用刊行物１には，\n「ＮＡＳサービス要求を前記ＵＥから受信するステップであって，前記要求\nが，ＮＡＳアップリンクシーケンス番号ＮＡＳ＿Ｕ＿ＳＥＱを示すステップ」\nの構成が実質的に記載されているに等しいものと認められる。\nそうすると，上記構成は，本願発明と引用刊行物１記載の方法との間の相\n違点ではなく，むしろ一致点と認定すべきであったものといえる。\nしたがって，原告の上記主張は理由がない。\n(2)  以上によれば，本件審決に相違点の看過の誤りがあるものと認められない\nから，原告主張の取消事由２は理由がない。\nなお，本件審決が，本願発明の「ＮＡＳサービス要求を前記ＵＥから受信\nするステップであって，前記要求が，ＮＡＳアップリンクシーケンス番号Ｎ\nＡＳ＿Ｕ＿ＳＥＱを示すステップ」の構成と引用刊行物１記載の方法との関\n係について明示的に認定判断を示さなかったことは，不適切であったものと\nいわざるを得ないが，この点は，審決の結論に影響を及ぼすものではない。\n３  取消事由３（相違点の容易想到性の判断の誤り）について\n(1)  原告は，①引用刊行物１（甲１）には，「Ｋ＿ｅＮＢを得るために，シー\nケンス番号が使用され」る構成についての開示がなく，また，仮に引用刊行\n物１に上記構成の開示があるとしても，Ｋ＿ｅＮＢを得るためにＮＡＳサー\nビス要求で示される「ＮＡＳ＿Ｕ＿ＳＥＱ」をシーケンス番号として用いる\nことの開示はない，②同様に，引用刊行物２（甲２の１）及び本件審決が認\n定した周知技術（「「ＵＥ」から，「ＭＭＥ」に対して「ＲＲＣ／ＮＡＳ信\n号」を送信する点」）のいずれにおいても，ＮＡＳサービス要求で示される\n「ＮＡＳ＿Ｕ＿ＳＥＱ」をＫ＿ｅＮＢの生成のために用いることについての開\n示や示唆はないとして，引用発明に引用刊行物２記載の発明及び本件審決が認\n定した構成を組み合わせても，当業者が相違点に係る本願発明の構成を容易に\n想到することができたものとはいえないから，本件審決における相違点の容易\n想到性の判断に誤りがある旨主張する。\nア  引用刊行物１の「１４．１  概説及び原則」の第５原則第２文の「所与\nのあるシーケンス番号は，所与のあるｅＮＢ鍵のために使用されるのは，\n（同一の再送のためを除いて）一度のみでなければならない。」にいう「\nｅＮＢ鍵のために使用される」とは，「ｅＮＢ鍵の生成のために」使用さ\nれることを述べたものであることは，前記１(3)エ認定のとおりである。\nそして，当業者においては，第５原則第２文の「ｅＮＢ鍵の生成のため\nに」使用される「シーケンス番号」は，ＵＥ及びＭＭＥ間の「ＮＡＳ」の\nサブレイヤ（レベル）で送信又は受信されるパケットに含まれるシーケン\nス番号を意味するものと理解するものと認められることは，前記１(4)イ認\n定のとおりである。\n加えて，引用刊行物１に，「ＮＡＳサービスリクエスト」（ＮＡＳサー\nビス要求）が「ＵＥ」から「ＮＡＳ」によって「ｅＮＢ」を経て「ＭＭＥ」\nへ送信され，「ＭＭＥ」がこれを受信することが記載されており，また，\n「ＮＡＳサービス要求」にパケットにシーケンス番号（アップリンクシー\nケンス番号）（「ＮＡＳ＿Ｕ＿ＳＥＱ」）が含まれることが自明であるこ\nとは，前記２(1)認定のとおりである。\n以上によれば，引用刊行物１に接した当業者は，第５原則第２文の「ｅ\nＮＢ鍵の生成のために」使用される「シーケンス番号」は，ＵＥ及びＭＭ\nＥ間の「ＮＡＳ」のサブレイヤ（レベル）で送信又は受信されるパケット\nに含まれるシーケンス番号であることを理解し，そのようなシーケンス番\n号の中から，引用刊行物１記載の「ＮＡＳサービスリクエスト」（ＮＡＳ\nサービス要求）に含まれるアップリンクシーケンス番号（「ＮＡＳ＿Ｕ＿\nＳＥＱ」）を選択し，これを引用発明に採用することを容易に想到するこ\nとができたものと認められる。\nイ  原告は，この点に関し，本件審決は，本願発明と引用発明との相違点は\n格別のものではないと判断したが，その判断に際し，本願発明がＮＡＳア\nップリンクシーケンス番号ＮＡＳ＿Ｕ＿ＳＥＱを採用して，セキュリティ\nキーＫ＿ｅＮＢを生成するため，ＮＡＳダウンリンクシーケンス番号ＮＡ\nＳ＿Ｄ＿ＳＥＱ等の別個のシーケンス番号が不要であり，特別な複雑さを\n回避することができるという顕著な効果を奏することを考慮していないか\nら，上記判断は誤りである旨主張する。\nしかしながら，前記ア認定のとおり，引用刊行物１に接した当業者であ\nれば，引用発明において，「ｅＮＢ鍵の生成のために」使用される「シー\nケンス番号」としてＮＡＳアップリンクシーケンス番号ＮＡＳ＿Ｕ＿ＳＥ\nＱの構成を採用することを容易に想到することができたものと認められ，\nこの場合に，「ユーザ装置（１１）ＵＥと前記ＵＥにサービスするｅＮｏ\nｄｅＢ（１２）との間のＲＲＣ／ＵＰトラフィックを保護するため」の「\nセキュリティキーＫ＿ｅＮＢ」の「確立」のために，ＮＡＳダウンリンク\nシーケンス番号ＮＡＳ＿Ｄ＿ＳＥＱ等の別個のシーケンス番号」を必要と\nしないことは，上記構成を採用したことによる予想どおりの効果にすぎな\nいものであり，格別なものではない。\nしたがって，原告の上記主張は，理由がない。\n(2)  以上によれば，引用刊行物１に基づいて相違点に係る本願発明の構成を容\n易に想到することができたものと認められるから，本願発明と引用発明との相\n違点は格別のものではないとした本件審決における相違点の容易想到性の判\n断は，結論において誤りはない。\nしたがって，原告主張の取消事由３は理由がない。\n４  結論\n以上の次第であるから，原告主張の取消事由はいずれも理由がなく，本件審\n決にこれを取り消すべき違法は認められない。\nしたがって，原告の請求は棄却されるべきものである。\n知的財産高等裁判所第４部\n裁判長裁判官      富田善範\n裁判官      大鷹一郎\n裁判官      鈴   木   わかな\n（別紙）         本願明細書図面\n【図１】\n【図２】\n（別紙１）\n【図３】\n【図６ａ】              【図６ｂ】\n（別紙１）\nＦｉｇｕｒｅ ４\n（図４）\nＦｉｇｕｒｅ ４．３．２\n（図４．３．２）\nＦｉｇｕｒｅ １４．１－１\n（図１４．１－１）\nＦｉｇｕｒｅ １９．２．２．３\n（図１９．２．２．３）\n（訳文）\n（別紙２）\nＦｉｇｕｒｅ ６．２．２．\n（図６．２．２）\n（別紙３）\n【図１】\n【図５】\n【図６】\n（別紙４）\n第４図\n（別紙５）\nＦＩＧ ３Ａ\n（図３Ａ）\n"
}