{
  "trial_type": "IPCase",
  "date": {
    "era": "Heisei",
    "year": 29,
    "month": 6,
    "day": 14
  },
  "case_number": "平成28(行ケ)10071",
  "case_name": "審決取消請求事件",
  "court_name": "知的財産高等裁判所",
  "right_type": "特許権",
  "lawsuit_type": "行政訴訟",
  "lawsuit_id": "86846",
  "detail_page_link": "https://www.courts.go.jp/app/hanrei_jp/detail7?id=86846",
  "full_pdf_link": "https://www.courts.go.jp/app/files/hanrei_jp/846/086846_hanrei.pdf",
  "contents": "平成２９年６月１４日判決言渡\n平成２８年（行ケ）第１００７１号  審決取消請求事件\n口頭弁論終結の日  平成２９年４月１２日\n判                決\n原 告      エンカレッジ・テクノロジ株式会社\n同訴訟代理人弁理士      谷川英 和\n同                      森本悟 道\n被 告      特 許 庁 長 官\n同指定 代理 人     辻本泰 隆\n同                      高 木   進\n同                      野崎大 進\n同                      板 谷玲 子\n主                文\n１  特許庁が不服２０１４－１１２７８号事件について平成２８\n年２月８日にした審決を取り消す。\n２  訴訟費用は被告の負担とする。\n事実及び理 由\n第１  請求\n主文同旨\n第２  前提事実（いずれも当事者間に争いがない。）\n１  特許庁における手続の経緯等\n原告は，発明の名称を「機密管理装置，機密管理方法，及びプログラム」と\nする発明について，平成２２年１１月１７日に特許出願をしたが（特願２０１\n０－２５６７３４号。以下「本願」という。），平成２６年３月１９日付け拒\n絶査定を受けたことから，特許庁に対し，同年６月１３日，拒絶査定不服審判\nを請求した。特許庁は，当該請求を不服２０１４－１１２７８号事件として審\n理をした上，平成２８年２月８日，「本件審判の請求は，成り立たない。」旨\nの審決をした（以下「本件審決」という。）。その謄本は，同月１８日，原告\nに送達された。\n原告は，同年３月１７日，本件訴えを提起した。\n２  特許請求の範囲\n本願の請求項１～５に係る発明は，平成２５年１０月２２日付け手続補正書\n（甲５）により補正された特許請求の範囲の請求項１～５記載のとおりのもの\nであるところ，その請求項１に係る発明（以下「本願発明」という。また，本\n願発明に係る明細書（特開２０１２－１０８７０４号公報（別紙）。甲４）を\n「本願明細書」という。）は，以下のとおりのものである。\n【請求項１】\n機密事項を扱うアプリケーションを識別する機密識別子が記憶される機密識\n別子記憶部と，\nシステムコールの監視において，実行部がアプリケーションを実行中に行う\n送信処理に応じたシステムコールをフックし，当該アプリケーションが，前\n記機密識別子記憶部で記憶されている機密識別子で識別されるアプリケーシ\nョンであり，送信先がローカル以外である場合に，当該フックしたシステム\nコールを破棄することによって当該送信を阻止し，そうでない場合に，当該\nフックしたシステムコールを開放する送信制御部と，を備えた機密管理装置。\n３  本件審決の理由の要旨\n本件審決の理由は，別紙審決書（写し）記載のとおりであるが，要するに，\n本願発明は，以下のとおり，本願の出願前に頒布された甲１（特開２００９－\n２１７４３３号公報。以下「引用例１」という。）に記載された発明（以下\n「引用発明」という。）並びに当該技術分野の周知技術及び常とう手段に基づ\nいて当業者が容易に発明することができたものであり，特許法（以下「法」と\nいう。）２９条２項により特許を受けることができないものであるから，その\n余の請求項に係る発明について検討するまでもなく，本願は拒絶すべきもので\nある，というものである。\n(1)  引用発明\nアプリケーションの処理手段がアプリケーションを実行中に，処理対象\nとなるファイルに対する送信を含む処理の指令を取得する第１の手段と，\n前記第１の手段で取得された指令で特定される処理の内容に応じて，Ｏ\nＳに処理を渡す前にファイルに保護を施すか否かの判断を含む前記処理の内\n容に応じたファイルの保護方法を求め，その保護方法により前記処理対象と\nなるファイルの保護処理を行う第２の手段と，\n前記第２の手段は，前記第１の手段で取得された指令に関するファイル\nの入力元のアプリケーションの識別子とファイルの出力先となる記憶領域と\nに応じて，保護方法データベースによりファイルの保護方法を求め，その保\n護方法は，ファイルの出力先となる記憶領域の安全性が低い場合は処理を禁\n止することを含むものである，\nを備えることを特徴とするファイル管理装置。\n(2)  本願発明と引用発明との対比等\nア(ｱ)  引用発明では，「保護方法データベース」により，「第１の手段で\n取得された指令に関するファイルの入力元のアプリケーションの識別子\nとファイルの出力先となる記憶領域とに応じて，」「ファイルの保護」\nを行うところ，「保護方法データベース」に記憶された「入力元のアプ\nリケーション」が保護対象データである「ファイル」を処理するのは自\n明であり，機密事項を保護対象データとして扱うことは当該技術分野の\n技術常識であることから，引用発明の「入力元のアプリケーション」，\n「識別子」はそれぞれ，本願発明の「機密事項を扱うアプリケーショ\nン」，「機密識別子」に相当するということができる。\nまた，引用発明の「保護方法データベース」に「入力元のアプリケー\nション」の「識別子」が記憶されていることは明らかであるから，引用\n発明の「保護方法データベース」は本願発明の「機密事項を扱うアプリ\nケーションを識別する機密識別子が記憶される機密識別子記憶部」に相\n当する。\n(ｲ)  引用発明の「アプリケーション処理手段」，「処理の指令」，「フ\nァイル管理装置」はそれぞれ，本願発明の「実行部」，「システムコ\nール」，「機密管理装置」に相当する。\nまた，引用発明の「第２の手段」と本願発明の「送信制御部」とは，\n後記の点で相違するものの，“実行部がアプリケーションを実行中にフ\nァイルに対する送信処理に係るシステムコールを検知し，当該アプリケ\nーションが，前記機密識別子記憶部で記憶されている機密識別子で識別\nされるアプリケーションである場合に，ファイルの送信先に応じて送信\nを阻止するか否かを決定する制御部”である点で共通する。\nイ  一致点\n機密事項を扱うアプリケーションを識別する機密識別子が記憶される\n機密識別子記憶部と，\n実行部がアプリケーションを実行中にファイルに対する送信処理に係\nるシステムコールを検知し，当該アプリケーションが，前記機密識別子\n記憶部で記憶されている機密識別子で識別されるアプリケーションであ\nる場合に，ファイルの送信先に応じて送信を阻止するか否かを決定する\n制御部と\nを備える機密管理装置。\nウ  相違点１\nファイル送信の阻止の条件に関し，本願発明では「アプリケーション\nが，前記機密識別子記憶部で記憶され」ているほかに，フックした「送\n信処理に応じたシステムコール」の「送信先がローカル以外である場合」\nが条件であるのに対して，引用発明では，ファイルの送信に係る「取得\nされた指令に関するファイルの入力元のアプリケーションの識別子とフ\nァイルの出力先となる記憶領域」とが「保護方法データベース」に記憶\nされているほかに，「ファイルの出力先となる記憶領域の安全性が低い\n場合」が条件である点。\nエ  相違点２\nファイル送信の阻止に伴う制御に関し，本願発明では「当該フックし\nたシステムコールを破棄することによって当該送信を阻止し，そうでな\nい場合に，当該フックしたシステムコールを開放する」のに対して，引\n用発明では，「ファイルの出力」に係る「処理を禁止する」ための制御\nの詳細について言及されていない点。\nオ  判断\n(ｱ)  相違点１について\n引用発明のごときファイル管理装置において，アプリケーションのフ\nァイルに対するいかなる処理の指令につきいかなるファイル保護処理を\n対応付けるかは，要求されるシステムの安全性と必要なシステム負荷等\nの相関関係等に基づき決定されるべき事項であり，当業者であれば適宜\n設計し得た事項である。\nまた，甲２（特開２００９－２５８８５２号公報。以下「引用例２」\nという。）に記載されるように，ファイルを含むパケットについて，内\n部ネットワークから外部ネットワークへの持出しを判断し，送信先に応\nじて許可／禁止を判定すること，すなわち，内部ネットワーク（ローカ\nル）以外への送信の安全性が低いとしてセキュリティ対策を施すことは，\n本願出願前には当該技術分野の周知の事項であった。さらに，甲３（特\n開２００２－２８８０３０号公報。以下「参考文献」という。）に記載\nされるように，機密ファイルをあるアプリケーションプログラムが開い\nた後は，電子メール等によって当該アプリケーションプログラムにより\n当該ファイルが機密情報保存用フォルダ（ローカル）以外に出力される\nことがないようにすることも，本願出願前には当該技術分野の周知技術\nであった。\nそうすると，引用発明において，引用例２等に記載の周知技術を適用\nし，ファイル送信の阻止の条件として，アプリケーションが，機密識別\n子記憶部に記憶されることのほかに，適宜，オペレーションシステム\n（ＯＳ）への処理要求に基づくファイルに対する処理が，ローカル以外\nへのファイル送信であった場合を条件とすること，すなわち，相違点１\nに係る構成とすることは，当業者が容易に想到し得たことである。\n(ｲ)  相違点２について\n引用発明では，「ファイルに対する送信を含む処理の指令」が「ファ\nイルの送信」の場合は，ＯＳに処理を渡す前にファイルに保護を施すこ\nとが読み取れる。\nそして，ＯＳに処理を渡す前に，「ファイルの出力」に係る「処理を\n禁止する」ための制御として，ＯＳへの処理要求を破棄することは，当\n該技術分野における常とう手段である。\nそうすると，引用発明において，ファイルの出力に係る処理の制御の\nために上記常とう手段を適用し，適宜，ファイルの出力に係る処理を禁\n止する場合はＯＳへの処理要求を破棄し，当該処理を禁止しない場合に\nはＯＳへの処理要求を開放すること，すなわち，相違点２に係る構成と\nすることは，当業者が容易に想到し得たことである。\n第３  当事者の主張\n１  原告の主張\n(1)  原告の主張する取消事由は，概略以下のとおりである。\nア  取消事由１（引用発明の認定の誤り）\n(ｱ)  取消事由１－１（送信の指令に関する引用発明の認定の誤り）\n(ｲ)  取消事由１－２（保護方法に関する引用発明の認定の誤り）\n（なお，取消事由１－１及び１－２は，原告の平成２８年４月２６日付\nけ準備書面において「取消事由１」として主張されているものであるが，\n便宜上，上記のとおり別個の取消事由とする。）\nイ  取消事由２（一致点の認定の誤り及び相違点の看過）\n(ｱ)  取消事由２－１（本件審決は，引用発明の保護方法データベースに\n含まれる各アプリケーションの識別子が，本願発明の機密識別子記憶\n部で記憶されている機密識別子に相当する旨認定したものと理解した\n場合。なお，原告の平成２８年４月２６日付け準備書面において「取\n消事由２」として主張されているものであるが，便宜上「取消事由２\n－１」とする。）\n(ｲ)  取消事由２－２（本件審決は，引用発明の保護方法データベースに\n含まれる最高レベルの安全性に対応するアプリケーションの識別子が，\n本願発明の機密識別子記憶部で記憶されている機密識別子に相当する\n旨認定したものと理解した場合。なお，原告の平成２８年１１月２８\n日付け準備書面（第５回）において「取消事由４」として主張されて\nいるものであるが，便宜上「取消事由２－２」とする。）\nウ  取消事由３（相違点の認定の誤り及び相違点に係る容易想到性判断の誤\nり）\n(2)  取消事由１－１（送信の指令に関する引用発明の認定の誤り）\nア  本件審決の認定に係る引用発明には，第２の手段が，第１の手段で取得\nされたファイルの送信の指令に関する入力元のアプリケーションの識別\n子と出力先となる記憶領域とに応じてファイルの保護方法を求める構成\nが含まれる。このことは，ファイルの送信の指令に入力元のアプリケー\nションの識別子と出力先となる記憶領域とが含まれており，それらを抽\n出できることを前提とする。\nしかし，引用例１の記載等によれば，引用発明の送信の指令はアプリ\nケーションの識別子の引数を取らないと解されることから，ファイルの\n送信の指令から入力元のアプリケーションの識別子を抽出することはで\nきない。すなわち，引用発明においては，第１の手段がファイルの送信\nの指令を取得した場合，第２の手段が，第１の手段で取得されたファイ\nルの送信の指令から入力元のアプリケーションの識別子を抽出すること\nはできないことから，取得されたファイルの送信の指令に関する入力元\nのアプリケーションの識別子と出力先となる記憶領域とに応じてファイ\nルの保護処理を求めることができない。このため，この場合，第２の手\n段は，取得されたファイルの送信の指令に関して，ファイルの出力先と\nなる記憶領域の安全性が低い場合に送信の処理を禁止することもできな\nいことになる。\nこのように，引用発明においては，取得されたファイルの送信の指令\nから入力元のアプリケーションの識別子を抽出することはできないとこ\nろ，本件審決はその抽出ができるとした点で誤りがある。\nイ  本願発明は，送信処理に応じたアプリケーションが機密識別子で識別さ\nれるアプリケーション（以下「機密アプリケーション」という。また，\n引用発明について論ずるに当たり，これに相当するものとの趣旨でこの\n語を用いることもある。）であり，送信先がローカル以外である場合に，\nその送信を阻止するのに対し，引用発明は，上記のとおり，ファイルの\n送信の指令に関し，その送信を禁止することができないという相違点が\nある。また，この相違点に係る本願発明の構成について，引用例２及び\n参考文献に各記載の技術的事項から当業者が容易に想到することはでき\nない。\nしたがって，上記送信の指令に関する引用発明の認定の誤りは，本件\n審決の結論に影響を及ぼす。\n(3)  取消事由１－２（保護方法に関する引用発明の認定の誤り）\nア  仮に，上記送信の指令に関する引用発明の認定の誤りがなかったとして\nも，本件審決には，保護方法に関する引用発明の認定の誤りがある。\nすなわち，本件審決は，引用発明における保護方法として「ファイル\nの出力先となる記憶領域の安全性が低い場合は処理を禁止することを含\nむ」ことを認定しているが，引用発明については，それだけでなく，第\n１の手段で取得された指令に係るファイルの出力先となる記憶領域に応\nじた安全性が，入力元のアプリケーションの識別子に応じた安全性より\n高い場合に第２の手段が求める保護方法（ファイルの入力元となるアプ\nリケーションの識別子の安全性に対応する保護処理）も含めて認定すべ\nきであるのに，これを行っていない点で誤りがある。\nイ  本願発明は，実行部がアプリケーションを実行中に行う送信処理に応じ\nたシステムコールをフックし，当該アプリケーションが機密アプリケー\nションであり，送信先がローカル以外でない場合に，当該フックしたシ\nステムコールを開放するのに対し，引用発明は，上記のとおり，ファイ\nルの出力先となる記憶領域の安全性が高い場合であっても，入力元とな\nるアプリケーションの識別子の安全性に対応する保護処理を行うという\n相違点がある。また，この相違点に係る本願発明の構成について，引用\n例２及び参考文献に各記載の技術的事項から当業者が容易に想到するこ\nとはできない。\nしたがって，上記保護方法に関する引用発明の認定の誤りは，本件審\n決の結論に影響を及ぼす。\n(4)  取消事由２（一致点の認定の誤り及び相違点の看過）\nア  本件審決は，引用発明の保護方法データベースに含まれる各アプリケー\nションの識別子が，本願発明の機密識別子記憶部で記憶されている機密\n識別子に相当する旨認定しているものと理解されるが，被告は，本件審\n決につき，引用発明の保護方法データベースに含まれる最高レベルの安\n全性に対応するアプリケーション（以下「最安全アプリケーション」と\nいう。）の識別子が，本願発明の機密識別子記憶部で記憶されている機\n密識別子に相当する旨認定したものである旨主張する。\nしかし，そのいずれと理解したとしても，本件審決には一致点の認定\nの誤り及び相違点の看過があり，この誤りは結論に影響を及ぼす。以下，\n本件審決の理解に応じて場合を分けて論ずるが，これらに共通する趣旨\nは，本件審決は，本願発明の機密識別子の作用ないし機能と引用発明の\n識別子の作用ないし機能が相違すること，すなわち，本願発明の「機密\n識別子」は「機密事項を扱うアプリケーションを識別する」ものである\nのに対し，引用発明における「アプリケーションの識別子」は必ずしも\n機密事項を扱うアプリケーションを識別するものではなく，ファイルの\n保護方法を求める上で必要となる安全性の程度（例えば，数値）を得る\n前提として，入力元のアプリケーションを識別するものであることを看\n過したというものである。\nイ  取消事由２－１（一致点の認定の誤り及び相違点の看過：本件審決につ\nき，引用発明の保護方法データベースに含まれる各アプリケーションの\n識別子が，本願発明の機密識別子記憶部で記憶されている機密識別子に\n相当する旨認定したものと理解した場合）\n(ｱ)ａ  本件審決は，引用発明の保護方法データベースに含まれる各アプ\nリケーションの識別子は，本願発明の機密識別子記憶部で記憶されて\nいる機密識別子に相当し，引用発明のアプリケーションの識別子を記\n憶する「保護方法データベース」は，本願発明の機密識別子が記憶さ\nれている機密識別子記憶部に相当する旨認定しているところ，以下の\nとおり，この点に関する本件審決の認定には誤りがある。\nｂ  引用例１の記載によれば，引用発明の保護方法データベースには，\n原則として全てのアプリケーションの識別子が含まれていると解され\nることから，実質的な保護処理を行わないアプリケーションの識別子\nも保護方法データベースに含まれることになる。また，保護処理が，\n引用発明の「ファイルの出力先となる記憶領域の安全性が低い場合は\n処理を禁止すること」であるとしても，安全性の最低の値に対応する\nアプリケーションについては，ファイルの出力先となる記憶領域の安\n全性がそのアプリケーションの識別子に対応する安全性よりも低くな\nることはないから，処理を禁止する保護処理は行われないことになる。\nこのように，引用発明の保護方法データベースには実質的な保護\n処理を行わないアプリケーションの識別子も含まれ，また，保護方法\nデータベースに記憶された識別子により識別されるアプリケーション\nが処理を行う対象であるファイルが保護対象データであるとは限られ\nない。\nその結果，機密事項を保護対象データとして扱うことが技術常識\nであったとしても，保護方法データベースには機密事項を扱わないア\nプリケーションの識別子も含まれるため，引用発明の保護方法データ\nベースは，本願発明の機密識別子記憶部とは異なることになる。すな\nわち，本願発明の機密識別子記憶部では，機密アプリケーションを識\n別する機密識別子が記憶されるのに対し，引用発明の保護方法データ\nベースでは，機密事項を扱わないアプリケーションの識別子も記憶さ\nれるという相違点（以下「相違点Ａ」という。）が存在する。\nしたがって，引用発明の保護方法データベースが本願発明の機密\n識別子記憶部に相当するとして一致点を認定し，相違点Ａを看過した\n本件審決には誤りがある。\n(ｲ)  上記のとおり，本願発明と引用発明には相違点Ａが存在するところ，\n引用発明から，当該相違点に係る本願発明の構成に到達するためには，\n引用発明の保護方法データベースにおいて，実質的な保護処理を行わ\nないアプリケーションを識別する識別子を除外する必要がある。\nしかし，引用発明は「データの取得先や出力先に応じてデータの保護\n方法を変更したり，データを使用するアプリケーション毎にデータの保\n護方法を変更したりして，柔軟にデータを保護すること」（引用例１\n【０００８】）を課題としているため，保護方法データベースに種々の\nアプリケーションの識別子が存在することは引用発明の課題解決手段と\nして必須の構成というべきである。そうすると，引用発明の保護方法デ\nータベースにおいて特定のアプリケーションの識別子のみが記憶される\nように限定することには，引用発明の課題を解決する観点から阻害要因\nがあるということができる。\nこのため，相違点Ａについて，引用発明から出発して本願発明に容易\nに想到可能であるということはできないから，上記一致点の認定の誤り\n及び相違点Ａの看過は，本件審決の結論に影響を及ぼす。\nウ  取消事由２－２（一致点の認定の誤り及び相違点の看過：本件審決につ\nき，引用発明の保護方法データベースに含まれる最高レベルの安全性に\n対応するアプリケーションの識別子が，本願発明の機密識別子記憶部で\n記憶されている機密識別子に相当する旨認定したものと理解した場合）\n(ｱ)  本願発明において，送信が阻止される条件としては，送信処理を行\nうアプリケーションが，機密識別子記憶部で記憶されている機密識別\n子で識別されるアプリケーションであるという部分条件（以下「第１\n部分条件」という。）と，送信先がローカル以外であるという部分条\n件とが存在する。本件審決は，「実行部がアプリケーションを実行中\nにファイルに対する送信処理に係るシステムコールを検知し，当該ア\nプリケーションが，前記機密識別子記憶部で記憶されている機密識別\n子で識別されるアプリケーションである場合に，ファイルの送信先に\n応じて送信を阻止するか否かを決定する制御部」を一致点と認定して\nいることから，第１部分条件は一致点に含まれる。\n他方，引用発明においては，送信の指令における入力元のアプリケー\nションが最安全アプリケーションであることは，送信阻止に関するアプ\nリケーションの条件ではない。すなわち，引用発明では，送信の指令に\n含まれる入力元のアプリケーションの識別子に対応する安全性が出力先\nの記憶領域に対応する安全性よりも高い場合に送信が阻止される。この\nため，引用発明における送信阻止に関するアプリケーションの条件は，\n入力元のアプリケーションの識別子に対応する安全性が出力先の記憶領\n域に対応する安全性よりも高いことという相対的なものとなる。そうす\nると，送信の指令に含まれる入力元のアプリケーションが最安全アプリ\nケーションであれば，出力先の記憶領域の安全性に応じて送信が阻止さ\nれ得ることになるが，引用発明において安全性のレベルは３段階以上存\n在すると考えられるところ，送信の指令に含まれる入力元のアプリケー\nションに対応する安全性が２番目に高い場合にも，出力先の記憶領域の\n安全性に応じて送信が阻止され得ることになる。これは，引用発明にお\nいて，入力元のアプリケーションが最安全アプリケーションであること\nは送信阻止に関するアプリケーションの条件ではないことを意味する。\nしたがって，本願発明の第１部分条件は一致点ではなく，「送信阻止\nに関するアプリケーションの条件が，本願発明では，送信処理を行うア\nプリケーションが機密識別子記憶部で記憶されている機密識別子で識別\nされるアプリケーションであること（第１部分条件）であるのに対し，\n引用発明では，送信の指令に含まれる入力元のアプリケーションの識別\n子に対応する安全性が出力先の記憶領域に対応する安全性よりも高いこ\nと」という相違点（以下「相違点Ｂ」という。）が存在することとなる。\n(ｲ)  この相違点Ｂの看過は，本件審決の結論に影響を及ぼす。\nすなわち，前記のとおり，引用発明は，処理内容の入力元の安全性と\n出力先の安全性との相対的な高低関係に応じて保護方法を決定するとい\nう特徴を有しており，その結果，送信阻止に関するアプリケーションの\n部分条件も相対的なものとなっている。その相対的な部分条件を絶対的\nなものに変更することは，引用発明の上記特徴を喪失させることになる。\nこのため，引用発明において本願発明の相違点Ｂに係る構成を採用する\nことには阻害要因があり，引用発明から出発して本願発明の相違点Ｂに\n係る構成に到達するための論理付けを行うことはできないし，これを可\n能とする従来技術も周知技術も示されていない。\nそうすると，本願発明の相違点Ｂに係る構成については，引用発明か\nら出発して当業者が容易に想到可能であるということはできない。\nしたがって，本件審決には，一致点の認定の誤り及び相違点Ｂの看過\nがあり，これは本件審決の結論に影響を及ぼす。\n(5)  取消事由３（相違点の認定の誤り及び相違点に係る容易想到性判断の誤\nり）\nア(ｱ)  本件審決は，以下のとおり，ファイル送信が阻止されない条件に関\nする相違点を含めずに相違点１を認定した点で誤りがある。\n(ｲ)  本願発明は，機密アプリケーションの実行中に行われた，送信先が\nローカル以外である送信を阻止し，送信先がローカルである送信を阻\n止しないものである。また，本願発明では，機密アプリケーションで\nないアプリケーション（以下「非機密アプリケーション」という。）\nの実行中に行われた送信は，送信先がローカルでもローカル以外でも\n阻止されないことになる。したがって，本願発明においてアプリケー\nションによる送信が阻止されない条件は，送信を行ったアプリケーシ\nョンの識別子が機密識別子記憶部に記憶されていないこと， 又は，送\n信先がローカルであることである。\n他方，前記のとおり，引用発明の保護方法データベースに含まれるア\nプリケーションの識別子には，処理の禁止等の実質的な保護処理を行わ\nないアプリケーションのものも含まれると解されることから，引用発明\nにおいてファイル送信が阻止される条件は，入力元であるアプリケーシ\nョンの識別子の安全性よりも出力先である記憶領域の安全性の方が低い\nことであり，送信が阻止されない条件は，入力元であるアプリケーショ\nンの識別子の安全性よりも出力先である記憶領域の安全性の方が低くな\nいことである。\nしたがって，本願発明と引用発明とは，本願発明では，送信が阻止さ\nれる条件が，アプリケーションの識別子が機密識別子記憶部で記憶され\nており，かつ，送信先がローカル以外であることであり，阻止されない\n条件が，アプリケーションの識別子が機密識別子記憶部で記憶されてい\nないこと，又は，送信先がローカルであることであるのに対し，引用発\n明では，ファイル送信が阻止される条件が，入力元であるアプリケーシ\nョンの識別子の安全性よりも出力先である記憶領域の安全性の方が低い\nことであり，阻止されない条件が，入力元であるアプリケーションの識\n別子の安全性よりも出力先である記憶領域の安全性の方が低くないこと\nであるという相違点（以下「相違点Ｃ」という。）があり，相違点１は，\n正しくは相違点Ｃのように認定されるべきである。また，このことは，\n仮に取消事由２－１として主張した一致点の認定の誤り及び相違点の看\n過がなかったとしても異ならない。\nイ(ｱ)  前記のとおり，引用発明の保護方法データベースには，原則として，\n実行され得る全てのアプリケーションの識別子が含まれると解されるた\nめ，非機密アプリケーションの識別子も保護方法データベースに含まれ\nている。\n引用発明においては，ファイルの入力元の安全性が高いほど低い程度\nの保護処理を行えばよく，安全性が低いほどより厳重な保護処理を行う\n必要がある。このため，引用発明において，本願発明と同様に，機密ア\nプリケーションによるローカル以外への送信が禁止され，非機密アプリ\nケーションによるローカル以外への送信が少なくとも禁止されないよう\nにするためには，非機密アプリケーションの安全性を機密アプリケーシ\nョンの安全性よりも低く設定しなければならないことになる。このこと\nは，機密事項を扱わないアプリケーションに対する保護方法が，機密事\n項を扱うアプリケーションに対する保護方法よりも厳重でなくてはなら\nないことを意味しており，引用発明の属する技術分野における技術常識\nに反する。\nしたがって，引用発明において，本願発明と同様の保護処理が行われ\nるように安全性を設定することには阻害要因があるから，相違点Ｃに係\nる本願発明の構成は，引用発明において当業者が適宜設計し得たもので\nはない。\n(ｲ)  仮に，引用発明の保護方法データベースに，実行され得る全てのア\nプリケーションの識別子が含まれているのではないとしても，相違点\nＣに係る本願発明の構成が，引用発明において当業者が適宜設計し得\nたものでないことは異ならない。\nすなわち，引用発明では，保護方法データベースに含まれないアプリ\nケーションの識別子や記憶領域については，最も高い安全性を用いて保\n護方法を求めることになると解される。他方，機密アプリケーションに\nよるローカル以外への送信が禁止されるように機密アプリケーションの\n安全性とローカル以外の記憶領域の安全性とが設定されている場合，ロ\nーカル以外の記憶領域の安全性は，少なくとも，最も高い安全性ではな\nいことになる。そうすると，非機密アプリケーションによるローカル以\n外へのファイル送信も機密アプリケーションによるものと同様に阻止さ\nれることになり，非機密アプリケーションのローカル以外へのファイル\n送信が阻止されない本願発明の構成とは異なるものになる。\nこのように，仮に，引用発明の保護方法データベースに，実行され得\nる全てのアプリケーションの識別子が含まれているのではないとしても，\n当業者が，引用発明から相違点Ｃに係る本願発明の構成に想到すること\nはできない。\nウ(ｱ)  引用例２に記載された技術は，送信先のＩＰアドレス等をチェック\nすることによって，クライアントからの送信情報の持出しの可否につい\nて判定し，不可と判定された場合に通信を遮断するものである。この技\n術は，ネットワーク上において上記処理を行うものであり，クライアン\nトＰＣにおいて用いられるものではなく，情報漏えいを防止するための\n処理をネットワーク以外のローカルの装置等において実行するように変\n更することは，当該技術の目的に反することになる。\nまた，当該技術は，パケットのＩＰアドレス，パケットのポート番号，\nパケットに含まれるキーワード及びファイルのサイズの少なくとも１つ\nを用いて判定を行うため，送信先のＩＰアドレス等がわからなければ，\n送信情報の持出しの可否判定を行うことができない。このため，指令か\nらＩＰアドレスを取得しない引用発明に，ＩＰアドレスを用いて情報漏\nえいの防止を行う引用例２記載の技術的事項を適用することはできない。\n(ｲ)  参考文献に記載された技術は，あらかじめ定められた機密情報保存\n用フォルダに保存されているファイルの内容が当該フォルダ以外に出\n力されないように制限するものであり，当該フォルダは，ローカルの\n全てのフォルダではなく，一部のフォルダである。したがって，当該\n技術は，ローカルにおける複数のフォルダのうち特定のフォルダに保\n存されているファイルのみを保護するものである。\nこのため，引用発明に当該技術を適用した場合，ローカルの特定のフ\nォルダに関する持出しの処理が制限されるだけであり，他のフォルダに\n保存されているファイルについては制限されないことになるから，引用\n発明に参考文献記載の技術的事項を適用することにより，機密アプリケ\nーションによるローカル以外への送信を全て阻止することができる本願\n発明に想到することはできない。\n(ｳ)  引用発明は，指令に含まれるアプリケーションの識別子や記憶領域\nに対応する安全性を用いた保護処理を行うことによってその課題を解\n決していると解されることから，安全性を用いて保護処理を行うこと\nを必須の構成とするものであって，引用発明に引用例２及び参考文献\nに各記載の技術的事項を適用し，安全性を用いないで保護処理を行う\nようにすることには阻害要因がある。\nエ  以上のとおり，相違点Ｃに係る本願発明の構成は，引用発明において当\n業者が適宜設計し得た事項ではなく，また，引用発明に引用例２及び参\n考文献に各記載の技術的事項を適用することによって，相違点Ｃに係る\n本願発明の構成に容易に想到することもできない。\nしたがって，本件審決には容易想到性の判断に誤りがあり，その誤り\nは本件審決の結論に影響を及ぼす。\n２  被告の主張\n(1)  取消事由１－１（送信の指令に関する引用発明の認定の誤り）について\nア  本件審決の認定した引用発明の内容\n(ｱ)  本件審決の認定した引用発明\n引用例１の【００７７】には，「＜変形例３＞  上記の実施の形態で\nは，出力先の安全性に応じて保護方法を決定したが，処理内容から入力\n元の記憶領域または識別子と出力先の記憶領域または識別子とを抽出し，\n入力元の安全性と出力先の安全性から，処理方法を決定するようにして\nもよい。」（以下「変形例３」という。）と記載されている。この変形\n例３においてのみ，「出力先の安全性」に加え「入力元の安全性」にも\n応じて「保護方法」が決定されるものとなっており，かつ，①入力元と\n出力先が同じ安全性であることから再度保護処理を行わずそのままファ\nイルの複写を行う態様，②入力元よりも出力先の安全性が低い場合に処\n理を禁止する態様，③入力元よりも出力先の安全性が高い場合には入力\n元の安全性に従った保護処理を施し，元の保護よりも弱い保護にはしな\nいようにする態様，が例示されている（以下，各態様を「態様①」のよ\nうにいう。）。態様①～③は，設定された安全性に基づく情報の保護の\n方法ないし程度が異なっており，例えば態様②は，出力禁止となってい\nない出力先に対する出力であっても場合によっては禁止するものであり，\n「元の保護よりも弱い保護にはしないようにする」という態様③よりも\nより積極的に保護を行うものとなっている。\n本件審決は，このような引用例１の記載のうち，態様②に係る箇所の\n記載を踏まえ，ファイルの入力元よりも出力先の安全性が低い場合に処\n理を禁止し，それ以外の場合には処理を禁止しないものを引用発明とし\nて認定したものである。\n(ｲ)  引用発明における「安全性」\n引用例１の記載によれば，「安全性」はデータに対する指令の処理内\n容に含まれる入力元又は出力先の記憶領域やアプリケーションに対して\n数値レベルで設定される。この数値レベルは，情報セキュリティ上の信\n頼の度合いを数値化し，どのような保護を適用するかを特定する際に用\nいられるものであり，一般に「セキュリティレベル」と呼ばれ，データ\nやリソース等のセキュリティレベル（安全性）の高さが機密性の高さと\n相関することは周知の事項である。\nもっとも，変形例３の態様①～③においては，引用例１記載の他の実\n施の形態と異なり，「保護方法」は「安全性」の具体的な数値の値では\nなく「入力元の安全性」と「出力先の安全性」との関係に対応するので\nあって，「安全性」の具体的な数値の値が「保護方法」に対応するわけ\nではない。引用発明は，前記のとおり，変形例３の３つの態様のうち態\n様②を踏まえて認定されたものであり，「入力元の安全性」と「出力先\nの安全性」との関係に応じて所定の保護方法が適用され，ファイルの入\n力元のアプリケーションの安全性よりその出力先となる記憶領域の安全\n性が低いという関係にある場合に処理を禁止し，そうでない場合には処\n理を禁止しないというものである。\n(ｳ)  引用発明の「第２の手段」\n引用例１の記載によれば，引用発明のファイル管理装置は，「取得さ\nれた指令で特定される処理の内容に応じて，ＯＳに処理を渡す前にファ\nイルに保護を施すか否かの判断を含む前記処理の内容に応じたファイル\nの保護方法を求め，その保護方法により前記処理対象となるファイルの\n保護処理を行う」ものであって，そのための「第２の手段」を備えるも\nのである。また，この「手段」によって「取得された指令で特定される\n処理の内容に応じたファイルの保護方法」を求めるに当たり，当該処理\n内容に含まれる「記憶領域」又は「アプリケーションを特定する識別子」\nが抽出される。さらに，「処理内容」に含まれる「記憶領域」又は「ア\nプリケーションを特定する識別子」に応じて「保護方法データベース」\nが参照され，ファイルの「保護方法」が求められる。\n加えて，前記【００７７】の記載によれば，態様①～③のいずれも，\n「取得された指令で特定される処理の内容」によっては，「指令」に関\nするファイルの「入力元」と「出力先」とに応じてファイルの「保護方\n法」を求める態様である旨が示されているところ，ここでの「入力元」\nと「出力先」としては，「記憶領域」又は「アプリケーションを特定す\nる識別子」のうちの任意の組合せがあり得，「入力元」を「アプリケー\nションの識別子」とし「出力先」を「記憶領域」とする組合せが含まれ\nていることは明らかである。そうすると，同記載からは「取得された指\n令で特定される処理の内容」により，ファイルの「入力元」の「アプリ\nケーションの識別子」とファイルの「出力先」となる「記憶領域」とに\n応じて，入力元よりも出力先の安全性が低い場合に処理を禁止する態様\nを読み取ることができる。\n以上を踏まえると，引用発明のファイル管理装置は，「取得された指\n令で特定される処理の内容に応じて，ＯＳに処理を渡す前にファイルに\n保護を施すか否かの判断を含む前記処理の内容に応じたファイルの保護\n方法を求め，その保護方法により前記処理対象となるファイルの保護処\n理を行う」に当たり，「取得された指令に関するファイルの入力元のア\nプリケーションの識別子とファイルの出力先となる記憶領域とに応じて，\n入力元よりも出力先の安全性が低い場合に処理を禁止する」ものであっ\nて，そのための「第２の手段」を備えるものである。本件審決も，同旨\nを述べて引用発明を認定しており，その認定に誤りはない。\nイ(ｱ)  引用例１の【００３８】には，「ステップＳ１２では，処理内容か\nら出力先の記憶領域または識別子を抽出する。…なお，記憶領域または\n識別子は処理内容に直接含まれている場合と処理内容に含まれる情報か\nら間接的に取得され る場合がある。例えば， ”read  c:¥word¥test.txt\nHANDLE”のような処理内容があり，HANDLE が読み先のメモリ領域を\n示す情報である場合，HANDLE から読み込み先のプロセスを特定する。\nあるいは処理命令の指示元のプロセスを読み込み先としてもよい。」と\nの記載がある。この記載は，「指令」に関する「ファイルの入力元のア\nプリケーションの識別子」と「ファイルの出力先となる記憶領域」を抽\n出する態様として，「指令」の「処理内容」にこれらが直接含まれる態\n様のほか，「指令」の「処理内容」に含まれる情報からこれらを間接的\nに取得する態様，「指令」の「処理命令」の指示元プロセスをこれらの\n読み込み先とする態様があることを前提としたものとなっている。\nしたがって，引用発明の構成として認定した「第１の手段で取得され\nた指令」に関する「ファイルの入力元のアプリケーションの識別子」と\n「ファイルの出力先となる記憶領域」は，「指令」に直接含まれるもの\nに限定されていない。\n(ｲ)  取消事由１－１に関する原告の主張は，「記憶領域または識別子」\nを「処理内容から」「抽出する」ことが「処理内容に直接含まれてい\nる」ものを抽出することであるという前提に立つものであるが，引用\n例１は上記(ｱ)のとおり，これと異なる前提に立つものである。\n(ｳ)  また，引用例１のファイル管理装置が処理する命令に「ファイルの\n送信（send）」が含まれている旨明示され，他方，変形例３の態様②を\n記載する前記【００７７】において「処理の内容」から「ファイルの\n入力元のアプリケーションの識別子」と「ファイルの出力先となる記\n憶領域」を抽出できる「指令」の種類が限定されることが示されてい\nるわけでもないことから，引用例１には，「ファイルに対する送信を\n含む処理」の「指令に関するファイルの入力元のアプリケーションの\n識別子とファイルの出力先となる記憶領域とに応じて，保護方法デー\nタベースによりファイルの保護方法を求め」ることが記載されている。\nウ  したがって，本件審決の引用発明の認定に誤りはない。原告の主張は引\n用例１の記載内容を誤解したものであり，失当である。\n(2)  取消事由１－２（保護方法に関する引用発明の認定の誤り）について\nア  原告は，ファイルの出力先となる記憶領域に応じた安全性が入力元のア\nプリケーションの識別子に応じた安全性より高い場合には入力元となる\nアプリケーションの識別子の安全性に対応する保護処理を行うものであ\nることも含めて，引用発明を認定すべきである旨主張する。\nイ  しかし，前記(1)アのとおり，本件審決は，引用例１の記載のうち変形\n例３の態様②に係る箇所の記載を踏まえて引用発明を認定したものであ\nり，態様③を認定したものではない。態様①～③は，設定された安全性\nに基づく情報の保護の方法ないし程度が異なっており，態様②は，出力\n禁止とされていない出力先に対する出力であっても場合によっては禁止\nするものである。他方，態様③は，「元の保護よりも弱い保護にはしな\nいようにする」ものとなっている。入力先の安全性よりも出力先の安全\n性が高い場合の処理として態様③以外の記載がないとしても，明示され\nなくとも，態様②において仮に入力元の安全性より出力先の安全性が同\nじか高い場合には処理が禁止されないようにすれば足りるのであり，こ\nの場合に何らかの保護方法を適用するか否かについて，引用例１は述べ\nていない。態様②と情報の保護の方法ないし程度が異なる態様①や③を\n組み合わせなければならない理由も見当たらない。\nウ  よって，原告の主張は，本件審決を正解しないものであり，また，引用\n例１の記載内容を誤解した根拠のない主張であって，失当である。\n(3)  取消事由２（一致点の認定の誤り及び相違点の看過）について\nア(ｱ)  本願特許の特許請求の範囲請求項１の記載によれば，本願発明の\n「機密識別子記憶部」については「機密事項を扱うアプリケーションを\n識別する機密識別子が記憶される」ものである旨が特定されているが，\n「機密事項を扱うアプリケーション」でない「アプリケーション」を識\n別する識別子を記憶しない旨を含め，どのような態様で「機密識別子」\nを「記憶」するかについては特定されていない。また，「機密識別子記\n憶部」に係る条件判断の内容も，「機密識別子記憶部」が「機密事項を\n扱うアプリケーション」でない「アプリケーション」を識別する識別子\nを記憶しないものであることを前提としたものにはなっておらず，「機\n密識別子記憶部」における「機密識別子」を「記憶」する態様がどのよ\nうなものであるかを示さない文言が用いられている。「当該フックした\nシステムコールを開放する」条件も，「そうでない場合」という包括的\nなものであり，「機密識別子」を「記憶」する態様がどのようなもので\nあるかを示すものではない。\nこれらの点を踏まえれば，本願発明においては，「機密識別子記憶部」\nが「機密識別子」でないものを記憶しているか否かは発明の構成と無関\n係の事情であり，例えば，全てのアプリケーションの識別子を記憶した\n上で，それらのうち「機密事項を扱うアプリケーション」であるか否か\nを別欄で示し，「機密事項を扱うアプリケーション」として記憶された\n「識別子」で識別されたアプリケーションであることを条件とする態様\nをも含んでいるということができる。\n(ｲ)  引用発明の「保護方法データベース」は，アプリケーションの識別\n子を前記「安全性」の情報とともに格納しているものであるところ，\n引用発明における「指令」に係るファイルの出力の「処理」を「禁止」\nするアプリケーション（「安全性」が最高レベルのアプリケーション\nすなわち最安全アプリケーション）とは，これより信頼度が相対的に\n低い出力先への送信処理を禁止すべきであるほどに信頼度の高いアプ\nリケーションである。一般に，機密情報の保護を目的として，不適切\nな送信先への機密情報の送信処理が禁止されるところ，送信処理の禁\n止という技術的な観点からは，送信処理が禁止された情報と機密情報\nとを区別することはできない。引用発明においても，信頼度が相対的\nに低い出力先への送信処理を禁止すべき情報は，送信処理が禁止され\nることによって機密情報として取り扱われているのであり，このよう\nな情報を「機密情報」（機密事項）とし，これを取り扱うことが予定\nされている信頼度の高いアプリケーションを「機密アプリケーション」\nと称することに問題はない。また，このような機密情報を扱う蓋然性\nの高いアプリケーションは，「安全性」が最高レベルであるから，保\n護方法データベースにおいて最高レベルの「安全性」が対応付けられ\nた「識別子」に基づき識別し得ることになる。\n他方，上記(ｱ)のとおり，本願発明の「機密識別子記憶部」は，全て\nのアプリケーションの識別子を記憶した上で，それらのうち「機密事項\nを扱うアプリケーション」であるか否かを別欄で示す態様を含み，また，\nここでいう「機密事項」も，「機密事項を扱うアプリケーション」によ\nり扱われることによって送信が阻止されてその漏えいが防止される事項\nを一般的に示すにすぎず，これと異なる技術的な定義が与えられている\nわけではない。\nそうすると，引用発明においても，機密情報を扱う「安全性」の最高\nレベルが対応付けられたアプリケーション（最安全アプリケーション）\nの「識別子」が本願発明の「機密識別子」に相当するとともに，そのよ\nうなアプリケーションの「識別子」が記憶される「保護方法データベー\nス」が，本願発明の「機密識別子記憶部」の上記態様に相当する。\n本件審決は，引用発明の「保護方法データベース」が本願発明の「機\n密識別子記憶部」に相当することを認定するに当たり，引用発明の「入\n力元のアプリケーション」が本願発明の「機密アプリケーション」に相\n当するといえる旨を示しているが，これは，前記のとおり，本願発明の\n「機密識別子記憶部」が「機密識別子」でないものを記憶しているか否\nかが発明の構成と無関係の事情であることを踏まえたものであり，最安\n全アプリケーションでないアプリケーションを含めて本願発明の機密ア\nプリケーションに相当する旨を示したものではない。すなわち，本件審\n決は，「識別子」が本願発明の「機密識別子」に相当する場合の引用発\n明の「入力元のアプリケーション」が本願発明の「機密事項を扱うアプ\nリケーション」に相当し，引用発明の「保護方法データベース」が本願\n発明の「機密識別子記憶部」に相当すると認定したものであり，その認\n定に誤りはない。\nイ  取消事由２－１（一致点の認定の誤り及び相違点Ａの看過）について\n原告は，本願発明の「機密識別子記憶部」では機密アプリケーション\nを識別する機密識別子が記憶されるのに対し，引用発明の保護方法デー\nタベースでは非機密アプリケーションの識別子も記憶されるという相違\n点Ａが存在する旨主張するが，上記アのとおり，本願発明の「機密識別\n子記憶部」は，全てのアプリケーションの識別子を記憶した上で，それ\nらのうち「機密事項を扱うアプリケーション」であるか否かを別欄で示\nす態様を含むことから，原告の主張する相違点Ａは存在しない。\nしたがって，原告の主張は失当である。\nウ  取消事由２－２（一致点の認定の誤り及び相違点Ｂの看過）について\n(ｱ)  本件審決は，非機密アプリケーションを含めて本願発明の「機密ア\nプリケーション」に相当するとするものではなく，本願発明が非機密\nアプリケーションについて何ら述べていないことに対応して，「識別\n子」が本願発明の「機密識別子」に相当する場合の引用発明の「入力\n元のアプリケーション」が本願発明の「機密事項を扱うアプリケーシ\nョン」に相当する旨を述べたものであって，非機密アプリケーション\nについては何ら述べていない。そうである以上，引用発明の保護方法\nデータベースが最安全アプリケーションでないアプリケーションの識\n別子を記憶するものであることは，本願発明との相違点となり得ない。\nまた，本件審決が認定した引用発明においては，「ファイルの入力元\nのアプリケーションの識別子とファイルの出力先となる記憶領域とに応\nじて」「ファイルの出力先となる記憶領域」の「安全性」が低い場合と\nそうでない場合とを区別できる必要があるが，そのためには「安全性」\nは２段階であれば十分であり，３段階以上でなければならないものでは\nない。すなわち，引用発明の，入力元のアプリケーションと出力先の記\n憶領域の安全性が，安全性“１”（高），安全性“０”（低）の２値に設定\nされる態様においては，入力元の安全性として最高レベルが設定された\nアプリケーションを「機密アプリケーション」と一意に識別できるよう\nに，アプリケーションに対して入力元の安全性を設定することが可能で\nある。\nそうすると，本願発明の機密識別子記憶部と，引用発明の保護方法デ\nータベースは，いずれも機密アプリケーションを一意に特定できるもの\nであり，この観点から相違していることにはならない。また，引用発明\nにおいて，保護方法データベースに入力元の安全性として最高レベルが\n設定されたアプリケーションであることは，本願発明の条件のうちの\n「当該アプリケーションが，前記機密識別子記憶部で記憶されている機\n密識別子で識別されるアプリケーションである場合」に相当することに\nなる。\n本件審決は，これを踏まえて，「当該アプリケーションが，前記機密\n識別子記憶部で記憶されている機密識別子で識別されるアプリケーショ\nンである場合に，ファイルの送信先に応じて送信を阻止するか否かを決\n定する制御部」を備えることを本願発明と引用発明の一致点としたもの\nである。\n(ｲ)  前記のとおり，引用発明は，安全性が３値以上の態様に限定されな\nい。\nもっとも，引用発明の安全性が３値以上の態様においては，ファイル\nの送信処理が禁止される入力元のアプリケーションであるかどうかは，\n入力元のアプリケーションと出力先の記憶領域の安全性に基づいて相対\n的に決まることから，入力元の安全性として最高レベルが設定されない\nアプリケーションについてもファイルの送信を阻止できるように設定す\nることは可能である。\nしかし，本願発明においては，「機密識別子記憶部」が「機密識別子」\nでないものを記憶しているか否かは無関係の事情であり，非機密アプリ\nケーションからの送信を一切阻止しない旨が積極的に特定されているわ\nけではないから，非機密アプリケーションについて送信を阻止できるよ\nうな設定はできないという趣旨までが含まれているわけではいない。\nそうである以上，引用発明の３値以上の態様において非機密アプリケ\nーション（最安全アプリケーションでないアプリケーション）につきフ\nァイルの送信を阻止できるように設定可能であることは，相違点看過の\n根拠とはならない。\n(ｳ)  相違点Ｂが仮に相違点であるとしても，この点については，本件審\n決における相違点１の判断において事実上判断されている。\nすなわち，本件審決は，引用発明の「入力元のアプリケーション」が\n本願発明の「機密事項を扱うアプリケーション」に相当する旨認定し，\nこれを前提として相違点１についての判断を示したものであるが，本願\n発明の「アプリケーション」が「前記機密識別子記憶部で記憶されてい\nる機密識別子で識別されるアプリケーション」である旨が引用発明にお\nいて明示されていないことをもって相違点と考えたとしても，引用発明\nにおいて，この相違点に係る送信処理を行うアプリケーションが「機密\n事項を扱うアプリケーション」すなわち「機密識別子記憶部で記憶され\nている機密識別子で識別されるアプリケーション」であるとの構成が容\n易想到である旨の判断は，事実上示されている。\n(4)  取消事由３（相違点の認定の誤り及び相違点に係る容易想到性判断の誤\nり）について\nア  相違点の認定の誤りについて\n(ｱ)  本願発明におけるファイル送信が阻止されない条件は，「そうでな\nい場合」という包括的なもの，つまりファイル送信が阻止される条件\n以外の全ての場合であって，ファイル送信が阻止される条件に応じて\n反射的必然的に決定されるものである。\nこの点，原告は，「送信が阻止されない条件」は「アプリケーション\nの識別子が機密識別子記憶部で記憶されていないこと，又は，送信先が\nローカルであること」である旨主張するが，特許請求の範囲の記載によ\nれば，「送信が阻止されない条件」は「そうでない場合」，つまり，送\n信が阻止される場合でない場合であって，原告主張のような限定的な特\n定はされていない。\n(ｲ)  前記のとおり，引用発明は，引用例１の変形例３の態様②に係る記\n載を踏まえ，「ファイルの出力先となる記憶領域の安全性が低い場合」\nに「処理を禁止する」ものであるから，明示するまでもなく，それ以\n外の場合，すなわちファイルの出力先となる記憶領域の安全性が低い\n場合以外の場合には処理を禁止しないのであり，「処理」が「禁止」\nされないのは「ファイルの出力先となる記憶領域の安全性が低い場合」\n以外の場合となる。\n(ｳ)  このように，ファイル送信が阻止される場合（ファイルの入力元の\nアプリケーションと出力先の記憶領域が所定の組合せである場合）で\nない場合という条件においては，本願発明と引用発明は相違 せず，こ\nの条件は一致点となる。\n(ｴ)  本件審決は，以上の対比の趣旨を踏まえて，本願発明における「フ\nァイル送信が阻止される条件」を構成する２つの部分条件のうち「前\n記アプリケーションが，（前記機密識別子記憶部で記憶されている）\n機密識別子で識別されるアプリケーションである場合」という部分条\n件については一致点とし，「送信先がローカル以外である場合」とい\nう部分条件との論理積条件となっている点については相違点（相違点\n１）と整理し，その際，「実行部がアプリケーションを実行中にファ\nイルに対する送信処理に係るシステムコールを検知し，当該アプリケ\nーションが，前記機密識別子記憶部で記憶されている機密識別子で識\n別されるアプリケーションである場合に，ファイルの送信先に応じて\n送信を阻止するか否かを決定する制御部」を本願発明と引用発明との\n一致点として認定したのであり，この認定に誤りはない。\n(ｵ)  本願発明における送信が阻止されない条件のような反射的必然的に\n決定される条件が結果的にどのような条件と等価となっているかは，\n特許請求の範囲に記載されていない事項であり，発明特定事項ではな\nい。相違点１を相違点Ｃと認定すべきとの原告の主張は，特許請求の\n範囲の記載を正解しないものであり，失当である。\nイ  相違点に係る容易想到性判断の誤りについて\n(ｱ)  原告の主張する相違点に係る容易想到性判断の誤りは，相違点Ｃの\n存在を前提としたものであるところ，前記のとおり，相違点Ｃを認定\nすべきとする原告の主張は失当である以上，ここでの原告の主張はそ\nの前提において失当である。\n(ｲ)  相違点１についての容易想到性に関し\nａ  原告は，引用発明において本願発明と同様の保護処理が行われるよ\nうに安全性を設定することには阻害要因があり，相違点１に係る本願\n発明の構成は，引用発明において当業者が適宜設計し得たものではな\nい旨主張する。\nしかし，引用例１における「入力元の安全性と出力先の安全性」\nから保護方法を決定するもの（態様①～③）においては，「保護方法」\nは，「安全性」の具体的な数値の値ではなく「入力元の安全性」と\n「出力先の安全性」との関係に対応しているのであって，「出力先の\n安全性」に応じて「保護方法」を決定する引用例１の他の態様と異な\nり，「安全性」の具体的な数値の値は「保護方法」に対応しない。こ\nのため，非機密アプリケーションの安全性を機密アプリケーションの\n安全性よりも低く設定することは，前者に対する保護方法が後者に対\nするそれより厳重でなくてはならないことを意味するなどとする原告\nの主張は，態様①～③においては必ずしも妥当しない。原告の主張は，\n「出力先の安全性」に応じて「保護方法」を決定することを念頭に置\nいた「安全性」と「保護方法」の対応付けを根拠として「入力元」と\nなるアプリケーションの保護方法を論ずるものであり，失当である。\nｂ  引用発明では，取得された指令に係る入力元のアプリケーションよ\nりも出力先の記憶領域の安全性が低い場合は処理を禁止することから，\n引用発明において相違点１に係る本願発明の条件を実現しようとすれ\nば，引用発明の保護方法データベースに記憶された，機密アプリケー\nション（の識別子），ローカル記憶領域及びローカル以外の記憶領域\nの安全性について，機密アプリケーションの安全性のレベルをローカ\nル以外の記憶領域の安全性のレベルより高く設定する必要がある。\nところ で， 引 用発 明 の「保 護方法 デー タ ベース 」は， そも そも\n「柔軟」な データ保 護のためのものであ る（引用例１の【０ ００\n８】）。これを用いてアプリケーションや記憶領域に合理的に安全性\nを設定することは，そもそも当業者が適宜行うことであり，引用発明\nにおいて本願発明と同様の条件を実現することに何らの阻害事由もな\nい。また，後記のとおり，情報保護の文脈における条件としての「ロ\nーカル」と「ローカル以外」との区別が周知であるということは，こ\nのような区別に基づいて安全性を設定することが「合理的」であるこ\nとにほかならない。\nｃ  本件審決の認定に係る相違点１は，要するに，ファイル送信の阻止\nの条件について「送信先がローカル以外である場合」という部分条件\nを論理積条件として考慮しているか否かということであるから，この\n相違点１に係る本願発明の構成が引用発明に基づき容易想到であると\nする根拠として考慮すべき技術内容は，「ローカル」と「ローカル以\n外」とが情報漏えい防止を含む情報保護の文脈における条件として区\n別されること，及び，引用発明において，このような区別に従った保\n護方法データベースの設定が可能であることである。本件審決は，こ\nのうち前者につき，「ローカル」と「ローカル以外」とが情報漏えい\n防止を含む情報保護の文脈における条件として区別されることが周知\nであることを示すに当たり，引用例２を示したものである。\nｄ  参考文献は，拒絶理由通知に対する意見書（甲７）に答えて提示さ\nれたものであり，必ずしも本件審決の論旨に直接関係しない。\nｅ  したがって，出力先となる記憶領域の安全性が低い場合は処理を禁\n止する引用発明において，上記区別を適用し，ファイル送信の阻止の\n条件として，アプリケーションが機密識別子記憶部に記憶されること\nの条件のほかに，ファイルの送信先が安全性の低い記憶領域であるこ\nとに代えて，ファイルの送信先がローカル以外であることを条件とす\nること，すなわち相違点１に係る構成とすることは，当業者であれば\n適宜なし得たことである。この点に関する本件審決の判断に誤りはな\nく，原告の主張は失当である。\n(ｳ)  相違点Ｃについての容易想到性に関し\nａ  上記(ｲ)ａ及びｂの趣旨は，ここでも妥当する。\nなお，引用発明の「保護方法データベース」を用いてアプリケー\nションや記憶領域に安全性を設定する場合の設定が「合理的」か否か\nについては，上記(ｲ)ｂと同様の考慮に加え，更に「入力元」が「非\n機密アプリケーション」である場合の設定についても考慮する必要が\nあるが，この場合とは，いわば機密情報を考慮する必要がない場合で\nあるから，「安全性」の設定の仕方は機密情報の保護と関係がなく，\n阻害事由とはなり得ない。\nｂ  仮に相違点Ｃを前提とした場合，情報保護の文脈における条件とし\nての「ローカル」と「ローカル以外」との区別が周知である旨だけで\nなく，機密事項に該当しないデータの送信処理については，送信先が\nローカル以外であっても送信を阻止しない点も周知である旨認定する\n必要があるところ，本件審決は，この認定を明示的には行っていない\n点で，不適切なところがあることになる。\nもっとも，そもそも機密事項に該当しないデータの送信処理を許\n可すべきことは言わずもがなのことであるし，データの保護を課題と\nする情報セキュリティの技術分野において，情報漏えい防止のために，\n機密事項に係るデータの送信処理については，送信先がローカルであ\nれば送信を許可し，ローカル以外であれば送信を阻止するとともに，\n機密事項に該当しないデータの送信処理については，送信先がローカ\nル以外であっても送信を阻止しない旨の技術自体が周知である。また，\n引用発明において，本願発明と同様の条件を実現することは設計事項\nであって，何らの阻害事由もないことは前記ａ（上記(ｲ)ｂ）のとお\nりであり，このような周知技術に倣って，引用発明において「ローカ\nル」と「ローカル以外」とを区別しつつ，非機密アプリケーションの\n送信について送信先がローカル以外であっても送信を阻止しないよう\nに設定することは，容易想到である。\nこのように，仮に相違点Ｃを前提としても，結論において本件審\n決に誤りはない。\n第４  当裁判所の判断\n１  本願発明\n(1)  本願発明は，前記第２の２記載のとおりである。\n(2)  本願明細書には，以下の記載がある。\nア  技術分野\n「【０００１】\n本発明は，アプリケーションにおける送信の制御を行う機密管理装置\n等に関する。」\nイ  背景技術\n「【０００２】\n従来，情報処理装置や情報処理システムにおいて，不正行為から装置\nやシステム，データを保護する技術が知られている…。」\nウ  発明が解決しようとする課題\n「【０００４】\nしかしながら，そのような不正行為からの保護を行う装置等において，\nすべてのアプリケーションに関して同じ保護を行うと，安全性は高くな\nるが，利便性が低下するという問題が生じる。例えば，情報の漏洩を防\n止するために，すべてのアプリケーションに関して送信を制限すると，\n情報の漏洩を防止できたとしても，ユーザの利便性は著しく低下するこ\nとになる。\n【０００５】\n本発明は，上記課題を解決するためになされたものであり，安全性を\n維持しながら，利便性も確保することができる機密管理装置等を提供す\nることを目的とする。」\nエ  課題を解決するための手段\n「【０００６】\n上記目的を達成するため，本発明による機密管理装置は，機密事項を\n扱うアプリケーションを識別する機密識別子が記憶される機密識別子記\n憶部と，機密識別子記憶部で記憶されている機密識別子で識別されるア\nプリケーションを実行部が実行中に，実行部が送信を行う場合であって，\n送信先がローカル以外である場合に，送信を阻止するように制御する送\n信制御部と，を備えたものである。\n【０００７】\nこのような構成により，機密識別子によって識別されるアプリケーシ\nョンにおいて，送信先がローカル以外である場合の送信が阻止されるこ\nとになり，機密事項を含むファイル等が送信によって漏洩することを防\n止することができ，安全性が維持されることになる。一方，機密識別子\nで識別されるアプリケーション以外のアプリケーションについては，自\n由に送信をすることができ，ユーザの利便性も確保することができる。」\nオ  発明の効果\n「【００１０】\n本発明による機密管理装置等によれば，アプリケーションに応じて送\n信を制御することができ，安全性の維持と，利便性の確保とを実現する\nことができる。」\nカ  発明を実施するための形態\n「【００２０】\n機密管理装置２は，機密識別子記憶部２１と，送信制御部２２とを備\nえる。\n機密識別子記憶部２１では，一または二以上の機密識別子が記憶され\nる。機密識別子は，機密事項を扱うアプリケーションを識別する情報で\nある。機密識別子は，アプリケーションを識別できる情報であれば，そ\nの内容を問わない。例えば，機密識別子は，アプリケーションの名称や，\nアプリケーションのＩＤ等であってもよい。また，この機密識別子記憶\n部２１で記憶されている機密識別子で識別されるアプリケーションは，\n後述するように，そのアプリケーションにおける送信が制限されるアプ\nリケーションとなる。したがって，機密事項を扱うと考えられるアプリ\nケーションを識別する機密識別子を，機密識別子記憶部２１に蓄積して\nおくことになる。\n【００２２】\n送信制御部２２は，機密識別子記憶部２１で記憶されている機密識別\n子で識別されるアプリケーション（…「機密アプリケーション」…）を実\n行部１４が実行中に，実行部１４が送信を行う場合であって，送信先が\nローカル以外である場合に，送信を阻止するように制御する。機密アプ\nリケーションの実行中に実行部１４が行う送信とは，その機密アプリケ\nーションにおける送信である。例えば，機密アプリケーションにおける\nデータやファイル等の送信であってもよい。ローカルの送信先とは，情\n報処理装置３と同じローカルのネットワークに属する送信先である。…ロ\nーカルでない送信先は，グローバルなネットワークに属する送信先であ\nってもよく，情報処理装置３とは異なるローカルのネットワークに属す\nる送信先であってもよい。なお，送信制御部２２は，結果として，機密\nアプリケーションにおいて，ローカル以外の送信先への送信を阻止する\nように制御できるのであれば，その阻止の方法は問わない。…\n【００２３】\n送信を阻止するように制御するとは，結果としてその送信が行われな\nいようにすることであれば，その方法を問わない。例えば，送信制御部\n２２は，機密アプリケーションからＯＳに渡されるシステムコールをフ\nックし，送信阻止の対象でないシステムコールであれば，そのフックし\nたシステムコールを開放して送信が行われるようにし，一方，送信阻止\nの対象となるシステムコールであれば，そのフックしたシステムコール\nを破棄して送信を阻止してもよい。…\n【００３４】\nまず，ユーザが，アプリケーション「フォトビュアーＡＡＡ」を起動\nし，そのアプリケーションでファイル「ｐｈｏｔｏ２００９」をオープ\nンする指示を出したとする。すると，…その指示に応じて，…その実行中\nのアプリケーション「フォトビュアーＡＡＡ」において，ファイル記憶\n部１１で記憶されているファイル「ｐｈｏｔｏ２００９」をオープンす\nる処理を行う。その後，ユーザが，そのファイル「ｐｈｏｔｏ２００９」\nに含まれる写真を選択し，写真共有サイトのサーバに送信するためのボ\nタンを選択する操作を行ったとする。すると，その操作に応じて実行部\n１４は，選択された写真のデータをあらかじめ設定されているドメイン\n名のサイトに送信する処理を行う。そして，送信制御部２２は，システ\nムコールの監視において，その写真のデータの送信に対応するシステム\nコールをフックし，そのアプリケーションの名称「フォトビュアーＡＡ\nＡ」と，送信先のドメイン名「ｐｈｏｔｏｓｈａｒｉｎｇ...ｃｏｍ」を取\n得する（ステップＳ１０１）。また，送信制御部２２は，その取得した\nアプリケーションの名称が，図３で示される機密識別子に含まれるかど\nうか判断する。この場合には，含まれなかったとする。すると，送信制\n御部２２は，送信を行ったアプリケーションが機密アプリケーションで\nないと判断し（ステップＳ１０２），そのフックしたシステムコールを\n開放する。その結果，その写真のデータが送信部１６によって写真共有\nサイトのサーバに送信されることになる。\n【００３５】\n次に，ユーザが，アプリケーション「会計ソフトＤＤＤ」を起動する\n操作を行ったとする。すると，その操作に応じて実行部１４は，アプリ\nケーションを起動する。そして，ユーザが，アプリケーション「会計ソ\nフトＤＤＤ」において，新規ファイルを作成する操作を行い，その後に\nそのファイル「ｄａｔａ２０１０」を保存する操作を行ったとする。す\nると，その操作に応じて，実行部１４は，ファイル「ｄａｔａ２０１０」\nをファイル記憶部１１に蓄積する処理を行う。また，ユーザは，そのフ\nァイル「ｄａｔａ２０１０」をファイルサーバに送信するためのボタン\nを選択する操作を行ったとする。すると，その操作に応じて実行部１４\nは，そのファイルをあらかじめ設定されているドメイン名のサイトに送\n信する処理を行う。そして，送信制御部２２は，システムコールの監視\nにおいて，そのファイルの送信に対応するシステムコールをフックし，\nそのアプリケーションの名称「会計ソフトＤＤＤ」と，送信先のドメイ\nン名「ａｃｃｏｕｎｔｉｎｇ...ｃｏｍ」を取得する（ステップＳ１０１）。\nまた，送信制御部２２は，その取得したアプリケーションの名称が，図\n３で示される機密識別子に含まれるかどうか判断する。この場合には含\nまれるため，送信制御部２２は，ファイルを送信するアプリケーション\nが機密アプリケーションであると判断する（ステップＳ１０２）。また，\n送信制御部２２は，その取得したドメイン名が，記憶されているドメイ\nン名「ａｂｃ...ｃｏｍ」と異なるため，送信先がローカル以外であると判\n断する（ステップＳ１０３）。そのため，送信制御部２２は，そのフッ\nクしたシステムコールを破棄することによって，その送信を阻止する\n（ステップＳ１０４）。その結果，ファイル「ｄａｔａ２０１０」の送\n信は行われないことになる。\n【００３６】\nなお，そのアプリケーション「会計ソフトＤＤＤ」における送信にお\nいて，送信先のドメイン名が「ａｂｃ...ｃｏｍ」である場合には，送信制\n御部２２は，そのドメイン名が記憶されているものと同じであるため，\n送信先がローカルであると判断する（ステップＳ１０３）。その結果，\nローカルの送信先への送信が行われることになる。\n(3)  本願発明の特徴\nア  技術分野\n本発明は，アプリケーションにおける送信の制御を行う機密管理装置\n等に関する。（【０００１】）\nイ  本願発明が解決しようとする課題\n従来，情報処理装置や情報処理システムにおいて，不正行為から装置\nやシステム，データを保護する技術が知られている。しかし，そのよう\nな不正行為からの保護を行う装置等において，全てのアプリケーション\nに関して同じ保護を行うと，安全性は高くなるが，利便性が低下すると\nいう問題が生じる。例えば，情報の漏洩を防止するために，全てのアプ\nリケーションに関して送信を制限すると，情報の漏洩を防止できたとし\nても，ユーザの利便性は著しく低下することになる。（【０００２】，\n【０００４】）\n本願発明は，上記課題を解決するためになされたものであり，安全性\nを維持しながら，利便性も確保することができる機密管理装置等を提供\nすることを目的とする。（【０００５】）\nウ  課題解決手段\n上記目的を達成するため，本願発明による機密管理装置は，機密事項\nを扱うアプリケーションを識別する機密識別子が記憶される機密識別子\n記憶部と，機密識別子記憶部で記憶されている機密識別子で識別される\nアプリケーションを実行部が実行中に，実行部が送信を行う場合であっ\nて，送信先がローカル以外である場合に，送信を阻止するように制御す\nる送信制御部と，を備えたものである。（【０００６】）\nエ  効果\n上記の構成により，機密識別子によって識別されるアプリケーション\n（機密アプリケーション）において，送信先がローカル以外である場合\nの送信が阻止されることになり，機密事項を含むファイル等が送信によ\nって漏洩することを防止することができ，安全性が維持されることにな\nる。一方，機密アプリケーション以外のアプリケーションについては，\n自由に送信をすることができ，ユーザの利便性も確保することができる。\n（【０００７】，【００１０】）\nオ  実施の形態\n(ｱ)  機密管理装置２は，機密識別子記憶部２１と，送信制御部２２とを\n備える。（【００２０】）\n(ｲ)  機密識別子記憶部２１では，機密識別子が記憶される。\n機密識別子は，機密事項を扱うアプリケーションを識別する情報であ\nる。機密識別子は，アプリケーションを識別できる情報であれば，その\n内容を問わない。例えば，機密識別子は，アプリケーションの名称や，\nアプリケーションのＩＤ等であってもよい。\nまた，この機密識別子記憶部２１で記憶されている機密アプリケーシ\nョンは，後述するように，そのアプリケーションにおける送信が制限さ\nれるアプリケーションとなる。したがって，機密事項を扱うと考えられ\nるアプリケーションを識別する機密識別子を，機密識別子記憶部２１に\n蓄積しておくことになる。（以上，【００２０】）\n(ｳ)  送信制御部２２は，機密アプリケーションを実行部１４が実行中に，\n実行部１４が送信を行う場合であって，送信先がローカル以外である\n場合に，送信を阻止するように制御する。\n機密アプリケーションの実行中に実行部１４が行う送信とは，その機\n密アプリケーションにおける送信である。例えば，機密アプリケーショ\nンにおけるデータやファイル等の送信であってもよい。\nローカルの送信先とは，情報処理装置３と同じローカルのネットワー\nクに属する送信先である。（以上，【００２２】）\n送信を阻止するように制御するとは，結果としてその送信が行われな\nいようにすることであれば，その方法を問わない。例えば，送信制御部\n２２は，機密アプリケーションからＯＳに渡されるシステムコールをフ\nックし，送信阻止の対象でないシステムコールであれば，そのフックし\nたシステムコールを開放して送信が行われるようにし，一方，送信阻止\nの対象となるシステムコールであれば，そのフックしたシステムコール\nを破棄して送信を阻止してもよい。（【００２３】）\n(ｴ)  具体例\nａ  ユーザが，アプリケーション「フォトビュアーＡＡＡ」を起動し，\n写真を選択し，写真共有サイトのサーバに送信するためのボタンを選\n択する操作を行うと，その操作に応じて実行部１４は，選択された写\n真のデータをあらかじめ設定されているドメイン名のサイトに送信す\nる処理を行う。\n送信制御部２２は，システムコールの監視において，その写真の\nデータの送信に対応するシステムコールをフックし，そのアプリケー\nションの名称「フォトビュアーＡＡＡ」と，送信先のドメイン名「ｐ\nｈｏｔｏｓｈａｒｉｎｇ...ｃｏｍ」を取得する。また，送信制御部２\n２は，その取得したアプリケーションの名称が，機密識別子に含まれ\nるかどうか判断する。この場合には，含まれなかったとする。すると，\n送信制御部２２は，送信を行ったアプリケーションが機密アプリケー\nションでないと判断し，そのフックしたシステムコールを開放する。\nその結果，その写真のデータが送信部１６によって写真共有サイ\nトのサーバに送信されることになる。（以上，【００３４】）\nｂ  ユーザが，アプリケーション「会計ソフトＤＤＤ」を起動し，同ア\nプリケーションにより作成，保存したファイル「ｄａｔａ２０１０」\nをファイルサーバに送信するためのボタンを選択する操作を行ったと\nする。すると，その操作に応じて実行部１４は，そのファイルをあら\nかじめ設定されているドメイン名のサイトに送信する処理を行う。\n送信制御部２２は，システムコールの監視において，そのファイ\nルの送信に対応するシステムコールをフックし，そのアプリケーショ\nンの名称「会計ソフトＤＤＤ」と，送信先のドメイン名「ａｃｃｏｕ\nｎｔｉｎｇ...ｃｏｍ」を取得する。また，送信制御部２２は，その取\n得したアプリケーションの名称が機密識別子に含まれるかどうか判断\nする。この場合には含まれるため，送信制御部２２は，ファイルを送\n信するアプリケーションが機密アプリケーションであると判断する。\nさらに，送信制御部２２は，その取得したドメイン名が，記憶されて\nいるドメイン名「ａｂｃ...ｃｏｍ」と異なるため，送信先がローカル\n以外であると判断する。そのため，送信制御部２２は，そのフックし\nたシステムコールを破棄することによって，その送信を阻止する（ス\nテップＳ１０４）。\nその結果，ファイル「ｄａｔａ２０１０」の送信は行われないこ\nとになる。（以上，【００３５】）\n他方，「会計ソフトＤＤＤ」における送信において，送信先のド\nメイン名が「ａｂｃ...ｃｏｍ」である場合には，送信制御部２２は，\nそのドメイン名が記憶されているものと同じであるため，送信先がロ\nーカルであると判断する。その結果，ローカルの送信先への送信が行\nわれることになる。（【００３６】）\n２  取消事由１（引用発明の認定の誤り）について\n(1)  引用発明\n引用例１には，以下の記載がある。\nア  技術分野\n「【０００１】\n本発明は，ファイル管理プログラム及びファイル管理装置に関する。」\nイ  背景技術\n「【０００２】\nコンピュータシステムにおいてデータを保護するための技術が知られ\nている。\n【０００３】\n例えば，保護対象となるリソースに対してアクセス可能なプログラム\nの識別情報をアクセス許可管理テーブルに登録しておき，保護対象とな\nるリソースに対するアクセス要求があると，アクセス要求したプログラ\nムの識別情報を取得してアクセス許可管理テーブルにその識別情報が登\n録されているか否かにより，リソースへのアクセスの許否を判定する技\n術が開示されている…。\n【０００４】\nまた，保護領域にアプリケーションがアクセスするとアプリケーショ\nンの識別情報を取得し，識別情報がテーブルに登録されているか否かを\n判定し，登録されていなければアクセスを許可し，テーブルに識別情報\nが登録されていればアクセス先を検出し，アクセス先が保護領域であれ\nばアクセスを許可し，保護領域でなければアクセスを禁止する技術が開\n示されている…。\n【０００５】\nまた，ハードディスク等のデバイスドライバを制御するための制御関\n数を取得し，暗号領域内の暗号化ファイルが非暗号領域への移動又は複\n製されることを検知すると制御関数を用いて暗号化ファイルを開き，制\n御関数を用いてオープンした暗号化ファイルを読み出して復号し，移動\n先又は複製先にて制御関数を用いて復号化されたファイルを書き込む技\n術が開示されている…。」\nウ  発明が解決しようとする課題\n「【０００７】\nファイルやリソースへのアクセスの許可・不許可を行うことによりデ\nータを保護する方法やデータの暗号化・復号化を行うことによりデータ\nを保護する方法は知られている。\n【０００８】\nしかしながら，オペレーションシステム（ＯＳ）に対する処理要求の\n内容に応じてデータの保護方法を変更する技術は知られていない。した\nがって，データの取得先や出力先に応じてデータの保護方法を変更した\nり，データを使用するアプリケーション毎にデータの保護方法を変更し\nたりして，柔軟にデータを保護することができなかった。」\nエ  課題を解決するための手段\n「【０００９】\n本発明の１つは，コンピュータに，処理対象となるデータに対する処\n理の指令を取得する第１のステップと，前記第１のステップで取得され\nた指令で特定される処理の内容に応じて前記処理の内容に応じたデータ\nの保護方法を求め，その保護方法により前記処理対象となるデータの保\n護処理を行う第２のステップと，を含む処理を実行させることを特徴と\nするファイル管理プログラムである。\n【００１０】\nまた，本発明の１つは，処理対象となるデータに対する処理の指令を\n取得する第１の手段と，前記第１の手段で取得された指令で特定される\n処理の内容に応じて前記処理の内容に応じたデータの保護方法を求め，\nその保護方法により前記処理対象となるデータの保護処理を行う第２の\n手段と，…を備えることを特徴とするファイル管理装置である。\n【００１２】\nまた，前記第２のステップ又は手段は，前記第１のステップ又は手段\nで取得された指令で特定される処理におけるデータの取得元又は出力先\nに応じてデータの保護方法を求め，その保護方法により前記処理対象と\nなるデータの保護処理を行うものとしてもよい。\n【００１４】\nまた，前記第１のステップ又は手段で取得された指令に関するアプリ\nケーション又は前記第１のステップ又は手段で取得された命令の入力手\n段と，前記処理対象となるデータに対する処理を行うオペレーションシ\nステムと，の間において前記第１のステップ又は手段及び前記第２のス\nテップ又は手段を行うものとしてもよい。\n【００１５】\nまた，前記第２のステップ又は手段は，前記第１のステップ又は手段\nで取得された指令で特定される処理に応じて，前記処理対象となるデー\nタ処理の前又は前記処理対象となるデータ処理の後を切り替えて前記処\n理対象となるデータの保護処理を行うものとしてもよい。」\nオ  発明の効果\n「【００１６】\n請求項１及び７の発明によれば，データの処理の内容に応じた保護方\n法でデータを保護することができる。\n【００１８】\n請求項３の発明によれば，処理対象となるデータの取得元，出力先等\nとなる処理のアクセス先に応じた保護方法でデータを保護することがで\nきる。\n【００２０】\n請求項５の発明によれば，従来から使用してきたオペレーションシス\nテム及びオペレーションシステム上で動作するアプリケーションを変更\nすることなく柔軟にデータを保護することができる。\n【００２１】\n請求項６の発明によれば，処理の内容に応じて，データに対する処理\nの前又はデータに対する処理の後の適切なタイミングでデータに保護を\n施すことができる。」\nカ  発明を実施するための最良の形態\n「【００２２】\n本発明の実施の形態におけるファイル管理装置１００は，…中央処理部\n１０，記憶部１２，入力部１４，表示部１６及びインターフェース部１\n８を含んで構成される。これらの構成部は，バスやネットワーク等の情\n報伝達手段によって相互に情報伝達可能に接続される。\n【００２９】\nファイル管理装置１００は，…ファイル操作命令手段２０，アプリケー\nション処理手段２２，ファイル操作命令取得手段２４，ファイル保護手\n段２６，データ位置特定手段２８，保護方法データベース記憶手段３０\n及びオペレーティングシステム処理手段３２を含む装置として機能する。\n【００３１】\nステップＳ１０では，データ（ファイル）に対する処理を特定する命\n令を取得する。中央処理部１０は，データに対する処理の命令を取得す\nる。このステップの処理がファイル操作命令取得手段２４に相当する。\n取得された処理内容はファイル保護手段２６へ送られる。\n【００３５】\n例 え ば ， フ ァ イ ル の 複 写 （ ｃ ｏ ｐ ｙ ） の 指 示 に は ， \"copy\nc:¥work¥test.txt  c:¥share\"のように複写命令のコマンド\"copy\"，複写元の記\n憶領域\"c:¥work\"，複写先の記憶領域\"c:¥share\"及びファイル名\"test.txt\"が含\nまれる。\n【００３６】\nま た ， フ ァ イ ル の 書 き 込 み （ ｗ ｒ ｉ ｔ ｅ ） の 指 示 に は ， \"write  data\nc:¥share¥test.txt\"のように，書き込み命令のコマンド\"write\"，書き込み対象\nとなるデータ\"data\"，書き込み先の記憶領域\"c:¥share\"及び書き込みデータ\nのファイル名\"test.txt\"が含まれる。\n【００３７】\nまた，アプリケーションからのファイルの読み出し（ｒｅａｄ）の指\n示には，対象となるファイルを特定する情報とアプリケーションを特定\nする識別子（アプリケーション名，プロセス名等）とが含まれる。具体\n的には，\"read c:¥work¥test.txt ‘Mail Tool’\"のように，読み出し命令のコマン\nド\"read\"，処理対象となるファイルの記憶領域\"c:¥work\"，電子メールとし\nて処理することを示す\"Mail  Tool\"及びファイル名\"test.txt\"が含まれる。ま\nた，\"read c:¥work¥test.txt ‘文書 Viewer’\"のように，電子メールとして処理す\nることを示す\"Mail  Tool\"の代りに，ファイルの内容を表示してユーザに呈\n示する\"文書 Viewer\"を指定したり，プリンタによる画像形成をするために\nプリンタ\"printer A\"を指定したりしてもよい。\n【００３８】\nステップＳ１２では，処理内容から出力先の記憶領域または識別子を\n抽出する。ここでの処理はファイル保護手段２６及びデータ位置特定手\n段２８に相当する。なお，記憶領域または識別子は処理内容に直接含ま\nれている場合と処理内容に含まれる情報から間接的に取得される場合が\nある。例えば，\"read  c:¥work¥test.txt  HANDLE\"のような処理内容があり，\nHANDLE が読み先のメモリ領域を示す情報である場合，HANDLE から読\nみ込み先のプロセスを特定する。あるいは処理命令の指示元のプロセス\nを読み込み先としてもよい。\n【００４０】\nステップＳ１４では，処理内容に応じたデータ（ファイル）の保護方\n法を決定する。中央処理部１０は，記憶部１２に予め格納されている保\n護方法データベースを参照し，ステップＳ１０で取得した処理内容に応\nじてデータ（ファイル）の保護方法を決定する。ここでの処理はファイ\nル保護手段２６及び保護方法データベース記憶手段３０に相当する。\n【００４１】\n保護方法データベースは，記憶領域又はアプリケーションを特定する\n識別子に保護方法を関連付けたデータベースである。保護方法データベ\nースが格納及び保持された記憶部１０が保護方法データベース記憶手段\n３０に相当する。\n【００４２】\n例えば，図４に例示するように，記憶領域\"c:¥share\"に安全性\"1\"，記憶\n領域 \"c:¥Documents  and  Setting¥userA¥desktop\" に 安 全 性 \"2\" ， 記 憶 領 域\n\"¥¥server1¥confidential\"に安全性\"3\"，記憶領域\"ごみ箱\"に安全性\"1\"が関連\n付けられる。また，アプリケーションを特定する識別子\"文書 viewer\"に安\n全性\"3\"，識別子\"Mail Tool\"に安全性\"1\"，識別子\"printer A\"に安全性\"2\"，識\n別子\"printer B\"に安全性\"1\"が関連付けられる。\n【００４３】\nここで，図５に例示するように，安全性\"0\"とはファイル操作禁止によ\nる保護を意味し，安全性\"1\"はＤＲＭ(Digital  Rights  Management)による保護\nを意味し，安全性\"2\"はファイル操作の履歴（ログ）の保存を意味し，安\n全性\"3\"は平文による処理（ＯＳによる通常のファイル操作）を許可する\nことを意味する。\n【００４４】\nここで，安全性は 0～3 としたが，これらは保護の安全性の順序やレベ\nルを示す必要はなく，処理対象となるデータ（ファイル）にどのような\n保護を適用するか特定できるものであればよい。\n【００４７】\nステップＳ１６では，処理内容毎に，処理前（オペレーションシステ\nムに渡す前）にデータ（ファイル）に保護を施すか，処理後（オペレー\nションシステムから戻ってきた後）にデータ（ファイル）に保護を施す\nかを判断する。\n【００４８】\nデータ（ファイル）に保護を施すタイミングは，処理の内容に応じて\n変更される。図６に例示するように，…ファイルの書き込み（ｗｒｉｔ\nｅ），ファイルの送信（ｓｅｎｄ）については，データ（ファイル）に\n対する処理前に保護を施す。この場合，ステップＳ１８に処理を移行さ\nせる。一方，データ（ファイル）に対する処理が…ファイルの読み出し\n（ｒｅａｄ）…については，データ（ファイル）に対する処理後に保護を\n施す。この場合，ステップＳ２０に処理を移行させる。\n【００４９】\nステップＳ１８では，決定された保護方法でデータ（ファイル）に保\n護を施す。中央処理部１０は，ステップＳ１０で指定されたデータ（フ\nァイル）に対して取得して処理命令で特定される処理を施す前にステッ\nプＳ１４で決定した保護方法を施す。ここでの処理は，ファイル保護手\n段２６及びオペレーティングシステム処理手段３２で行われる。\n【００５０】\n例えば，ファイルの書き込み（ｗｒｉｔｅ）の指示として\"write  data\nc:¥share¥test.txt\"という処理内容が取得された場合，ファイルに対する書\nき込み処理前に保護処理を施す。中央処理部１０は，取得したファイル\nに対して保護を施した後，オペレーションシステムに書き込み対象とな\nる デ ー タ \"data\" を 渡 し ， 書 き 込 み 先 の 記 憶 領 域 \"c:¥share\" に フ ァ イ ル 名\n\"test.txt\"としてデータ\"data\"を格納する。図４の保護方法データベースの例\nでは書き込み先の記憶領域\"c:¥share\"は安全性\"1\"に指定されているので，\nオペレーションシステムにファイルを引き渡す前にデータ\"data\"に DRM に\nよる保護を施す。\n【００５３】\n…送信（ｓｅｎｄ）についても同様にファイル操作前に保護を施す。\n【００５６】\nまた，アプリケーションからのファイルの読み出し（ｒｅａｄ）の指\n示として\"read c:¥work¥test.txt ‘Mail Tool’\"という処理内容が取得された場合，\nファイルに対する読み出し処理後に保護処理を施す。中央処理部１０は，\n対象となるファイルの記憶領域\"c:¥work\"からファイル名\"test.txt\"で特定さ\nれるファイルを読み出し，そのファイルに保護を施した後，電子メール\nのメールツールである\"Mail  Tool\"へファイルの出力を行う。保護方法デー\nタベースでは，読み出し先のプロセス\"Mail Tool\"は安全性\"1\"に指定されて\nいるので，読み出し処理後にプロセス\"Mail  Tool\"に出力される前にファイ\nル名\"test.txt\"のファイルに DRM による保護を施す。\n【００５７】\n同様に，\"read c:¥work¥test.txt ‘文書 Viewer’\"のようにファイルの内容を表\n示してユーザに呈示する\"文書 Viewer\"が指定された場合，ファイルに対す\nる読み出し処理後に保護処理を施す。中央処理部１０はオペレーション\nシステムを呼び出し，処理対象となるファイルの記憶領域\"  c:¥work\"から\nファイル名\"test.txt\"で特定されるファイルを読み出し，文書ビューアであ\nるアプリケーションにファイルの出力を行う。保護方法データベースで\nは，読み出し先のプロセス\"文書 Viewer\"は安全性\"3\"に指定されているので，\n読み出し処理後にファイル名\"test.txt\"のファイルが平文であればそのまま\n文書ビューアであるアプリケーションにファイルを出力する。一方，フ\nァイル名\"test.txt\"のファイルが平文でなければ，ファイルを平文に戻す処\n理を施して文書ビューアであるアプリケーションにファイルを出力する。\n【００７７】\n＜変形例３＞\n上記の実施の形態では，出力先の安全性に応じて保護方法を決定した\nが，処理内容から入力元の記憶領域または識別子と出力先の記憶領域ま\nたは識別子とを抽出し，入力元の安全性と出力先の安全性から，処理方\n法を決定するようにしてもよい。例えば，図４の保護方法データベース\nを持つ時に\"copy c:¥share¥doc1.txt c:¥share¥doc2.txt\"  という処理内容を実行\nする場合，入力元と出力先は同じ安全性なので，再度保護処理を行わず\nそのままファイルの複写を行うようにしてもよい。また，入力元よりも\n出力先の安全性が低い場合は処理を禁止するようにしてもよいし，逆に\n入力元よりも出力先の安全性が高い場合には入力元の安全性に従った保\n護処理を施し元の保護よりも弱い保護にはしないようにしてもよい。」\n(2)  引用発明の特徴\nア  技術分野\n引用発明は，ファイル管理プログラム及びファイル管理装置に関する。\n（【０００１】）\nイ  引用発明が解決しようとする課題\n従来より，コンピュータシステムにおいてデータを保護するための技\n術として，ファイルやリソースへのアクセスの許可・不許可を行うこと\nによりデータを保護する方法やデータの暗号化・復号化を行うことによ\nりデータを保護する方法は知られている 。（【０００２】，【０００\n７】）\nしかし，オペレーションシステム（ＯＳ）に対する処理要求の内容に\n応じてデータの保護方法を変更する技術は知られておらず，データの取\n得先や出力先に応じてデータの保護方法を変更したり，データを使用す\nるアプリケーション毎にデータの保護方法を変更したりして，柔軟にデ\nータを保護することができなかった。（【０００８】）\nウ  課題解決手段\n引用発明は，処理対象となるデータに対する処理の指令を取得する第\n１の手段と，前記第１の手段で取得された指令で特定される処理の内容\nに応じて前記処理の内容に応じたデータの保護方法を求め，その保護方\n法により前記処理対象となるデータの保護処理を行う第２の手段とを備\nえるファイル管理装置であって，（【００１０】）\n前記第２の手段は，前記第１の手段で取得された指令で特定される処\n理におけるデータの取得元及び出力先の安全性に応じて，入力元よりも\n出力先の安全性が低い場合は処理を禁止するようにデータの保護方法を\n求め，（【００１２】，【００７７】）\n前記第２の手段は，前記第１の手段で取得された指令で特定される処\n理に応じて，前記処理対象となるデータ処理の前又は前記処理対象とな\nるデータ処理の後を切り替えて前記処理対象となるデータの保護処理を\n行うものである。（【００１５】）\nエ  効果\n引用発明によれば，データの処理の内容に応じた保護方法，特に，処\n理対象となるデータの取得元，出力先等となる処理のアクセス先に応じ\nた保護方法でデータを保護することができ （【００１６】，【００１\n８】），処理の内容に応じて，データに対する処理の前又はデータに対\nする処理の後の適切なタイミングでデータに保護を施すことができる。\n（【００２１】）\nオ  実施の形態（変形例３）\nファイル管理装置１００は，ファイル操作命令手段２０，アプリケー\nション処理手段２２，ファイル操作命令取得手段２４，ファイル保護手\n段２６，データ位置特定手段２８，保護方法データベース記憶手段３０\n及びオペレーティングシステム処理手段３２を含む装置として機能する。\n（【００２９】）\nステップＳ１０（ファイル操作命令取得手段２４に相当）では，中央\n処理部１０は，データ（ファイル）に対する処理を特定する命令を取得\nする。取得された処理内容はファイル保護手段２６へ送られる。（【０\n０３１】）\nステップＳ１２（ファイル保護手段２６及びデータ位置特定手段２８\nに相当）では，処理命令の指示元のプロセスを読み込み先とし，又は，\n処理内容から入力元の記憶領域若しくは識別子を抽出し，かつ，処理内\n容から出力先の記憶領域または識別子を抽出する。なお，記憶領域また\nは識別子は処理内容に直接含まれている場合と処理内容に含まれる情報\nから間接的に取得される場合がある。（【００３８】，【００７７】）\nステップＳ１４（ファイル保護手段２６及び保護方法データベース記\n憶手段３０に相当）では，中央処理部１０は，記憶部１２に予め格納さ\nれている保護方法データベースを参照し，入力元よりも出力先の安全性\nが低い場合は処理を禁止するように，処理内容に応じたデータ（ファイ\nル）の保護方法を決定する。（【００４０】，【００７７】）\n保護方法データベースは，記憶領域又はアプリケーションを特定する\n識別子に安全性を関連付けたデータベースである。保護方法データベー\nスが格納及び保持された記憶部１０が保護方法データベース記憶手段３\n０に相当する。（【００４１】～【００４４】，【００７７】）\nステップＳ１６では，処理内容毎に，処理前（オペレーションシステ\nムに渡す前）にデータ（ファイル）に保護を施すか，処理後（オペレー\nションシステムから戻ってきた後）にデータ（ファイル）に保護を施す\nかを判断する。ファイルの送信（ｓｅｎｄ）については，データ（ファ\nイル）に対する処理前に保護を施す。この場合，ステップＳ１８に処理\nを移行させる。（【００４７】，【００４８】）\nステップＳ１８では，決定された保護方法でデータ（ファイル）に保\n護を施す。中央処理部１０は，ステップＳ１０で指定されたデータ（フ\nァイル）に対して取得して処理命令で特定される処理を施す前にステッ\nプＳ１４で決定した保護方法を施す。ここでの処理は，ファイル保護手\n段２６及びオペレーティングシステム処理手段３２で行われる。（【０\n０４９】）\n(3)  取消事由１－１（送信の指令に関する引用発明の認定の誤り）について\nア  原告は，引用発明においては，取得されたファイルの送信の指令から入\n力元のアプリケーションの識別子を抽出することはできないところ，本\n件審決はその抽出ができるとした点で誤りがある旨主張する。\nイ  この点につき，引用発明の実施の形態である変形例３を記載した引用例\n１の【００７７】には，入力元のアプリケーションの識別子の取得に関\nして，単に「処理内容から入力元の記憶領域または識別子と出力先の記\n憶領域または識別子とを抽出し」との記載があるのみであり，また，処\n理内容の例を見ると，処理の命令が read の場合に\"Mail  Tool\"及び\"文書\nViewer\"というアプリケーションの識別子を出力先に指定した例が記載さ\nれているが（【００３７】，【００５６】及び【００５７】），入力元\nにアプリケーションの識別子を直接指定した例は見当たらない。間接的\nに識別子を取得する例も，前記【００３８】の HANDLE の例のみである。\nこれらの事情等を踏まえると，引用例１には，入力元のアプリケーシ\nョンの識別子を取得する具体的手法についての記載はなく，【００７７】\nに抽象的に「処理内容から入力元の…識別子…を抽出し」と記載されてい\nるにとどまることになる。\nしかし，他方で，引用例１には，入力元にアプリケーションの識別子\nを 直 接 指 定 す る こ と が で き な い 旨 ， 入 力 元 に HANDLE を 指 定 し て\nHANDLE から入力元のアプリケーションを特定する手法を取り得ない旨，\n及び，処理命令の指示元のプロセスを入力元とすることができない旨に\nついての記載もない。\n加えて，引用発明が既存の特定のＯＳを前提とするものであり，当該\nＯＳの仕様によって入力元のアプリケーションの識別子を取得すること\nができないとする理由もない。そもそも，引用例１には，処理内容が特\n定のＯＳのシステムコール又はＡＰＩに準拠していることをうかがわせ\nる記載はない。\nさらに，処理命令の入力元をアプリケーションとすることも考えられ\nないではなく，それが必ずしも非現実的とまではいえない。\n以上より，引用例１は，入力元のアプリケーションの識別子を取得す\nる具体的手法を明らかにはしていないものの，その取得が不可能とまで\nいうことはできない。\nウ  したがって，取消事由１－１は理由がない。この点に関する原告の主張\nは採用し得ない。\n(4)  取消事由１－２（保護方法に関する引用発明の認定の誤り）について\nア  前記のとおり，変形例３には，入力元よりも出力先の安全性が低い場合\nには処理を禁止するように，処理内容に応じたデータ（ファイル）の保\n護方法を決定することが記載されている。そうである以上，本件審決が\n引用発明の保護方法につき「その保護方法は，ファイルの出力先となる\n記憶領域の安全性が低い場合は処理を禁止することを含む」と認定した\nことに誤りはない。\nしたがって，取消事由１－２は理由がないというべきである。\nイ  これに対し，原告は，引用発明の認定は変形例３の態様②のみでなく態\n様③も含めて行われるべきである旨主張する。\nしかし，変形例３の態様①～③は，それぞれ「してもよい」という選\n択肢を示す記載により結ばれており，いずれも選択的に採用され得るも\nのにすぎないことは明らかである。また，これらの全部又は一部を組み\n合わせた処理方法を採用すべき旨の記載も見当たらない。\nその他原告がるる指摘する点を考慮しても，この点に関する原告の主\n張は採用し得ないというべきである。\n３  取消事由２（一致点の認定の誤り及び相違点の看過）について\n(1)  取消事由２につき，原告は，本件審決の理解に応じて取消事由２－１及\nび２－２の２つの場合を分けて論じつつ，これらに共通する趣旨は，本件審\n決は，本願発明の機密識別子の作用ないし機能と引用発明の識別子の作用な\nいし機能が相違すること，すなわち，本願発明の「機密識別子」は「機密事\n項を扱うアプリケーションを識別する」ものであるのに対し，引用発明にお\nける「アプリケーションの識別子」は必ずしも機密事項を扱うアプリケーシ\nョンを識別するものではなく，ファイルの保護方法を求める上で必要となる\n安全性の程度（例えば，数値）を得る前提として，入力元のアプリケーショ\nンを識別するものであることを看過したというものである旨主張する。\nそこで，以下では，上記相違点に係る取消事由を取消事由２－１及び２\n－２を包摂するものとして「取消事由２」とし，その理由の有無について検\n討する。\n(2)ア  本件審決は，「保護方法データベース」に記憶された「入力元のアプ\nリケーション」が保護対象データである「ファイル」を処理するのは自明\nであり，機密事項を保護対象データとして扱うことは当該技術分野の技術\n常識であることから，引用発明の「入力元のアプリケーション」，「識別\n子」はそれぞれ，本願発明の「機密事項を扱うアプリケーション」，「機\n密識別子」に相当し，また，引用発明の「保護方法データベース」に「入\n力元のアプリケーション」の「識別子」が記憶されていることは明らかで\nあるから，引用発明の「保護方法データベース」は本願発明の「機密事項\nを扱うアプリケーションを識別する機密識別子が記憶される機密識別子記\n憶部」に相当する旨認定・判断した。\nイ(ｱ)  しかし，前記認定に係る本願明細書及び引用例１の記載によれば，\n本願発明における「機密識別子」は「機密事項を扱うアプリケーション\nを識別する」ものとして定義されている（本願明細書【０００６】等）\nのに対し，引用発明におけるアプリケーションの「識別子」は，アプリ\nケーションを特定する要素（アプリケーション名，プロセス名等）とし\nて位置付けられるものであって（引用例１【００３７】等），必ずしも\n直接的ないし一次的に機密事項を扱うアプリケーションを識別するもの\nとはされていない。\n(ｲ)  また，本願発明は，「すべてのアプリケーションに関して同じ保護\nを行うと，安全性は高くなるが，利便性が低下するという問題が生じ\nる」（本願明細書【０００４】）という課題を解決するために，「当\n該アプリケーションが，前記機密識別子記憶部で記憶されている機密\n識別子で識別されるアプリケーションであり，送信先がローカル以外\nである場合に」「送信を阻止」するという構成を採用したものである。\nこのような構成を採用することによって，「機密事項を含むファイル\n等が送信によって漏洩することを防止することができ」，かつ，「機\n密識別子で識別されるアプリケーション以外のアプリケーションにつ\nいては，自由に送信をすることができ，ユーザの利便性も確保するこ\nとができる」という効果が奏せられ（本願明細書【０００７】），前\n記課題が解決され得る。このことに鑑みると，本願発明の根幹をなす\n技術的思想は，アプリケーションが機密事項を扱うか否かによって送\n信の可否を異にすることにあるといってよい。\n他方，引用発明において，アプリケーションは，機密事項を扱うか否\nかによって区別されていない。すなわち，そもそも，引用例１には機密\n事項の保護という観点からの記載が存在しない。また，引用発明は，柔\n軟なデータ保護をその解決すべき課題とするところ（【０００８】），\n保護対象とされるデータの保護されるべき理由は機密性のほかにも考え\n得る。このため，機密事項を保護対象データとして取り扱うことは技術\n常識であったとしても，引用発明における保護対象データが必ず機密事\n項であるとは限らない。しかも，引用発明は，入力元のアプリケーショ\nンと出力先の記憶領域とにそれぞれ安全性を設定し，それらの安全性を\n比較してファイルに保護を施すか否かの判断を行うものである。このた\nめ，同じファイルであっても，入力元と出力先との安全性に応じて，保\n護される場合と保護されない場合とがあり得る。\nこれらの点に鑑みると，引用発明の技術的思想は，入力元のアプリケ\nーションと出力先の記憶領域とにそれぞれ設定された安全性を比較する\nことにより，ファイルを保護対象とすべきか否かの判断を相対的かつ柔\n軟に行うことにあると思われる。かつ，ここで，「入力元のアプリケー\nションの識別子」は，それ自体として直接的ないし一次的に「機密事項\nを扱うアプリケーション」を識別する作用ないし機能は有しておらず，\n上記のようにファイルの保護方法を求める上で比較のため必要となる\n「入力元のアプリケーション」の安全性の程度（例えば，その程度を示\nす数値）を得る前提として，入力元のアプリケーションを識別するもの\nとして作用ないし機能するものと理解される。\nそうすると，本願発明と引用発明とは，その技術的思想を異にするも\nのというべきであり，また，本願発明の「機密識別子」は「機密事項を\n扱うアプリケーションを識別する」ものであるのに対し，引用発明の\n「アプリケーションの識別子」は必ずしも機密事項を扱うアプリケーシ\nョンを識別するものではなく，ファイルの保護方法を求める上で必要と\nなる安全性の程度（例えば，数値）を得る前提として，入力元のアプリ\nケーションを識別するものであり，両者はその作用ないし機能を異にす\nるものと理解するのが適当である。\n(ｳ)  このように，本願発明の「機密識別子」と引用発明の「識別子」が\n相違するものであるならば，それぞれを記憶した本願発明の「機密識\n別子記憶部」と引用発明の「保護方法データベース」も相違すること\nになる。\nウ  以上より，この点に関する本件審決の前記認定・判断は，上記各相違点\nを看過したものというべきであり，誤りがある。\nエ  これに対し，被告は，引用発明における最高レベルの安全性が対応付け\nられたアプリケーション（最安全アプリケーション）の「識別子」が本\n願発明の「機密識別子」に相当する（したがって，そのようなアプリケ\nーションの「識別子」が記憶される「保護方法データベース」が，本願\n発明の「機密識別子記憶部」に相当する）などと主張する。\n確かに，引用発明における最安全アプリケーションは，それ未満の安\n全性を対応付けられた記憶領域へのファイルの送信が阻止されることか\nら，本願発明の「機密アプリケーション」とその作用ないし機能におい\nて類似する。\nしかし，これは入力元と出力先との安全性の比較という引用発明独自\nの保護方法を適用したことにより，結果的に類似する作用ないし機能が\n生じたというにすぎず，最安全アプリケーションの場合といえども，引\n用発明において，アプリケーションが，「機密事項を扱う」か否かの観\n点からではなく，関連付けられている安全性の程度を得る観点から区別\nされていることに変わりはない。このことは，上記安全性の程度が２値\nを採るか３値以上の値を採るかにより異ならない。\nまた，引用発明の「入力元のアプリケーション」は機密事項を扱うか\n否かで区別されていない以上，その識別子が本願発明の「機密識別子」\nに相当することはない。そうである以上，引用発明の「入力元のアプリ\nケーション」を最安全アプリケーションとそうでないアプリケーション\nとに分けて論じたところで，これによって本願発明における「機密識別\n子」が引用発明においても存在することが論証されるわけではないとい\nうべきである。\n以上より，この点に関する被告の主張は採用し得ない。\n(3)ア  そうすると，本件審決につき，引用発明の保護方法データベースに含\nまれる各アプリケーションの識別子が，本願発明の機密識別子記憶部で記\n憶されている機密識別子に相当する旨認定したものと理解した場合（取消\n事由２－１の場合）は，相違点Ａ（ただし，上記(2)に鑑みると，「本願\n発明の機密識別子記憶部では，機密事項を扱うアプリケーションを識別す\nる機密識別子が記憶されるのに対し，引用発明の保護方法データベースで\nは，アプリケーションの識別子が記憶されるものの，当該識別子によって\nは，当該アプリケーションが機密事項を扱うものであるか否かは特定し得\nない」とするのがより正確である。）が存在するものと認められる。すな\nわち，本件審決は，一致点の認定を誤り，相違点Ａを看過したものという\nべきである。\nそして，相違点Ａにつき，引用発明から本願発明の構成に至るために\nは，引用発明の保護方法データベースにおいて，同データベースで管理\nするアプリケーションの識別子を機密事項を扱うアプリケーションの識\n別子に限定する代わりに，同アプリケーションが扱うファイルについて\nは，外部への送信等を絶対的に禁止するなど，入力元と出力先との安全\n性の比較の余地を排するものとする必要があることとなる。しかし，前\n記のとおり，引用発明の技術的思想は，入力元と出力先とにそれぞれ設\n定された安全性を比較することにより，ファイルを保護対象とすべきか\n否かの判断を相対的かつ柔軟に行うことにあるところ，上記のように引\n用発明の構成を変更することがその技術的思想に相反することは明らか\nである。その意味で，そのような構成を採ることには阻害事由がある。\nそうである以上，相違点Ａにつき，引用発明から出発して本願発明の\n構成に至ることは容易に想到可能であるということはできない。すなわ\nち，本件審決における一致点の認定の誤り及び相違点Ａの看過は，審決\nの結論に影響を及ぼすものであるから，取消事由２－１には理由がある。\nイ  他方，本件審決につき，引用発明の保護方法データベースに含まれる最\n安全アプリケーションの識別子が，本願発明の機密識別子記憶部で記憶\nされている機密識別子に相当する旨認定したものと理解した場合（取消\n事由２－２の場合）は，相違点Ｂが存在するものと認められる。すなわ\nち，本件審決は，一致点の認定を誤り，相違点Ｂを看過したものという\nべきである。\nそして，相違点Ｂにつき，引用発明から本願発明の構成に至ることが\n引用発明の技術的思想に相反し，そのような構成を採ることに阻害事由\nがあるため，容易に想到可能とはいえないことは，上記アと同様である。\nしたがって，本件審決における一致点の認定の誤り及び相違点Ｂの看\n過は，審決の結論に影響を及ぼすものであるから，取消事由２－２には\n理由がある。\nなお，原告は，相違点Ｂの存在を主張するに当たり，引用発明におい\nて安全性は３段階以上存在することに言及するところ，引用発明につい\nてのこのような理解は失当というべきである。もっとも，安全性を２段\n階とすることにより引用発明のアプリケーションが機密事項を扱うか否\nかによる区別されるものとなるわけでないことは前記（(2)エ）のとおり\nであるから，この点は結論に影響しない。\nウ  以上より，本件審決につきいかに理解するのであれ，取消事由２－１及\nび２－２を包摂する取消事由２は理由があるということができる。\nエ  これに対し，被告は，相違点ＡないしＢの看過を争うとともに，仮に相\n違点Ｂが存在するとしても，その点については，本件審決の相違点１に\n関する判断において事実上判断されている旨主張する。\nこのうち，相違点ＡないしＢの看過については，上記ア及びイのとお\nりである。\nまた，本件審決の判断は，①引用例２に記載されるように，ファイル\nを含むパケットについて，内部ネットワークから外部ネットワークへの\n持ち出しを判断し，送信先に応じて許可／不許可を判定すること，すな\nわち，内部ネットワーク（ローカル）以外への送信の安全性が低いとし\nてセキュリティ対策を施すことは，本願出願前には当該技術分野の周知\nの事項であったこと，②参考文献に記載されるように，機密ファイルを\nあるアプリケーションプログラムが開いた後は，電子メール等によって\n当該アプリケーションプログラムにより当該ファイルが機密情報保存用\nフォルダ（ローカル）以外に出力されることがないようにすることも，\n本願出願前には当該技術分野の周知技術であったことをそれぞれ踏まえ\nて行われたものである。\nしかし，①に関しては，本件審決の引用する引用例２には，送信の許\n可／禁止の判定は送信元及び送信先の各ＩＰアドレスに基づいて行われ\nることが記載されており（【００３０】），アプリケーションの識別子\nに関する記載は見当たらない。また，前記のとおり，引用発明における\n識別子は，アプリケーションが機密事項を扱うものか否かを識別する作\n用ないし機能を有するものではない。\n②に関しては，参考文献記載の技術は，機密情報保存用フォルダ内の\nファイルが当該フォルダの外部に移動されることを禁止するものである\nところ（【００１１】），その実施の形態として，機密情報保存用フォ\nルダ（機密フォルダ１５Ａ）の設定につき，「システム管理者は，各ユ\nーザが使用するコンピュータ１０内の補助記憶装置１５内に特定の機密\nファイルを保存するための機密フォルダ１５Ａを設定し，ユーザが業務\nで使用する複数の機密ファイルを機密フォルダ１５Ａ内に保存する。」\n（同【００１８】）との記載はあるものの，起動されたアプリケーショ\nンプログラムが機密事項を扱うものであるか否かという点に直接的に着\n目し，これを識別する標識として本願発明の機密識別子に相当するもの\nを用いることをうかがわせる記載は見当たらない（本件審決は，参考文\n献の記載（【０００８】，【０００９】，【００６４】）に言及するも\nのの，そこでの着目点は機密ファイルをあるアプリケーションプログラ\nムが開いた後の取扱いであって，その前段階として機密ファイルを定め\nる要素ないし方法に言及するものではない。）。このように，当該周知\n技術においては，アプリケーションが機密事項を扱うものであるか否か\nを識別する機密識別子に相当するものが用いられているとはいえない。\nなお，参考文献の記載（【００３２】等）によれば，アプリケーショ\nンプログラムのハンドル名がアプリケーションの識別子として作用する\nことがうかがわれるが，参考文献記載の技術は，アプリケーションが実\n際に機密ファイルをオープンしたか否かによって当該アプリケーション\nによるファイルの外部への格納の可否が判断されるものであり，入力元\nと出力先との安全性の比較により処理の可否を判断する引用発明とは処\n理の可否の判断の原理を異にする。また，扱うファイルそのものの機密\n性に着目して機密ファイルを外部に出すことを阻止することを目的とす\nる点で，扱うファイルそのものの機密性には着目していない引用発明と\nは目的をも異にする。このため，引用発明に対し参考文献記載の技術を\n適用することには，動機付けが存在しないというべきである。\nそうすると，相違点Ｂにつき，引用発明に，引用例２に記載 の上記周\n知の事項を適用しても，本願発明の「機密識別子」には容易に想到し得\nないというべきであるし，参考文献記載の周知技術はそもそも引用発明\nに適用し得ないものであり，また，仮に適用し得たとしても，本願発明\nの「機密識別子」に想到し得るものではない。そうである以上，相違点\nＢにつき，本件審決における相違点１の判断において事実上判断されて\nいるとはいえない。\nしたがって，この点に関する被告の主張は採用し得ない。\n４  取消事由３（相違点の認定の誤り及び相違点に係る容易想到性判断の誤り）\nについて\n(1)  上記３のとおり，本件審決は，本願発明の「機密識別子」及び「機密識\n別子記憶部」と引用発明の「識別子」及び「保護方法データベース」とに係\nる相違点を看過したものであり，この点は審決の結論に影響を及ぼす。\nしかし，更に進んで，仮にこの相違点の看過がなかったとしても，本件\n審決は相違点Ｃを看過したものであり，この点は審決の結論に影響を及ぼす\nというべきである。その理由は，以下のとおりである。\n(2)ア  本願発明における送信の可否の動作は，「当該アプリケーションが，\n前記機密識別子記憶部で記憶されている機密識別子で識別されるアプリケ\nーションであり，送信先がローカル以外である場合に，当該フックしたシ\nステムコールを破棄することによって当該送信を阻止し，そうでない場合\nに，当該フックしたシステムコールを開放する」（請求項１）との記載に\nより規定されている。\nここでいう「そうでない場合」とは，その記載に先立つ「当該アプリ\nケーションが，前記機密識別子記憶部で記憶されている機密識別子で識\n別されるアプリケーションであり，送信先がローカル以外である場合」\nとの記載と対をな すもの と理解するのが合理的であ る。そうすると ，\n「そうでない場合」とは，『「当該アプリケーションが，前記機密識別\n子記憶部で記憶されている機密識別子で識別されるアプリケーションで\nあり，送信先がローカル以外である場合」でない場合』を意味すること\nとなる。これは，すなわち，「当該アプリケーションが，機密識別子記\n憶部で記憶されている機密識別子で識別されるアプリケーションでない\nか，又は，送信先がローカルである場合」にほかならない。\n他方，「システムコールを開放する」との動作は，本願明細書の「シ\nステムコールを開放して送信が行われるようにし」（【００２３】）及\nび「システムコールを開放する。その結果，その写真のデータが送信部\n１ ６ に よ っ て 写 真 共 有 サ イ ト の サ ー バ に 送 信 さ れ る こ と に な る 。 」\n（【００３４】）との記載から，送信を実行するための動作であると認\nめられる。\n以上より，本願発明は，「当該アプリケーションが，前記機密識別子\n記憶部で記憶されている機密識別子で識別されるアプリケーションであ\nり，送信先がローカル以外である場合に，当該フックしたシステムコー\nルを破棄することによって当該送信を阻止する一方，当該アプリケーシ\nョンが，機密識別子で識別されるアプリケーションでないか，又は，送\n信先がローカルである場合に，当該フックしたシステムコールを開放す\nることによって当該送信を実行する」ものであると解される。このよう\nに解することは，本願発明の課題及び効果（前記１(3)イ，エ）とも整合\nする。\nそうすると，本願発明と引用発明との一致点及び相違点の認定に当た\nっては，ファイル送信の阻止の条件とともにファイル送信を阻止しない\n条件についても対象とすべきところ，本件審決は，ファイル送信の阻止\nの条件を相違点１として認定するにとどまり，ファイル送信を阻止しな\nい条件に関する対比及び認定が欠落しているというべきである。\nそして，引用発明においてファイル送信を阻止しない条件は，入力元\nのアプリケーションの識別子の安全性よりも出力先の記憶領域の安全性\nの方が低くないことであり，この点は，本願発明のファイル送信を阻止\nしない条件とは相違する。\n以上より，本願発明と引用発明とは，本願発明においては，「当該ア\nプリケーションが，機密識別子で識別されるアプリケーションでないか，\n又は，送信先がローカルである場合に，当該フックしたシステムコール\nを開放することによって当該送信を実行する」のに対し，引用発明にお\nいては，「入力元のアプリケーションの識別子の安全性よりも出力先の\n記憶領域の安全性の方が低くない場合に，ファイル送信を実行する」点\nでも相違すると見るのが適当である（これと相違点１とを合わせると，\n相違点Ｃとなる。以下では，正しくは相違点１ではなく相違点Ｃが認定\nされるべきであったものとして論ずる。）。このような相違点Ｃを看過\nした点で，本件審決における本願発明と引用発明との一致点及び相違点\nの認定は誤りがある。\nイ  これに対し，被告は，本願発明におけるファイル送信が阻止されない条\n件は，「そうでない場合」という包括的なもの，つまりファイル送信が\n阻止される条件以外の全ての場合であって，ファイル送信が阻止される\n条件に応じて反射的必然的に決定されるものであり，これが結果的にど\nのような条件と等価となっているかは発明特定事項ではないとし，ファ\nイル送信が阻止される場合でない場合という条件においては，本願発明\nと引用発明は相違せず，この条件は一致点となる旨主張する。\nこの被告の主張の趣旨はやや判然としない部分があるが，「そうでな\nい場合」の「そう」が「当該アプリケーションが，前記機密識別子記憶\n部で記憶されている機密識別子で識別されるアプリケーションであり，\n送信先がローカル以外である場合」を指すとすれば，ファイル送信が阻\n止される条件が具体的に特定されていることの反面として，阻止されな\nい条件も「当該アプリケーションが，機密識別子で識別されるアプリケ\nーションでないか，又は，送信先がローカルである場合」として具体的\nに特定されると見るのが合理的であるし，本願発明の課題及び効果に鑑\nみると，ファイル送信が阻止されない条件を本願発明の発明特定事項で\nないとする理由もないというべきである。そして，このような本願発明\nにおけるファイル送信が阻止されない条件が引用発明におけるそれと相\n違することは，上記アのとおりである。また，なお，「そうでない場合」\nの「そう」が「当該フックしたシステムコールを破棄することによって\n当該送信を阻止」を指すものと理解する余地もあるが，このような理解\nは被告の前記主張とは整合しないと思われる。\nしたがって，この点に関する被告の主張は採用し得ない。\n(3)ア  上記３のとおり，本件審決は，本願発明の「機密識別子」及び「機密\n識別子記憶部」と引用発明の「識別子」及び「保護方法データベース」と\nに係る相違点を看過したものであり，この点は審決の結論に影響を及ぼす。\nそうである以上，「機密識別子」及び「機密識別子記憶部」を含む相違点\nＣの看過も，審決の結論に当然影響を及ぼすということができる。\nしたがって，取消事由３は理由がある。\nイ  この点につき，被告は，引用発明のアプリケーションや記憶領域に合理\n的に安全性を設定することは当業者が適宜行うことであり，引用発明に\nおいて本願発明と同様の条件を実現することに阻害事由はない旨などを\n主張するけれども，相違点Ｃにつき，引用発明から本願発明の構成に至\nることが引用発明の技術的思想に相反し，そのような構成を採ることに\n阻害事由があるため，容易に想到可能とはいえないことは，相違点Ａな\nいしＢにつき論じたところと同様である。\n以上より，この点に関する被告の主張は採用し得ない。\n５  結論\n以上のとおり，原告の主張に係る取消事由のうち，取消事由１は理由がない\nものの，取消事由２及び３はいずれも理由があるから，本件審決は取り消され\nるべきである。\nよって，原告の請求は理由があるからこれを認容することとし，主文のとお\nり判決する。\n知的財産高等裁判所第３部\n裁判長裁判官\n鶴 岡 稔 彦\n裁判官\n杉 浦 正 樹\n裁判官\n寺 田利 彦\n"
}